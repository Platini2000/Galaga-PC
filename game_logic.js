(function(_0x3318ba,_0x2e5e47){const _0xf23ba7=_0x27dd,_0x43a1a3=_0x3318ba();while(!![]){try{const _0x55079c=parseInt(_0xf23ba7(0x79))/0x1*(-parseInt(_0xf23ba7(0x10b))/0x2)+-parseInt(_0xf23ba7(0x10e))/0x3*(-parseInt(_0xf23ba7(0x123))/0x4)+parseInt(_0xf23ba7(0x14c))/0x5*(-parseInt(_0xf23ba7(0xa5))/0x6)+-parseInt(_0xf23ba7(0x128))/0x7*(-parseInt(_0xf23ba7(0xb7))/0x8)+parseInt(_0xf23ba7(0x114))/0x9+parseInt(_0xf23ba7(0x161))/0xa*(-parseInt(_0xf23ba7(0x16e))/0xb)+parseInt(_0xf23ba7(0xc9))/0xc;if(_0x55079c===_0x2e5e47)break;else _0x43a1a3['push'](_0x43a1a3['shift']());}catch(_0x38030e){_0x43a1a3['push'](_0x43a1a3['shift']());}}}(_0x7fdf,0x932dc));let currentWavePatternIndex=-0x1,aiNeedsStabilization=!![],aiStabilizationEndTime=0x0,smoothedShipX=undefined;function resetGame(){const _0xcdf33f=_0x27dd;try{level=0x1,currentWavePatternIndex=-0x1,isPaused=![],isShowingIntro=![],introStep=0x0,isWaveTransitioning=![],isGridSoundPlaying=![],isEntrancePhaseActive=![],totalEnemiesScheduledForWave=0x0,enemiesSpawnedThisWave=0x0,enemySpawnTimeouts[_0xcdf33f(0x7e)](clearTimeout),enemySpawnTimeouts=[],squadronCompletionStatus={},squadronEntranceFiringStatus={},isGridBreathingActive=![],gridBreathStartTime=0x0,currentGridBreathFactor=0x0,isCsCompletionDelayActive=![],csCompletionDelayStartTime=0x0,csCompletionResultIsPerfect=![],csIntroSoundPlayed=![],gameOverSequenceStartTime=0x0,gameStartTime=0x0,stopAllGameSounds(),player1CompletedLevel=-0x1,forceCenterShipNextReset=![],isShowingPlayerGameOverMessage=![],playerGameOverMessageStartTime=0x0,playerWhoIsGameOver=0x0,nextActionAfterPlayerGameOver='',isShipCaptured=![],capturingBossId=null,captureBeamActive=![],captureBeamSource={'x':0x0,'y':0x0},captureBeamTargetY=0x0,captureBeamProgress=0x0,captureAttemptMadeThisLevel=![],isShowingCaptureMessage=![],captureMessageStartTime=0x0,capturedBossIdWithMessage=null,fallingShips=[],isDualShipActive=![],player1IsDualShipActive=![],player2IsDualShipActive=![],isWaitingForRespawn=![],respawnTime=0x0,isInvincible=![],invincibilityEndTime=0x0,player1Score=0x0,player2Score=0x0,player1Lives=0x3,player2Lives=0x3,player1ShotsFired=0x0,player2ShotsFired=0x0,player1EnemiesHit=0x0,player2EnemiesHit=0x0,player1MaxLevelReached=0x1,player2MaxLevelReached=0x1,lastGridFireCheckTime=0x0,firstEnemyLanded=![],player1LifeThresholdsMet=new Set(),player2LifeThresholdsMet=new Set(),currentPlayer=0x1,score=player1Score,playerLives=player1Lives,player1TriggeredHighScoreSound=![],player2TriggeredHighScoreSound=![],scoreEarnedThisCS=0x0,playerIntroSoundPlayed=![],stageIntroSoundPlayed=![],resetAllMessages(),explosions=[],isChallengingStage=![],challengingStageEnemiesHit=0x0,isShowingResultsScreen=![],currentWaveDefinition=null,isFullGridWave=![],hitSparks=[],resetWave();}catch(_0x2bacd8){console[_0xcdf33f(0x104)](_0xcdf33f(0x85),_0x2bacd8),isWaveTransitioning=![],isGridSoundPlaying=![],isEntrancePhaseActive=![],isCsCompletionDelayActive=![],csCompletionDelayStartTime=0x0,csCompletionResultIsPerfect=![],csIntroSoundPlayed=![],isPaused=![],currentWavePatternIndex=-0x1,player1CompletedLevel=-0x1,isShowingPlayerGameOverMessage=![],playerGameOverMessageStartTime=0x0,playerWhoIsGameOver=0x0,nextActionAfterPlayerGameOver='',squadronCompletionStatus={},squadronEntranceFiringStatus={},isGridBreathingActive=![],gridBreathStartTime=0x0,currentGridBreathFactor=0x0,resetAllMessages(),forceCenterShipNextReset=![],player1ShotsFired=0x0,player2ShotsFired=0x0,player1EnemiesHit=0x0,player2EnemiesHit=0x0,player1MaxLevelReached=0x1,player2MaxLevelReached=0x1,isShipCaptured=![],capturingBossId=null,captureBeamActive=![],captureBeamSource={'x':0x0,'y':0x0},captureBeamTargetY=0x0,captureBeamProgress=0x0,captureAttemptMadeThisLevel=![],isShowingCaptureMessage=![],captureMessageStartTime=0x0,capturedBossIdWithMessage=null,fallingShips=[],isDualShipActive=![],player1IsDualShipActive=![],player2IsDualShipActive=![],isWaitingForRespawn=![],respawnTime=0x0,isInvincible=![],invincibilityEndTime=0x0,isFullGridWave=![],hitSparks=[],player1TriggeredHighScoreSound=![],player2TriggeredHighScoreSound=![],lastGridFireCheckTime=0x0,firstEnemyLanded=![],player1LifeThresholdsMet=new Set(),player2LifeThresholdsMet=new Set(),playerIntroSoundPlayed=![],stageIntroSoundPlayed=![];typeof enemySpawnTimeouts!=='undefined'&&Array[_0xcdf33f(0x121)](enemySpawnTimeouts)&&enemySpawnTimeouts[_0xcdf33f(0x7e)](clearTimeout);enemySpawnTimeouts=[];if(typeof showMenuState===_0xcdf33f(0xae))showMenuState();}}function resetAllMessages(){showCsHitsMessage=![],csHitsMessageStartTime=0x0,showPerfectMessage=![],perfectMessageStartTime=0x0,showCsBonusScoreMessage=![],csBonusScoreMessageStartTime=0x0,showCSClearMessage=![],csClearMessageStartTime=0x0,showCsHitsForClearMessage=![],showCsScoreForClearMessage=![],showExtraLifeMessage=![],extraLifeMessageStartTime=0x0,showReadyMessage=![],readyMessageStartTime=0x0,readyForNextWave=![],readyForNextWaveReset=![];}function stopAllGameSounds(){const _0x4d3ea0=[gridBackgroundSound,entranceSound,butterflyDiveSound,startSound,coinSound,bossGalagaDiveSound,enemyShootSound,levelUpSound,gameOverSound,playerShootSound,extraLifeSound,csPerfectSound,csClearSound,explosionSound,waveUpSound,readySound,tripleAttackSound,captureSound,shipCapturedSound,dualShipSound,resultsMusicSound,hiScoreSound];_0x4d3ea0['forEach'](_0x198159=>stopSound(_0x198159)),isGridSoundPlaying=![];}function getWaveType(_0xd010ef){const _0x4c4b75=_0x27dd,_0x35d868=(_0xd010ef-0x1)%0x4;switch(_0x35d868){case 0x0:return _0x4c4b75(0x127);case 0x1:return _0x4c4b75(0x178);case 0x2:return _0x4c4b75(0x122);case 0x3:return _0x4c4b75(0x7a);default:console[_0x4c4b75(0x104)](_0x4c4b75(0x18a)+_0x35d868+_0x4c4b75(0x91)+_0xd010ef);return _0x4c4b75(0x10d);}}function generateWaveDefinition(_0x40037b){const _0x9fd9ab=_0x27dd;let _0x23bc13=[];currentWavePatternIndex=-0x1;const _0x4564b3=getWaveType(_0x40037b);if(typeof waveEntrancePatterns==='undefined'||!Array[_0x9fd9ab(0x121)](waveEntrancePatterns)||waveEntrancePatterns[_0x9fd9ab(0x140)]<0x2)return console[_0x9fd9ab(0x104)](_0x9fd9ab(0x167)+_0x40037b+')!'),[];if(_0x4564b3==='challenging_stage')_0x23bc13=[];else{if(_0x4564b3===_0x9fd9ab(0x127)){currentWavePatternIndex=0x0;const _0x347e86=waveEntrancePatterns[0x0];if(!_0x347e86||_0x347e86[_0x9fd9ab(0x140)]===0x0)console['error']('Wave\x20'+_0x40037b+_0x9fd9ab(0xaa)),_0x23bc13=[];else try{_0x23bc13=JSON[_0x9fd9ab(0xc2)](JSON[_0x9fd9ab(0x12d)](_0x347e86),(_0x5992d9,_0x2a6a80)=>{const _0xf15399=_0x9fd9ab;return _0x2a6a80&&typeof _0x2a6a80===_0xf15399(0x7f)&&_0x2a6a80[_0xf15399(0x142)]===ENEMY3_TYPE&&typeof _0x2a6a80[_0xf15399(0x77)]===_0xf15399(0xb4)&&(_0x2a6a80['hasCapturedShip']=![]),_0x2a6a80;});}catch(_0x4dfc58){console[_0x9fd9ab(0x104)](_0x9fd9ab(0x95),_0x4dfc58),_0x23bc13=[];}}else{if(_0x4564b3==='entrance_flight_1'){currentWavePatternIndex=0x0;const _0x4ad62a=waveEntrancePatterns[0x0];if(!_0x4ad62a||_0x4ad62a[_0x9fd9ab(0x140)]===0x0)console[_0x9fd9ab(0x104)](_0x9fd9ab(0x173)+_0x40037b+_0x9fd9ab(0x17f)),_0x23bc13=[];else try{_0x23bc13=JSON[_0x9fd9ab(0xc2)](JSON['stringify'](_0x4ad62a),(_0x4982ca,_0x56b980)=>{const _0x3f23af=_0x9fd9ab;return _0x56b980&&typeof _0x56b980===_0x3f23af(0x7f)&&_0x56b980[_0x3f23af(0x142)]===ENEMY3_TYPE&&typeof _0x56b980[_0x3f23af(0x77)]==='undefined'&&(_0x56b980['hasCapturedShip']=![]),_0x56b980;});}catch(_0x2ff340){console[_0x9fd9ab(0x104)](_0x9fd9ab(0x131),_0x2ff340),_0x23bc13=[];}}else{if(_0x4564b3===_0x9fd9ab(0x7a)){currentWavePatternIndex=0x1;const _0x1a2bd4=waveEntrancePatterns[0x1];if(!_0x1a2bd4||_0x1a2bd4[_0x9fd9ab(0x140)]===0x0)console['error'](_0x9fd9ab(0x173)+_0x40037b+_0x9fd9ab(0x112)),_0x23bc13=[];else try{_0x23bc13=JSON['parse'](JSON['stringify'](_0x1a2bd4),(_0x25a217,_0x226082)=>{const _0x346ca3=_0x9fd9ab;return _0x226082&&typeof _0x226082==='object'&&_0x226082[_0x346ca3(0x142)]===ENEMY3_TYPE&&typeof _0x226082['hasCapturedShip']===_0x346ca3(0xb4)&&(_0x226082[_0x346ca3(0x77)]=![]),_0x226082;});}catch(_0x135080){console['error']('Error\x20deep\x20copying\x20selected\x20pattern\x201\x20for\x20Entrance\x202:',_0x135080),_0x23bc13=[];}}else _0x23bc13=[];}}}if(_0x4564b3!==_0x9fd9ab(0x122)){if(typeof normalWaveEntrancePaths===_0x9fd9ab(0xb4)||Object[_0x9fd9ab(0x13f)](normalWaveEntrancePaths)[_0x9fd9ab(0x140)]===0x0)return console[_0x9fd9ab(0x104)](_0x9fd9ab(0xb2)+_0x40037b+_0x9fd9ab(0x93)),_0x23bc13;for(let _0x221f24=_0x23bc13['length']-0x1;_0x221f24>=0x0;_0x221f24--){const _0x56a63b=_0x23bc13[_0x221f24];if(!normalWaveEntrancePaths?.[_0x56a63b[_0x9fd9ab(0xe4)]]){console[_0x9fd9ab(0x117)](_0x9fd9ab(0x173)+_0x40037b+_0x9fd9ab(0xdd)+currentWavePatternIndex+_0x9fd9ab(0x153)+_0x56a63b[_0x9fd9ab(0xe4)]+'\x22\x20does\x20not\x20exist\x20in\x20normalWaveEntrancePaths!\x20Removing\x20squadron.'),_0x23bc13[_0x9fd9ab(0x76)](_0x221f24,0x1);continue;}if(_0x56a63b['enemies']&&Array[_0x9fd9ab(0x121)](_0x56a63b[_0x9fd9ab(0x13e)])){for(let _0x30382b=_0x56a63b[_0x9fd9ab(0x13e)][_0x9fd9ab(0x140)]-0x1;_0x30382b>=0x0;_0x30382b--){const _0x59e78c=_0x56a63b['enemies'][_0x30382b];(!_0x59e78c||!normalWaveEntrancePaths?.[_0x59e78c[_0x9fd9ab(0x15e)]])&&(console['warn'](_0x9fd9ab(0x173)+_0x40037b+_0x9fd9ab(0xdd)+currentWavePatternIndex+_0x9fd9ab(0x8c)+_0x56a63b[_0x9fd9ab(0xe4)]+_0x9fd9ab(0xa7)+_0x59e78c?.['entrancePathId']+_0x9fd9ab(0x165)),_0x56a63b[_0x9fd9ab(0x13e)]['splice'](_0x30382b,0x1)),_0x59e78c&&_0x59e78c['type']===ENEMY3_TYPE&&typeof _0x59e78c[_0x9fd9ab(0x77)]==='undefined'&&(_0x59e78c[_0x9fd9ab(0x77)]=![]);}_0x56a63b[_0x9fd9ab(0x13e)][_0x9fd9ab(0x140)]===0x0&&(console['warn']('Wave\x20'+_0x40037b+_0x9fd9ab(0xdd)+currentWavePatternIndex+_0x9fd9ab(0xa0)+_0x56a63b[_0x9fd9ab(0xe4)]+_0x9fd9ab(0x7d)),_0x23bc13[_0x9fd9ab(0x76)](_0x221f24,0x1));}else console['warn'](_0x9fd9ab(0x173)+_0x40037b+_0x9fd9ab(0xdd)+currentWavePatternIndex+_0x9fd9ab(0xa0)+_0x56a63b[_0x9fd9ab(0xe4)]+'\x22\x20has\x20no\x20valid\x20enemies\x20array.\x20Removing.'),_0x23bc13[_0x9fd9ab(0x76)](_0x221f24,0x1);}}return _0x23bc13;}function resetWave(){const _0x228f69=_0x27dd;stopAllGameSounds(),isWaveTransitioning=![],isGridSoundPlaying=![],scoreEarnedThisCS=0x0,resetAllMessages(),isCsCompletionDelayActive=![],csCompletionDelayStartTime=0x0,csCompletionResultIsPerfect=![],csIntroSoundPlayed=![],isPaused=![],isShipCaptured=![],capturingBossId=null,captureBeamActive=![],captureBeamSource={'x':0x0,'y':0x0},captureBeamTargetY=0x0,captureBeamProgress=0x0,captureAttemptMadeThisLevel=![],isShowingCaptureMessage=![],captureMessageStartTime=0x0,capturedBossIdWithMessage=null,fallingShips=[],isWaitingForRespawn=![],respawnTime=0x0,isInvincible=![],invincibilityEndTime=0x0,playerIntroSoundPlayed=![],stageIntroSoundPlayed=![],lastGridFireCheckTime=0x0,firstEnemyLanded=![];const _0x2665b1=player1Score,_0xc67b08=player2Score;_0x2665b1<highScore&&(player1TriggeredHighScoreSound=![]);_0xc67b08<highScore&&(player2TriggeredHighScoreSound=![]);bullets=[],enemyBullets=[],enemies=[],explosions=[],gridMoveDirection=0x1,lastEnemyDetachTime=0x0,currentGridOffsetX=0x0,isEntrancePhaseActive=![],currentWaveDefinition=null,currentWavePatternIndex=-0x1,enemySpawnTimeouts[_0x228f69(0x7e)](clearTimeout),enemySpawnTimeouts=[],totalEnemiesScheduledForWave=0x0,enemiesSpawnedThisWave=0x0,squadronCompletionStatus={},squadronEntranceFiringStatus={},isGridBreathingActive=![],gridBreathStartTime=0x0,currentGridBreathFactor=0x0,hitSparks=[],isFullGridWave=![],isChallengingStage=![];try{const _0xeb4220=getWaveType(level);isChallengingStage=_0xeb4220===_0x228f69(0x122),isFullGridWave=_0xeb4220===_0x228f69(0x127),challengingStageEnemiesHit=0x0,isShowingIntro=!![],introDisplayStartTime=Date[_0x228f69(0x164)]();if(isChallengingStage)isTwoPlayerMode?introStep=0x1:introStep=0x3;else{if(isFullGridWave){if(isTwoPlayerMode)introStep=0x1;else level===0x1?introStep=0x1:introStep=0x2;}else isTwoPlayerMode?introStep=0x1:introStep=0x2;}level===0x1&&currentPlayer===0x1&&playSound(startSound),gameCanvas?.['width']>0x0&&ship?(ship['y']=gameCanvas[_0x228f69(0x166)]-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN,(!isManualControl||forceCenterShipNextReset)&&(isDualShipActive?ship['x']=gameCanvas[_0x228f69(0x17e)]/0x2-ship[_0x228f69(0x17e)]:ship['x']=gameCanvas[_0x228f69(0x17e)]/0x2-ship[_0x228f69(0x17e)]/0x2,ship[_0x228f69(0x169)]=ship['x'],smoothedShipX=ship['x'],aiNeedsStabilization=!![])):console['warn'](_0x228f69(0xa8)),forceCenterShipNextReset=![];}catch(_0x45ceb7){console[_0x228f69(0x104)](_0x228f69(0xee),_0x45ceb7),isWaveTransitioning=![],isGridSoundPlaying=![],isShowingIntro=![],introStep=0x0,isChallengingStage=![],isFullGridWave=![],resetAllMessages(),isCsCompletionDelayActive=![],csCompletionDelayStartTime=0x0,csCompletionResultIsPerfect=![],csIntroSoundPlayed=![],isPaused=![],currentWavePatternIndex=-0x1,squadronCompletionStatus={},squadronEntranceFiringStatus={},isGridBreathingActive=![],gridBreathStartTime=0x0,currentGridBreathFactor=0x0,forceCenterShipNextReset=![],isShipCaptured=![],capturingBossId=null,captureBeamActive=![],captureBeamSource={'x':0x0,'y':0x0},captureBeamTargetY=0x0,captureBeamProgress=0x0,captureAttemptMadeThisLevel=![],isShowingCaptureMessage=![],captureMessageStartTime=0x0,capturedBossIdWithMessage=null,fallingShips=[],isWaitingForRespawn=![],respawnTime=0x0,isInvincible=![],invincibilityEndTime=0x0,hitSparks=[],player1TriggeredHighScoreSound=![],player2TriggeredHighScoreSound=![],lastGridFireCheckTime=0x0,firstEnemyLanded=![],playerIntroSoundPlayed=![],stageIntroSoundPlayed=![];typeof enemySpawnTimeouts!==_0x228f69(0xb4)&&Array[_0x228f69(0x121)](enemySpawnTimeouts)&&enemySpawnTimeouts[_0x228f69(0x7e)](clearTimeout);enemySpawnTimeouts=[];if(typeof showMenuState===_0x228f69(0xae))showMenuState();}}const createBulletSimple=(_0x28165a,_0x1cd647=null)=>{const _0x5b4e77=_0x27dd;if(!_0x28165a||playerLives<=0x0||!isInGameState||!ship||isShipCaptured)return![];const _0x18249f=scaleValue(level,BASE_ENEMY_BULLET_SPEED,MAX_ENEMY_BULLET_SPEED),_0x2a5c65=_0x1cd647?_0x1cd647['x']:_0x28165a['x']+_0x28165a[_0x5b4e77(0x17e)]/0x2,_0x3484e2=_0x1cd647?_0x1cd647['y']:_0x28165a['y']+_0x28165a[_0x5b4e77(0x166)]/0x2;let _0x526155=0x0,_0xd5790c=_0x18249f;const _0x10b111=ship['x']+ship[_0x5b4e77(0x17e)]/0x2-_0x2a5c65,_0x493a38=ship['y']+ship[_0x5b4e77(0x166)]/0x2-_0x3484e2,_0x26a1f3=Math['sqrt'](_0x10b111*_0x10b111+_0x493a38*_0x493a38);if(_0x26a1f3>0x0){let _0x2b2c57=0x0;!isChallengingStage&&(_0x2b2c57=scaleValue(level,BASE_ENEMY_AIM_FACTOR,MAX_ENEMY_AIM_FACTOR));let _0x186b7b=Math[_0x5b4e77(0xe7)](_0x493a38,_0x10b111);return _0x526155=Math[_0x5b4e77(0x108)](_0x186b7b)*_0x18249f*_0x2b2c57,_0xd5790c=Math['sqrt'](_0x18249f**0x2-_0x526155**0x2),_0xd5790c=Math[_0x5b4e77(0x182)](_0x18249f*(0x1-_0x2b2c57)*0.5,_0xd5790c),_0x493a38<0x0&&(_0xd5790c=Math[_0x5b4e77(0xb8)](_0xd5790c)),enemyBullets[_0x5b4e77(0xb3)]({'x':_0x2a5c65-ENEMY_BULLET_WIDTH/0x2,'y':_0x3484e2,'width':ENEMY_BULLET_WIDTH,'height':ENEMY_BULLET_HEIGHT,'vx':_0x526155,'vy':_0xd5790c,'type':_0x28165a[_0x5b4e77(0x142)]}),!![];}return![];};function scheduleSingleEntranceSquadron(_0x42bcbb,_0x445c24,_0x3fea9b){const _0xd7168d=_0x27dd;if(isFullGridWave||isChallengingStage)return console[_0xd7168d(0x117)](_0xd7168d(0xa2)+level+_0xd7168d(0x137)+isFullGridWave+_0xd7168d(0xc8)+isChallengingStage+_0xd7168d(0xf5)),_0x42bcbb?.['enemies']?.['length']>0x0&&(enemiesSpawnedThisWave+=_0x42bcbb[_0xd7168d(0x13e)][_0xd7168d(0x140)],squadronCompletionStatus[_0x445c24]&&(squadronCompletionStatus[_0x445c24]['completed']=squadronCompletionStatus[_0x445c24][_0xd7168d(0x87)])),![];const _0x56faf9=normalWaveEntrancePaths,_0x19e3b8=_0x42bcbb[_0xd7168d(0xe4)],_0x5e1f80=_0x56faf9[_0x19e3b8];if(!_0x5e1f80||_0x5e1f80['length']===0x0)return console[_0xd7168d(0x104)]('Entrance\x20Wave:\x20Path\x20'+_0x19e3b8+_0xd7168d(0x155)+_0x445c24+'\x20invalid!\x20Skipping\x20squadron.'),_0x42bcbb?.['enemies']?.[_0xd7168d(0x140)]>0x0&&(enemiesSpawnedThisWave+=_0x42bcbb[_0xd7168d(0x13e)][_0xd7168d(0x140)],squadronCompletionStatus[_0x445c24]&&(squadronCompletionStatus[_0x445c24][_0xd7168d(0xff)]=squadronCompletionStatus[_0x445c24][_0xd7168d(0x87)])),![];const _0xde86e2=setTimeout(()=>{const _0x20dcb7=_0xd7168d,_0x22213e=enemySpawnTimeouts[_0x20dcb7(0x12c)](_0xde86e2);if(_0x22213e>-0x1)enemySpawnTimeouts[_0x20dcb7(0x76)](_0x22213e,0x1);if(isPaused||!isInGameState||!isEntrancePhaseActive||isChallengingStage||isWaveTransitioning||playerLives<=0x0||isShipCaptured||isFullGridWave){_0x42bcbb?.['enemies']?.[_0x20dcb7(0x140)]>0x0&&(enemiesSpawnedThisWave+=_0x42bcbb[_0x20dcb7(0x13e)]['length'],squadronCompletionStatus[_0x445c24]&&(squadronCompletionStatus[_0x445c24]['completed']=squadronCompletionStatus[_0x445c24][_0x20dcb7(0x87)]));return;}try{squadronEntranceFiringStatus[_0x445c24]?(squadronEntranceFiringStatus[_0x445c24][_0x20dcb7(0x9d)]=Date[_0x20dcb7(0x164)]()+_0x3fea9b,squadronEntranceFiringStatus[_0x445c24][_0x20dcb7(0x119)]=![]):(console[_0x20dcb7(0x117)](_0x20dcb7(0x175)+_0x445c24+'\x20not\x20found.'),squadronEntranceFiringStatus[_0x445c24]={'hasFired':![],'scheduledStartTime':Date[_0x20dcb7(0x164)]()+_0x3fea9b});const _0x3be7f1=ENEMY_SPAWN_DELAY_IN_SQUADRON,_0x61ed32=_0x3be7f1*0x2,_0x3a6d90=0x1;_0x42bcbb[_0x20dcb7(0x13e)][_0x20dcb7(0x7e)]((_0x1c4dc7,_0x1b0629)=>{const _0x362ec6=_0x20dcb7;if(!_0x1c4dc7||!_0x1c4dc7[_0x362ec6(0x142)]||typeof _0x1c4dc7['gridRow']===_0x362ec6(0xb4)||typeof _0x1c4dc7[_0x362ec6(0x8a)]==='undefined'||!_0x1c4dc7['entrancePathId']){console[_0x362ec6(0x104)](_0x362ec6(0x179)+_0x445c24+_0x362ec6(0x124)+_0x19e3b8+_0x362ec6(0xe8)+_0x1b0629+_0x362ec6(0xcd)),enemiesSpawnedThisWave++;squadronCompletionStatus[_0x445c24]&&squadronCompletionStatus[_0x445c24][_0x362ec6(0xff)]++;return;}const _0x53e42a=_0x56faf9[_0x1c4dc7[_0x362ec6(0x15e)]];(!_0x53e42a||_0x53e42a[_0x362ec6(0x140)]===0x0)&&console[_0x362ec6(0x117)](_0x362ec6(0x144)+_0x1c4dc7[_0x362ec6(0x15e)]+'\x22\x20for\x20enemy\x20in\x20squadron\x20'+_0x445c24+_0x362ec6(0x8d)+_0x1b0629+_0x362ec6(0x12f)+_0x19e3b8+'\x22.');let _0x20938d=0x0;const _0x1a5f45=getWaveType(level),_0x3b509c=_0x1a5f45==='entrance_flight_2'&&(_0x445c24===0x2||_0x445c24===0x3);if(_0x3b509c){const _0x32b200=Math[_0x362ec6(0x15d)](_0x1b0629/0x2);_0x1b0629%0x2===0x0?_0x20938d=_0x32b200*_0x61ed32:_0x20938d=_0x32b200*_0x61ed32+_0x3a6d90;}else _0x20938d=_0x1b0629*ENEMY_SPAWN_DELAY_IN_SQUADRON;const _0xd58488=setTimeout(()=>{const _0x3ad940=_0x362ec6,_0x15095f=enemySpawnTimeouts[_0x3ad940(0x12c)](_0xd58488);if(_0x15095f>-0x1)enemySpawnTimeouts[_0x3ad940(0x76)](_0x15095f,0x1);if(isPaused||!isInGameState||!isEntrancePhaseActive||isChallengingStage||isWaveTransitioning||playerLives<=0x0||isShipCaptured||isFullGridWave){enemiesSpawnedThisWave++;squadronCompletionStatus[_0x445c24]&&squadronCompletionStatus[_0x445c24]['completed']++;return;}try{let _0x4beaac=_0x1c4dc7[_0x3ad940(0x142)],_0x21a44e=_0x4beaac===ENEMY3_TYPE?ENEMY3_MAX_HITS:0x1,_0x54b07f,_0x453f91;if(_0x4beaac===ENEMY1_TYPE)_0x54b07f=ENEMY1_WIDTH,_0x453f91=ENEMY1_HEIGHT;else _0x4beaac===ENEMY3_TYPE?(_0x54b07f=BOSS_WIDTH,_0x453f91=BOSS_HEIGHT):(_0x54b07f=ENEMY_WIDTH,_0x453f91=ENEMY_HEIGHT);let _0x26777c=0x0,_0x45b072=0x0;if(_0x5e1f80&&_0x5e1f80[0x0]?.['p0'])_0x26777c=_0x5e1f80[0x0]['p0']['x'],_0x45b072=_0x5e1f80[0x0]['p0']['y'];else throw new Error(_0x3ad940(0xba)+_0x19e3b8);let _0x56f8fb,_0x37db2d;try{const {x:_0x390c07,y:_0xe3fbf8}=getCurrentGridSlotPosition(_0x1c4dc7['gridRow'],_0x1c4dc7[_0x3ad940(0x8a)],_0x54b07f);_0x56f8fb=_0x390c07,_0x37db2d=_0xe3fbf8;}catch(_0xd27a6){console['error']('Error\x20getting\x20target\x20grid\x20pos\x20for\x20new\x20enemy\x20'+_0x1c4dc7[_0x3ad940(0x142)]+_0x3ad940(0xb9)+_0x1c4dc7['gridRow']+','+_0x1c4dc7[_0x3ad940(0x8a)]+']',_0xd27a6),_0x56f8fb=gameCanvas?.[_0x3ad940(0x17e)]/0x2||0xc8,_0x37db2d=ENEMY_TOP_MARGIN+_0x1c4dc7[_0x3ad940(0x138)]*(ENEMY_HEIGHT+ENEMY_V_SPACING);}let _0x1fc9d1=0x0;const _0x42f490=_0x3b509c,_0x133951=_0x42f490&&_0x1b0629%0x2!==0x0;_0x133951?_0x1fc9d1=-ENTRANCE_PAIR_PATH_T_OFFSET:_0x1fc9d1=-_0x1b0629*PATH_T_OFFSET_PER_ENEMY;const _0x2e78e6={'x':_0x26777c,'y':_0x45b072,'width':_0x54b07f,'height':_0x453f91,'targetGridX':_0x56f8fb,'targetGridY':_0x37db2d,'speed':0x0,'state':_0x3ad940(0xec),'gridRow':_0x1c4dc7[_0x3ad940(0x138)],'gridCol':_0x1c4dc7[_0x3ad940(0x8a)],'type':_0x4beaac,'health':_0x21a44e,'isDamaged':![],'velocityX':0x0,'velocityY':0x0,'attackPathStep':0x0,'initialY':0x0,'initialX':0x0,'diveDirection':0x1,'lastFiredTime':0x0,'targetX1':0x0,'targetY1':0x0,'targetX2':0x0,'targetY2':0x0,'targetX3':0x0,'targetY3':0x0,'attackPathSegments':[],'attackPathSegmentIndex':0x0,'attackPathT':0x0,'attackStartTime':0x0,'attackFormationOffsetX':0x0,'attackGroupId':null,'entrancePathId':_0x19e3b8,'pathSegmentIndex':0x0,'pathT':_0x1fc9d1,'squadronId':_0x445c24,'squadronEnemyIndex':_0x1b0629,'id':_0x3ad940(0xe9)+_0x445c24+'-'+_0x1b0629+'-'+Date['now']()+'-'+Math[_0x3ad940(0x149)]()[_0x3ad940(0x154)](0x24)[_0x3ad940(0xd9)](0x2,0x7),'justReturned':![],'canFireThisDive':![],'attackType':_0x3ad940(0xad),'hasCapturedShip':_0x4beaac===ENEMY3_TYPE?![]:undefined,'capturedShipX':undefined,'capturedShipY':undefined,'capturedShipLastFiredTime':_0x4beaac===ENEMY3_TYPE?0x0:undefined,'captureStartTime':0x0,'capturePrepareTimeout':null,'pathSpeedMultiplier':0x1};enemies[_0x3ad940(0xb3)](_0x2e78e6),enemiesSpawnedThisWave++;squadronCompletionStatus[_0x445c24]&&squadronCompletionStatus[_0x445c24]['completed']++;if(_0x1b0629===0x0){let _0x261217=0x5dc;(_0x445c24===0x0||_0x445c24===0x1)&&(_0x261217=0xfa);const _0x25f87e=_0x2e78e6['id'],_0x4058dd=setTimeout(()=>{const _0x51f6bc=_0x3ad940,_0x134991=enemySpawnTimeouts[_0x51f6bc(0x12c)](_0x4058dd);if(_0x134991>-0x1)enemySpawnTimeouts[_0x51f6bc(0x76)](_0x134991,0x1);if(isPaused||!isInGameState||playerLives<=0x0||isChallengingStage||isWaveTransitioning||isShipCaptured||isFullGridWave)return;fireFixedEnemyBurst(_0x25f87e,null,0x0,0x3);},_0x261217);enemySpawnTimeouts['push'](_0x4058dd);}}catch(_0x1f711b){console[_0x3ad940(0x104)](_0x3ad940(0xb6)+_0x445c24+_0x3ad940(0x7b)+_0x1b0629+_0x3ad940(0x145)+_0x19e3b8+'):',_0x1f711b),enemiesSpawnedThisWave++,squadronCompletionStatus[_0x445c24]&&squadronCompletionStatus[_0x445c24][_0x3ad940(0xff)]++;}},_0x20938d);enemySpawnTimeouts['push'](_0xd58488);});}catch(_0x4e6745){console[_0x20dcb7(0x104)](_0x20dcb7(0xcf)+_0x445c24+_0x20dcb7(0x124)+_0x19e3b8+'):',_0x4e6745),_0x42bcbb?.[_0x20dcb7(0x13e)]?.[_0x20dcb7(0x140)]>0x0&&(enemiesSpawnedThisWave+=_0x42bcbb['enemies'][_0x20dcb7(0x140)],squadronCompletionStatus[_0x445c24]&&(squadronCompletionStatus[_0x445c24][_0x20dcb7(0xff)]=squadronCompletionStatus[_0x445c24][_0x20dcb7(0x87)]));}},_0x3fea9b);return enemySpawnTimeouts['push'](_0xde86e2),!![];};function startChallengingStageSequence(){const _0x235068=_0x27dd;currentWaveDefinition=[],isEntrancePhaseActive=![],enemySpawnTimeouts[_0x235068(0x7e)](clearTimeout),enemySpawnTimeouts=[],totalEnemiesScheduledForWave=0x0,enemiesSpawnedThisWave=0x0,squadronEntranceFiringStatus={};Object[_0x235068(0x13f)](challengingStagePaths)[_0x235068(0x140)]===0x0&&defineChallengingStagePaths();if(Object[_0x235068(0x13f)](challengingStagePaths)[_0x235068(0x140)]===0x0){console['error'](_0x235068(0x75)),isWaveTransitioning=!![],setTimeout(()=>{const _0x2b68fd=_0x235068;(isInGameState||!isInGameState&&playerLives>0x0)&&typeof resetWave===_0x2b68fd(0xae)&&resetWave();},NEXT_WAVE_DELAY_AFTER_MESSAGE);return;}const _0x391f53=['CS3_DiveLoopL_Sharp',_0x235068(0x15a),_0x235068(0xe5),_0x235068(0xeb)],_0x5234a7=['CS_LoopAttack_TL',_0x235068(0x147),_0x235068(0x89),'CS_LoopAttack_BR'],_0x46fb20=[..._0x391f53,..._0x5234a7];for(const _0x59d652 of _0x46fb20){if(!challengingStagePaths[_0x235068(0xe2)](_0x59d652)){console['error'](_0x235068(0x158)+_0x59d652+_0x235068(0x15f)),isWaveTransitioning=!![],setTimeout(()=>{const _0x47336b=_0x235068;(isInGameState||!isInGameState&&playerLives>0x0)&&typeof resetWave===_0x47336b(0xae)&&resetWave();},NEXT_WAVE_DELAY_AFTER_MESSAGE);return;}}let _0x3b5be9=[..._0x391f53],_0x4c851a=[..._0x5234a7][_0x235068(0x6d)](()=>Math[_0x235068(0x149)]()-0.5);_0x3b5be9[_0x235068(0xb3)](..._0x4c851a),currentWaveDefinition=[];for(let _0x213039=0x0;_0x213039<CHALLENGING_STAGE_SQUADRON_COUNT;_0x213039++){const _0x3a09ae=_0x3b5be9[_0x213039],_0x3ed531={'pathId':_0x3a09ae,'enemies':[]};for(let _0x621bfd=0x0;_0x621bfd<CHALLENGING_STAGE_SQUADRON_SIZE;_0x621bfd++){let _0x3e057e=_0x621bfd<Math[_0x235068(0x15d)](CHALLENGING_STAGE_SQUADRON_SIZE/0x2)?ENEMY1_TYPE:ENEMY2_TYPE;_0x3ed531[_0x235068(0x13e)][_0x235068(0xb3)]({'type':_0x3e057e,'entrancePathId':_0x3a09ae});}currentWaveDefinition[_0x235068(0xb3)](_0x3ed531);}challengingStageTotalEnemies=CHALLENGING_STAGE_ENEMY_COUNT,totalEnemiesScheduledForWave=challengingStageTotalEnemies,enemiesSpawnedThisWave=0x0;if(currentWaveDefinition[_0x235068(0x140)]>0x0){isEntrancePhaseActive=!![],enemySpawnTimeouts=[];let _0x996851=0x0;const _0x17a2f8=-0x1c,_0x242297=Math[_0x235068(0x15d)](Math[_0x235068(0x182)](0x0,level-0x3)/0x4)+0x1,_0x3646ee=scaleValue(_0x242297,BASE_CS_SPEED_MULTIPLIER,MAX_CS_SPEED_MULTIPLIER);currentWaveDefinition[_0x235068(0x7e)]((_0x39887c,_0x215f18)=>{const _0x437ead=_0x235068;let _0x5c0e2b=0x0;if(_0x215f18<=0x1)_0x5c0e2b=0x0;else _0x215f18<=0x3?_0x5c0e2b=CHALLENGING_STAGE_SQUADRON_INTERVAL:_0x5c0e2b=(_0x215f18-0x2)*CHALLENGING_STAGE_SQUADRON_INTERVAL;let _0x26a51d=_0x3646ee;(_0x215f18===0x2||_0x215f18===0x3)&&(_0x26a51d*=CS_HORIZONTAL_FLYBY_SPEED_FACTOR);const _0x1ec258=setTimeout(()=>{const _0x18d268=_0x27dd,_0x492024=enemySpawnTimeouts[_0x18d268(0x12c)](_0x1ec258);if(_0x492024>-0x1)enemySpawnTimeouts[_0x18d268(0x76)](_0x492024,0x1);if(!isPaused&&isInGameState&&isEntrancePhaseActive&&isChallengingStage&&!isWaveTransitioning&&playerLives>0x0)try{const _0x24b0e0=_0x39887c[_0x18d268(0xe4)],_0x589e64=challengingStagePaths,_0x55faa3=_0x589e64[_0x24b0e0];if(!_0x55faa3||_0x55faa3[_0x18d268(0x140)]===0x0){console[_0x18d268(0x104)](_0x18d268(0xef)+_0x24b0e0+_0x18d268(0x155)+_0x215f18+_0x18d268(0x9a)),enemiesSpawnedThisWave+=_0x39887c[_0x18d268(0x13e)][_0x18d268(0x140)];return;}let _0x36339a=CS_ENEMY_SPAWN_DELAY_IN_SQUADRON;if(_0x215f18>=0x2&&_0x215f18<=0x3)_0x36339a=CS_HORIZONTAL_FLYBY_SPAWN_DELAY;else _0x215f18>=0x4&&(_0x36339a=CS_LOOP_ATTACK_SPAWN_DELAY);_0x39887c[_0x18d268(0x13e)][_0x18d268(0x7e)]((_0x45e8de,_0x5a19cc)=>{const _0x3fa60c=_0x18d268;if(!_0x45e8de||!_0x45e8de[_0x3fa60c(0x142)]){console[_0x3fa60c(0x104)](_0x3fa60c(0x187)+_0x215f18+_0x3fa60c(0x8d)+_0x5a19cc+_0x3fa60c(0xcd)),enemiesSpawnedThisWave++;return;}const _0x24a2c0=_0x5a19cc*_0x36339a,_0x17bccd=setTimeout(()=>{const _0x3bb520=_0x3fa60c,_0x327ded=enemySpawnTimeouts['indexOf'](_0x17bccd);if(_0x327ded>-0x1)enemySpawnTimeouts[_0x3bb520(0x76)](_0x327ded,0x1);if(isPaused||!isInGameState||!isEntrancePhaseActive||!isChallengingStage||isWaveTransitioning||playerLives<=0x0){enemiesSpawnedThisWave++;return;}try{let _0x2288a1=_0x45e8de[_0x3bb520(0x142)],_0x3157ed=_0x2288a1===ENEMY3_TYPE?ENEMY3_MAX_HITS:0x1,_0x465aa4,_0x4a6836;if(_0x2288a1===ENEMY1_TYPE)_0x465aa4=ENEMY1_WIDTH,_0x4a6836=ENEMY1_HEIGHT;else _0x2288a1===ENEMY3_TYPE?(_0x465aa4=BOSS_WIDTH,_0x4a6836=BOSS_HEIGHT):(_0x465aa4=ENEMY_WIDTH,_0x4a6836=ENEMY_HEIGHT);let _0x254162=0x0,_0x1a4f22=0x0;if(_0x55faa3[0x0]?.['p0'])_0x254162=_0x55faa3[0x0]['p0']['x'],_0x1a4f22=_0x55faa3[0x0]['p0']['y'];else throw new Error(_0x3bb520(0x86)+_0x24b0e0);(_0x215f18===0x0||_0x215f18===0x1)&&(_0x254162+=_0x17a2f8);const _0x2c0648=-_0x5a19cc*PATH_T_OFFSET_PER_ENEMY,_0x6fedf5={'x':_0x254162,'y':_0x1a4f22,'width':_0x465aa4,'height':_0x4a6836,'targetGridX':0x0,'targetGridY':0x0,'speed':0x0,'state':_0x3bb520(0x9f),'gridRow':-0x1,'gridCol':-0x1,'type':_0x2288a1,'health':_0x3157ed,'isDamaged':![],'velocityX':0x0,'velocityY':0x0,'attackPathStep':0x0,'initialY':0x0,'initialX':0x0,'diveDirection':0x1,'lastFiredTime':0x0,'targetX1':0x0,'targetY1':0x0,'targetX2':0x0,'targetY2':0x0,'targetX3':0x0,'targetY3':0x0,'attackPathSegments':[],'attackPathSegmentIndex':0x0,'attackPathT':0x0,'attackStartTime':0x0,'attackFormationOffsetX':0x0,'attackGroupId':null,'entrancePathId':_0x24b0e0,'pathSegmentIndex':0x0,'pathT':_0x2c0648,'squadronId':_0x215f18,'id':_0x3bb520(0x151)+_0x215f18+'-'+_0x5a19cc+'-'+Date[_0x3bb520(0x164)]()+'-'+Math[_0x3bb520(0x149)]()[_0x3bb520(0x154)](0x24)[_0x3bb520(0xd9)](0x2,0x7),'justReturned':![],'canFireThisDive':![],'attackType':_0x3bb520(0xad),'hasCapturedShip':_0x2288a1===ENEMY3_TYPE?![]:undefined,'capturedShipX':undefined,'capturedShipY':undefined,'capturedShipLastFiredTime':_0x2288a1===ENEMY3_TYPE?0x0:undefined,'captureStartTime':0x0,'capturePrepareTimeout':null,'pathSpeedMultiplier':_0x26a51d};enemies[_0x3bb520(0xb3)](_0x6fedf5),enemiesSpawnedThisWave++;}catch(_0xf0b913){console['error'](_0x3bb520(0x157)+_0x215f18+',\x20Idx\x20'+_0x5a19cc+_0x3bb520(0x145)+_0x24b0e0+'):',_0xf0b913),enemiesSpawnedThisWave++;}},_0x24a2c0);enemySpawnTimeouts['push'](_0x17bccd),_0x996851++;});}catch(_0xc5873f){console[_0x18d268(0x104)]('CS:\x20Error\x20setting\x20up\x20spawns\x20for\x20squadron\x20'+_0x215f18+':',_0xc5873f),enemiesSpawnedThisWave+=_0x39887c[_0x18d268(0x13e)][_0x18d268(0x140)];}else _0x39887c?.[_0x18d268(0x13e)]?.['length']>0x0&&(enemiesSpawnedThisWave+=_0x39887c['enemies'][_0x18d268(0x140)]);},_0x5c0e2b);enemySpawnTimeouts[_0x437ead(0xb3)](_0x1ec258);});}else console['warn'](_0x235068(0x83)),isWaveTransitioning=!![],setTimeout(()=>{const _0x4be315=_0x235068;(isInGameState||!isInGameState&&playerLives>0x0)&&typeof resetWave===_0x4be315(0xae)&&resetWave();},NEXT_WAVE_DELAY_AFTER_MESSAGE);}function fireEnemyBurst(_0xf16703,_0x30f8af,_0x243791){const _0x34a157=_0x27dd;if(!_0xf16703||isPaused||!isInGameState||playerLives<=0x0||isChallengingStage||isWaveTransitioning||isShipCaptured)return;const _0x4afe0d=Math['round'](scaleValue(level,BASE_ENEMY_BULLET_BURST_COUNT,MAX_ENEMY_BULLET_BURST_COUNT));for(let _0x4fa2ed=0x0;_0x4fa2ed<_0x4afe0d;_0x4fa2ed++){const _0x2e0d34=_0x243791+_0x4fa2ed*ENTRANCE_FIRE_BURST_DELAY_MS,_0xa39a7=setTimeout(()=>{const _0x545191=_0x27dd;try{const _0x5ba3a9=enemySpawnTimeouts[_0x545191(0x12c)](_0xa39a7);_0x5ba3a9>-0x1&&enemySpawnTimeouts['splice'](_0x5ba3a9,0x1);if(isPaused||!isInGameState||playerLives<=0x0||isChallengingStage||isWaveTransitioning||isShipCaptured)return;const _0x6566e3=enemies[_0x545191(0xf2)](_0x538cf8=>_0x538cf8&&_0x538cf8['id']===_0xf16703);_0x6566e3&&_0x6566e3['state']===_0x30f8af&&(createBulletSimple(_0x6566e3)&&(_0x4fa2ed===0x0&&playSound(enemyShootSound),_0x6566e3[_0x545191(0xa1)]=Date[_0x545191(0x164)]()));}catch(_0x50f4dd){console[_0x545191(0x104)](_0x545191(0x81)+(_0x4fa2ed+0x1)+'/'+_0x4afe0d+')\x20for\x20'+_0xf16703+':',_0x50f4dd);}},_0x2e0d34);enemySpawnTimeouts[_0x34a157(0xb3)](_0xa39a7);}}function fireFixedEnemyBurst(_0x38653d,_0xab01c2,_0x2958ca,_0x598312){if(!_0x38653d||isPaused||!isInGameState||playerLives<=0x0||isChallengingStage||isWaveTransitioning||isShipCaptured||_0x598312<=0x0)return;for(let _0x22bc20=0x0;_0x22bc20<_0x598312;_0x22bc20++){const _0x26c3db=_0x2958ca+_0x22bc20*ENTRANCE_FIRE_BURST_DELAY_MS,_0x174cc6=setTimeout(()=>{const _0x173849=_0x27dd;try{const _0x401d0d=enemySpawnTimeouts[_0x173849(0x12c)](_0x174cc6);_0x401d0d>-0x1&&enemySpawnTimeouts[_0x173849(0x76)](_0x401d0d,0x1);if(isPaused||!isInGameState||playerLives<=0x0||isChallengingStage||isWaveTransitioning||isShipCaptured)return;const _0x17cb7e=enemies[_0x173849(0xf2)](_0x202e85=>_0x202e85&&_0x202e85['id']===_0x38653d);if(_0x17cb7e)createBulletSimple(_0x17cb7e)&&(_0x22bc20===0x0&&playSound(enemyShootSound),_0x17cb7e[_0x173849(0xa1)]=Date[_0x173849(0x164)]());else{}}catch(_0x56f8cf){console[_0x173849(0x104)](_0x173849(0xac)+(_0x22bc20+0x1)+'/'+_0x598312+_0x173849(0x15b)+_0x38653d+':',_0x56f8cf);}},_0x26c3db);enemySpawnTimeouts['push'](_0x174cc6);}}function startFullGridWave(){const _0x3714fd=_0x27dd;if(!currentWaveDefinition||currentWaveDefinition[_0x3714fd(0x140)]===0x0||!isFullGridWave){console[_0x3714fd(0x104)]('Attempted\x20to\x20start\x20Full\x20Grid\x20wave\x20without\x20valid\x20definition\x20or\x20when\x20not\x20in\x20Full\x20Grid\x20mode.'),isWaveTransitioning=!![],readyForNextWaveReset=!![];return;}playSound(entranceSound),enemySpawnTimeouts[_0x3714fd(0x7e)](clearTimeout),enemySpawnTimeouts=[],totalEnemiesScheduledForWave=0x0,enemiesSpawnedThisWave=0x0,squadronCompletionStatus={},squadronEntranceFiringStatus={};let _0x514588=0x0;currentWaveDefinition[_0x3714fd(0x7e)]((_0x3de49a,_0x25d189)=>{const _0x4e1955=_0x3714fd;let _0x54deb0=0x0;_0x3de49a&&_0x3de49a['enemies']&&Array[_0x4e1955(0x121)](_0x3de49a[_0x4e1955(0x13e)])?(_0x54deb0=_0x3de49a['enemies'][_0x4e1955(0x140)],_0x3de49a[_0x4e1955(0x13e)][_0x4e1955(0x7e)]((_0x228716,_0x32614c)=>{const _0x5a4e06=_0x4e1955;try{if(!_0x228716||!_0x228716['type']||typeof _0x228716['gridRow']===_0x5a4e06(0xb4)||typeof _0x228716[_0x5a4e06(0x8a)]==='undefined'){console['error'](_0x5a4e06(0x11b)+_0x25d189+_0x5a4e06(0x8d)+_0x32614c+_0x5a4e06(0xcd));return;}let _0x110ea0=_0x228716[_0x5a4e06(0x142)],_0x3d82fc=_0x110ea0===ENEMY3_TYPE?ENEMY3_MAX_HITS:0x1,_0x15c0d8,_0x363829;if(_0x110ea0===ENEMY1_TYPE)_0x15c0d8=ENEMY1_WIDTH,_0x363829=ENEMY1_HEIGHT;else _0x110ea0===ENEMY3_TYPE?(_0x15c0d8=BOSS_WIDTH,_0x363829=BOSS_HEIGHT):(_0x15c0d8=ENEMY_WIDTH,_0x363829=ENEMY_HEIGHT);let _0x139a38,_0x4c5def;try{const {x:_0x11113e,y:_0x2111f9}=getCurrentGridSlotPosition(_0x228716['gridRow'],_0x228716[_0x5a4e06(0x8a)],_0x15c0d8);_0x139a38=_0x11113e,_0x4c5def=_0x2111f9;}catch(_0x109928){console['error'](_0x5a4e06(0x10c)+_0x228716[_0x5a4e06(0x142)]+_0x5a4e06(0xb9)+_0x228716['gridRow']+','+_0x228716[_0x5a4e06(0x8a)]+']',_0x109928),_0x139a38=gameCanvas?.['width']/0x2||0xc8,_0x4c5def=ENEMY_TOP_MARGIN+_0x228716[_0x5a4e06(0x138)]*(ENEMY_HEIGHT+ENEMY_V_SPACING);}const _0x199637={'x':_0x139a38,'y':_0x4c5def,'width':_0x15c0d8,'height':_0x363829,'targetGridX':_0x139a38,'targetGridY':_0x4c5def,'speed':0x0,'state':_0x5a4e06(0x14f),'gridRow':_0x228716[_0x5a4e06(0x138)],'gridCol':_0x228716[_0x5a4e06(0x8a)],'type':_0x110ea0,'health':_0x3d82fc,'isDamaged':![],'velocityX':0x0,'velocityY':0x0,'attackPathStep':0x0,'initialY':0x0,'initialX':0x0,'diveDirection':0x1,'lastFiredTime':0x0,'targetX1':0x0,'targetY1':0x0,'targetX2':0x0,'targetY2':0x0,'targetX3':0x0,'targetY3':0x0,'attackPathSegments':[],'attackPathSegmentIndex':0x0,'attackPathT':0x0,'attackStartTime':0x0,'attackFormationOffsetX':0x0,'attackGroupId':null,'entrancePathId':null,'pathSegmentIndex':0x0,'pathT':0x0,'squadronId':_0x25d189,'squadronEnemyIndex':_0x32614c,'id':_0x5a4e06(0x97)+_0x25d189+'-'+_0x32614c+'-'+Date[_0x5a4e06(0x164)]()+'-'+Math[_0x5a4e06(0x149)]()[_0x5a4e06(0x154)](0x24)[_0x5a4e06(0xd9)](0x2,0x7),'justReturned':![],'canFireThisDive':![],'attackType':_0x5a4e06(0xad),'hasCapturedShip':_0x110ea0===ENEMY3_TYPE?![]:undefined,'capturedShipX':undefined,'capturedShipY':undefined,'capturedShipLastFiredTime':_0x110ea0===ENEMY3_TYPE?0x0:undefined,'captureStartTime':0x0,'capturePrepareTimeout':null,'pathSpeedMultiplier':0x1};enemies[_0x5a4e06(0xb3)](_0x199637),_0x514588++;}catch(_0x5bbcbe){console[_0x5a4e06(0x104)](_0x5a4e06(0x73)+_0x25d189+_0x5a4e06(0x7b)+_0x32614c+'):',_0x5bbcbe);}})):console['warn'](_0x4e1955(0x98)+_0x25d189+_0x4e1955(0xf8)),squadronCompletionStatus[_0x25d189]={'completed':_0x54deb0,'total':_0x54deb0};}),totalEnemiesScheduledForWave=_0x514588,enemiesSpawnedThisWave=_0x514588,isEntrancePhaseActive=![],gridJustCompleted=!![],!isGridSoundPlaying&&(isGridSoundPlaying=!![],playSound(gridBackgroundSound)),GRID_BREATH_ENABLED&&!isGridBreathingActive&&(isGridBreathingActive=!![],gridBreathStartTime=Date[_0x3714fd(0x164)](),currentGridBreathFactor=0x0),lastGridFireCheckTime=Date[_0x3714fd(0x164)](),firstEnemyLanded=!![];}function scheduleEntranceFlightWave(){const _0x534fc6=_0x27dd;if(isFullGridWave||isChallengingStage){console['warn'](_0x534fc6(0x172)+level+_0x534fc6(0x137)+isFullGridWave+_0x534fc6(0xc8)+isChallengingStage+_0x534fc6(0xf5)),isEntrancePhaseActive=![];return;}if(!currentWaveDefinition||currentWaveDefinition[_0x534fc6(0x140)]===0x0){console['warn'](_0x534fc6(0xc4)),isEntrancePhaseActive=![],stopSound(entranceSound),isWaveTransitioning=!![],readyForNextWaveReset=!![];return;}const _0x181d4d=normalWaveEntrancePaths;if(Object['keys'](_0x181d4d)['length']===0x0){console[_0x534fc6(0x104)](_0x534fc6(0x152)),isEntrancePhaseActive=![],stopSound(entranceSound),isWaveTransitioning=!![],readyForNextWaveReset=!![];return;}enemySpawnTimeouts[_0x534fc6(0x7e)](clearTimeout),enemySpawnTimeouts=[],totalEnemiesScheduledForWave=0x0,currentWaveDefinition[_0x534fc6(0x7e)](_0x5b8701=>totalEnemiesScheduledForWave+=_0x5b8701[_0x534fc6(0x13e)][_0x534fc6(0x140)]),enemiesSpawnedThisWave=0x0,squadronCompletionStatus={},squadronEntranceFiringStatus={},isEntrancePhaseActive=!![],playSound(entranceSound),currentWaveDefinition[_0x534fc6(0x7e)]((_0x238fb0,_0x5c5f61)=>{const _0x3d26ea=_0x534fc6;squadronCompletionStatus[_0x5c5f61]={'completed':0x0,'total':_0x238fb0[_0x3d26ea(0x13e)]?.[_0x3d26ea(0x140)]||0x0,'hasFiredPostLanding':![]};const _0x1c1928=_0x5c5f61*NORMAL_WAVE_SQUADRON_INTERVAL;squadronEntranceFiringStatus[_0x5c5f61]={'hasFired':![],'scheduledStartTime':0x0},scheduleSingleEntranceSquadron(_0x238fb0,_0x5c5f61,_0x1c1928);});}function checkAndScheduleNextSquadron(_0x24aea4){}function resetJustReturnedFlags(_0x487654){enemies['forEach'](_0x38ead3=>{const _0x21b088=_0x27dd;let _0x151b63=![];if(_0x487654 instanceof Set)_0x151b63=_0x487654[_0x21b088(0xdc)](_0x38ead3['id']);else typeof _0x487654===_0x21b088(0x16a)&&(_0x151b63=_0x38ead3['id']===_0x487654);_0x38ead3&&_0x38ead3['state']==='in_grid'&&_0x38ead3[_0x21b088(0x92)]&&!_0x151b63&&(_0x38ead3[_0x21b088(0x92)]=![]);});}function _0x7fdf(){const _0x442225=['\x20off\x20screen:','\x20(no\x20attack\x20path):','warn','.\x20Removing.','hasFired','canFireThisDive','Full\x20Grid:\x20Invalid\x20enemy\x20def\x20in\x20squadron\x20','round','\x20out\x20of\x20bounds\x20for\x20SHARED\x20path\x20','diving_to_capture_position','FATAL\x20Error\x20in\x20moveEntities:','Error\x20calculating\x20Normal\x20Bezier\x20point\x20for\x20enemy\x20','isArray','challenging_stage','16MFUUrR','\x20(Path\x20','Error\x20updating\x20explosions:','Error\x20getting\x20grid\x20pos\x20for\x20','full_grid','2317lfeNmd','Error\x20calculating\x20bezier\x20point\x20during\x20attack\x20for\x20',')\x20during\x20shift:','switch_player','indexOf','stringify','targetGridY','\x20not\x20found.\x20Enemy\x20will\x20follow\x20squadron\x20path\x20\x22','preparing_attack','Error\x20deep\x20copying\x20selected\x20pattern\x200\x20for\x20Entrance\x201:','show_results','\x20after\x20bad\x20segment','\x20(invalid\x20attack\x20segment):','\x20out\x20of\x20bounds\x20(',')!\x20Returning.',',\x20isFullGrid:\x20','gridRow','newButtonStates','Error\x20during\x20post-landing\x20fire\x20for\x20','every','health','[findAndDetachEnemy\x20-\x20PRIORITY]\x20Ship\x20captured.\x20Selecting\x20Boss\x20','enemies','keys','length','[Capture\x20Message\x20End]\x20Error\x20getting\x20grid\x20pos\x20for\x20returning\x20boss\x20','type','\x20attacking\x20without\x20path!\x20Returning.','Entrance\x20Wave:\x20Assigned\x20entrance\x20path\x20\x22',',\x20Path\x20','add','CS_LoopAttack_TR','attackFormationOffsetX','random','Error\x20calculating\x20FINAL\x20bezier\x20point\x20for\x20attack\x20','pause','5BUOjHF','\x20attacking,\x20index\x20','pathT','in_grid','sqrt','enemy-cs-','CRITICAL:\x20Failed\x20to\x20define\x20Normal\x20Wave\x20entrance\x20paths!',':\x20Squadron\x20pathId\x20\x22','toString','\x20for\x20squadron\x20','[Destroyed\x20Boss\x20Score\x20-\x20Attack]\x20Boss\x20destroyed\x20on\x20first\x20hit?\x20Awarding\x20','CS:\x20Error\x20during\x20enemy\x20spawn\x20execution\x20(Sq\x20','CRITICAL:\x20Required\x20CS\x20path\x20\x22','isDamaged','CS3_DiveLoopR_Sharp',')\x20for\x20','lifetime','floor','entrancePathId','\x22\x20not\x20found!\x20Aborting\x20CS.','initialCaptureAnimationY','55910hQrHdc','shoot','!\x20Returning.','now','\x22\x20invalid\x20or\x20missing\x20in\x20normalWaveEntrancePaths!\x20Removing\x20enemy.','height','CRITICAL:\x20waveEntrancePatterns\x20is\x20not\x20defined\x20or\x20invalid\x20in\x20generateWaveDefinition\x20(Level\x20','attackPathSegmentIndex','targetX','string','\x20after\x20invalid\x20path\x20index','A\x20critical\x20error\x20occurred\x20in\x20the\x20game\x20loop.\x20Please\x20refresh.','Error\x20in\x20findAndDetachEnemy:','1133ylISNW','.\x20Switching\x20to\x20moving_to_grid.','Error:\x20Tried\x20to\x20start\x20wave\x20for\x20player\x20with\x200\x20lives.\x20Triggering\x20Game\x20Over.','right','[scheduleEntranceFlightWave]\x20Called\x20inappropriately\x20for\x20non-entrance\x20wave\x20type\x20(Level\x20','Wave\x20','attackGroupId','[scheduleSingleEntranceSquadron]\x20Firing\x20status\x20for\x20squadron\x20','Invalid\x20next\x20Normal\x20Bezier\x20segment\x20','Error\x20getting\x20grid\x20pos\x20for\x20returning\x20enemy\x20','entrance_flight_1','Entrance\x20Wave:\x20Invalid\x20enemy\x20def\x20in\x20squadron\x20','\x20attacking,\x20invalid\x20segment\x20','\x20for\x20path\x20','boss_loop_right','velocityY','width','\x20(Entrance\x201):\x20Basis\x20patroon\x200\x20is\x20ongeldig\x20of\x20leeg!','\x20after\x20bad\x20next\x20segment','moving_to_grid','max','Cannot\x20reposition\x20ship\x20Y\x20-\x20ship\x20or\x20canvas\x20not\x20ready.','\x20in\x20returning','back','\x20after\x20missing\x20path','CS:\x20Invalid\x20enemy\x20def\x20in\x20squadron\x20','speed','\x20after\x20attack:','Onbekend\x20wave\x20patroon\x20index\x20','Invalid\x20Normal\x20Bezier\x20segment\x20','pathSegmentIndex','\x20to\x20reset\x20state/rotation.','sort','[Capture\x20Message\x20End]\x20Could\x20not\x20find\x20Boss\x20','\x20in\x20moving_to_grid\x20state\x20without\x20target.\x20Recalculating.','Error\x20getting\x20grid\x20pos\x20within\x20\x27in_grid\x27\x20for\x20','capturing','Boss\x20','Full\x20Grid:\x20Error\x20placing\x20enemy\x20(Sq\x20','attackPathT','CRITICAL:\x20Failed\x20to\x20define\x20CS\x20paths!','splice','hasCapturedShip','\x20(state:\x20','46zypSrE','entrance_flight_2',',\x20Idx\x20','\x20for\x20MUST\x20DIVE\x20(Normal\x20attack).','\x22\x20became\x20empty\x20after\x20enemy\x20path\x20validation.\x20Removing.','forEach','object','captureAnimationRotation','Error\x20during\x20enemy\x20burst\x20firing\x20(bullet\x20','\x20was\x20in\x20\x27capturing\x27,\x20but\x20another\x20ship\x20(','CS:\x20No\x20squadrons\x20generated.\x20Skipping\x20CS\x20sequence.','\x20points.\x20Health\x20was:\x20','FATAL\x20Error\x20in\x20resetGame:','Invalid\x20start\x20segment\x20for\x20path\x20','total','NaN\x20detected\x20in\x20CS\x20path\x20calculation\x20for\x20enemy\x20','CS_LoopAttack_BL','gridCol','Error\x20checking/awarding\x20extra\x20life:',',\x20Squadron\x20',',\x20index\x20','\x20for\x20SHARED\x20path\x20','filter','Error\x20getting\x20grid\x20pos\x20for\x20returning\x20boss\x20','\x20voor\x20level\x20','justReturned',')!\x20Cannot\x20validate\x20paths.','Error\x20creating\x20player\x20bullet(s):','Error\x20deep\x20copying\x20selected\x20pattern\x200\x20for\x20Full\x20Grid:','[DEBUG]\x20Error\x20generating\x20attack\x20path\x20for\x20enemy\x20','enemy-grid-','Full\x20Grid:\x20Squadron\x20','capturedShipDimensions','\x20invalid!\x20Skipping.','getGamepads','Invalid\x20next\x20CS\x20Bezier\x20segment\x20','scheduledStartTime','stack','following_bezier_path',':\x20Squadron\x20\x22','lastFiredTime','[scheduleSingleEntranceSquadron]\x20Called\x20inappropriately\x20for\x20non-entrance\x20wave\x20type\x20(Level\x20','capturedShipY','returning','3782370ASxlbK','findIndex',':\x20Enemy\x20entrancePathId\x20\x22','Canvas/ship\x20not\x20ready\x20in\x20resetWave.','targetGridX','\x20(Full\x20Grid):\x20Basis\x20patroon\x200\x20is\x20ongeldig\x20of\x20leeg!','returnLogDone','Error\x20during\x20FIXED\x20enemy\x20burst\x20firing\x20(bullet\x20','normal','function','Enemy\x20','duration','\x20diving\x20to\x20capture\x20without\x20targetX/Y!\x20Aborting.','CRITICAL:\x20normalWaveEntrancePaths\x20is\x20not\x20defined\x20or\x20empty\x20in\x20generateWaveDefinition\x20(Level\x20','push','undefined','particles','Entrance\x20Wave:\x20Error\x20during\x20enemy\x20spawn\x20execution\x20(Sq\x20','21536DuaDcT','abs','\x20at\x20[','Invalid\x20start\x20segment\x20for\x20squadron\x20path\x20','\x20at\x20end\x20of\x20normal\x20path\x20','NaN\x20detected\x20in\x20Normal\x20path\x20calculation\x20for\x20enemy\x20','left','Error\x20getting\x20grid\x20pos\x20after\x20invalid\x20NEXT\x20attack\x20segment\x20for\x20','\x20(invalid\x20attack\x20index):','\x20definition\x20failed.\x20Transitioning\x20immediately.','sin','parse','capturedShipX','Attempted\x20to\x20schedule\x20entrance\x20flight\x20wave\x20without\x20valid\x20definition.','[DEBUG\x20Attack\x20Path\x20Failed]\x20Could\x20not\x20generate\x20path\x20for\x20leader\x20','captureStartTime','Invalid\x20CS\x20Bezier\x20segment\x20',',\x20isCS:\x20','7238880yfWbiu','!!!\x20CRITICAL\x20ERROR\x20IN\x20runSingleGameUpdate\x20!!!','Error\x20getting\x20grid\x20pos\x20after\x20bezier\x20error\x20for\x20','creationTime','.\x20Skipping.','velocityX','Entrance\x20Wave:\x20Error\x20processing\x20enemies\x20for\x20squadron\x20','\x20path\x20index\x20','attacking','attackType','Error\x20calculating\x20final\x20bezier\x20point\x20for\x20','squadronEnemyIndex','hasFiredPostLanding','Error\x20updating\x20floating\x20scores:','.\x20Enemy\x20','map','substring','some','[handleEnemyHit]\x20CRITICAL:\x20Boss\x20destroyed,\x20had\x20ship\x20initially\x20but\x20dimensions\x20missing!','has',',\x20Pattern\x20','tintProgress','squadronId',')\x20was\x20already\x20captured.\x20Returning.','rotation','hasOwnProperty','log','pathId','CS_HorizontalFlyByL','destroyed','atan2','),\x20index\x20','enemy-entr-','\x20after\x20NaN','CS_HorizontalFlyByR','following_entrance_path','pathSpeedMultiplier','FATAL\x20Error\x20in\x20resetWave:','CS:\x20Path\x20','[Capture\x20State]\x20Boss\x20','alpha','find','boss_loop_left','slice',').\x20Skipping.','includes','targetY','\x20has\x20invalid\x20enemy\x20data.','preparing_capture','min','Error\x20getting\x20target\x20grid\x20pos\x20for\x20','Error\x20calculating\x20CS\x20Bezier\x20point\x20for\x20enemy\x20','state','Error\x20updating\x20target\x20grid\x20pos\x20for\x20enemy\x20','completed','showing_capture_message','Error\x20starting\x20attack\x20for\x20','number','[Player\x20GO\x20Delay\x20End]\x20Invalid\x20next\x20action:','error','capturedShipLastFiredTime','attackPathSegments','Critical\x20error\x20during\x20entity\x20movement/collision.\x20Returning\x20to\x20menu.','cos','\x20missing\x20SHARED\x20path\x20','Error\x20getting\x20grid\x20pos\x20after\x20FINAL\x20bezier\x20error\x20for\x20','30688AogdtG','Full\x20Grid:\x20Error\x20getting\x20target\x20grid\x20pos\x20for\x20enemy\x20','unknown','618027xXYHpl','\x20attacking,\x20invalid\x20NEXT\x20segment\x20','capturePrepareTimeout','\x20in\x20moving_to_grid','\x20(Entrance\x202):\x20Basis\x20patroon\x201\x20is\x20ongeldig\x20of\x20leeg!','[Capture\x20Message\x20End]\x20Boss\x20','1769472gzPQBw'];_0x7fdf=function(){return _0x442225;};return _0x7fdf();}function generateAttackPath(_0x7ddce6){const _0x172c9b=_0x27dd;try{if(!_0x7ddce6||!gameCanvas)return[];const _0xa4c862=_0x7ddce6[_0x172c9b(0x142)]===ENEMY3_TYPE?BOSS_WIDTH:_0x7ddce6[_0x172c9b(0x142)]===ENEMY1_TYPE?ENEMY1_WIDTH:ENEMY_WIDTH,_0x248f94=_0x7ddce6['type']===ENEMY3_TYPE?BOSS_HEIGHT:_0x7ddce6['type']===ENEMY1_TYPE?ENEMY1_HEIGHT:ENEMY_HEIGHT,_0x4300da=_0xa4c862*0.5,_0x38ceab=gameCanvas[_0x172c9b(0x17e)],_0x3fcc81=gameCanvas['height'];let _0x406518=[];const _0x4bc27b={'x':_0x7ddce6['x'],'y':_0x7ddce6['y']},_0x3685d0=Math[_0x172c9b(0xfa)](_0x3fcc81*0.06,_0x248f94*1.8),_0x1ab8d4=Math['min'](_0x38ceab*0.04,_0xa4c862*1.2),_0x5d8524=_0x7ddce6['x']+_0xa4c862/0x2<_0x38ceab/0x2?0x1:-0x1,_0x5df1a3={'x':_0x4bc27b['x']-_0x5d8524*_0x1ab8d4*0.6,'y':_0x4bc27b['y']-_0x3685d0};_0x5df1a3['x']=Math[_0x172c9b(0x182)](_0x4300da,Math[_0x172c9b(0xfa)](_0x38ceab-_0x4300da-_0xa4c862,_0x5df1a3['x'])),_0x5df1a3['y']=Math['max'](_0x4300da,_0x5df1a3['y']);const _0x4d434a={'x':_0x4bc27b['x']+_0x5d8524*_0x1ab8d4*0.1,'y':_0x4bc27b['y']-_0x3685d0*1.4},_0x3044e6={'x':_0x5df1a3['x']+_0x5d8524*_0x1ab8d4*0.3,'y':_0x4bc27b['y']-_0x3685d0*1.5},_0x3ed977={'p0':_0x4bc27b,'p1':_0x4d434a,'p2':_0x3044e6,'p3':_0x5df1a3};_0x406518['push'](_0x3ed977);const _0x295202=_0x5df1a3,_0xc8025b=_0x3fcc81*0.45,_0x406838=_0x38ceab*0.22,_0x3000d3=_0x3fcc81*0.28,_0xf5c3e0=0.5,_0x3a9183=0.6,_0x457d6d=_0x3fcc81*0.85,_0x307ca0=Math['floor'](Math[_0x172c9b(0x149)]()*0x3);let _0x1c96fc=[];if(_0x307ca0===0x0){const _0x187f80=_0xc8025b+Math[_0x172c9b(0x149)]()*_0x3fcc81*0.1,_0x1de9bc=_0x406838+Math[_0x172c9b(0x149)]()*_0x38ceab*0.08,_0x4b7d9f=_0x3000d3+Math[_0x172c9b(0x149)]()*_0x3fcc81*0.08,_0x53fc46=_0x295202['x']+_0x5d8524*_0x1de9bc*0.5,_0x521e04=Math[_0x172c9b(0xfa)](_0x457d6d,_0x295202['y']+_0x187f80),_0x75e198=_0x53fc46+_0x5d8524*_0x1de9bc*0.5,_0x456fdb=Math[_0x172c9b(0x182)](_0x295202['y']+0x14,_0x521e04-_0x4b7d9f),_0x5eb7ff=_0x75e198-_0x5d8524*_0x1de9bc*0.9,_0x33b4a9=Math[_0x172c9b(0x182)](_0x295202['y']+0x28,_0x456fdb+_0x4b7d9f*0.6),_0x47b4fc=_0x5eb7ff-_0x5d8524*_0x1de9bc*0.3,_0x5dd4ea=_0x3fcc81+_0x248f94*0x2,_0x3e7ee4=Math[_0x172c9b(0x182)](_0x4300da,Math[_0x172c9b(0xfa)](_0x38ceab-_0x4300da-_0xa4c862,_0x53fc46)),_0x376100=Math[_0x172c9b(0x182)](_0x4300da,Math[_0x172c9b(0xfa)](_0x38ceab-_0x4300da-_0xa4c862,_0x75e198)),_0xecab76=Math[_0x172c9b(0x182)](_0x4300da,Math[_0x172c9b(0xfa)](_0x38ceab-_0x4300da-_0xa4c862,_0x5eb7ff)),_0x31efe4={'x':_0x295202['x'],'y':_0x295202['y']+_0x187f80*_0x3a9183*0.5},_0x1a07d6={'x':_0x3e7ee4-_0x5d8524*_0x1de9bc*_0xf5c3e0,'y':_0x521e04},_0x2d9633={'x':_0x3e7ee4,'y':_0x521e04},_0x382725={'x':_0x3e7ee4+_0x5d8524*_0x1de9bc*_0xf5c3e0,'y':_0x521e04},_0x3ddac3={'x':_0x376100,'y':_0x456fdb+_0x4b7d9f*_0x3a9183},_0x826ce1={'x':_0x376100,'y':_0x456fdb},_0x1a5f6b={'x':_0x376100,'y':_0x456fdb-_0x4b7d9f*_0x3a9183*0.5},_0x406512={'x':_0xecab76+_0x5d8524*_0x1de9bc*_0xf5c3e0,'y':_0x33b4a9},_0x38bb6b={'x':_0xecab76,'y':_0x33b4a9},_0x54d93d={'x':_0x38bb6b['x'],'y':_0x38bb6b['y']+_0x3fcc81*0.1},_0x405ace={'x':_0x47b4fc,'y':_0x5dd4ea-_0x3fcc81*0.2},_0x331e98={'x':_0x47b4fc,'y':_0x5dd4ea};_0x1c96fc=[{'p0':_0x295202,'p1':_0x31efe4,'p2':_0x1a07d6,'p3':_0x2d9633},{'p0':_0x2d9633,'p1':_0x382725,'p2':_0x3ddac3,'p3':_0x826ce1},{'p0':_0x826ce1,'p1':_0x1a5f6b,'p2':_0x406512,'p3':_0x38bb6b},{'p0':_0x38bb6b,'p1':_0x54d93d,'p2':_0x405ace,'p3':_0x331e98}];}else{if(_0x307ca0===0x1){const _0x579cd1=_0xc8025b*0.8+Math['random']()*_0x3fcc81*0.1,_0x24dfa9=_0x406838*1.2+Math[_0x172c9b(0x149)]()*_0x38ceab*0.1,_0x5374fc=_0x3000d3*0.7+Math['random']()*_0x3fcc81*0.1,_0x20554a=_0x295202['x']+_0x5d8524*_0x24dfa9*0.4,_0x356946=Math[_0x172c9b(0xfa)](_0x457d6d-_0x5374fc*0.5,_0x295202['y']+_0x579cd1*0.6),_0x25fac8=_0x20554a+_0x5d8524*_0x24dfa9*0.6,_0x2ff800=Math[_0x172c9b(0xfa)](_0x457d6d,_0x356946+_0x5374fc),_0x6adf4c=_0x25fac8-_0x5d8524*_0x24dfa9*0.5,_0x2e5eda=_0x3fcc81+_0x248f94*0x2,_0x4afc22=Math['max'](_0x4300da,Math[_0x172c9b(0xfa)](_0x38ceab-_0x4300da-_0xa4c862,_0x20554a)),_0x54e21f=Math[_0x172c9b(0x182)](_0x4300da,Math['min'](_0x38ceab-_0x4300da-_0xa4c862,_0x25fac8)),_0x508632={'x':_0x295202['x']-_0x5d8524*_0x24dfa9*0.1,'y':_0x295202['y']+_0x579cd1*0.3},_0x455bdd={'x':_0x4afc22-_0x5d8524*_0x24dfa9*_0xf5c3e0*0.8,'y':_0x356946+_0x5374fc*_0x3a9183*0.4},_0x131e53={'x':_0x4afc22,'y':_0x356946},_0x104492={'x':_0x4afc22+_0x5d8524*_0x24dfa9*_0xf5c3e0*0.8,'y':_0x356946-_0x5374fc*_0x3a9183*0.4},_0x885cf3={'x':_0x54e21f+_0x5d8524*_0x24dfa9*_0xf5c3e0*0.6,'y':_0x2ff800+_0x5374fc*_0x3a9183*0.5},_0x5d03c1={'x':_0x54e21f,'y':_0x2ff800},_0x8bce09={'x':_0x54e21f-_0x5d8524*_0x24dfa9*0.2,'y':_0x2ff800+_0x3fcc81*0.1},_0x2bcd26={'x':_0x6adf4c,'y':_0x2e5eda-_0x3fcc81*0.3},_0x328690={'x':_0x6adf4c,'y':_0x2e5eda};_0x1c96fc=[{'p0':_0x295202,'p1':_0x508632,'p2':_0x455bdd,'p3':_0x131e53},{'p0':_0x131e53,'p1':_0x104492,'p2':_0x885cf3,'p3':_0x5d03c1},{'p0':_0x5d03c1,'p1':_0x8bce09,'p2':_0x2bcd26,'p3':_0x328690}];}else{const _0x1d8827=_0xc8025b*0.6+Math[_0x172c9b(0x149)]()*_0x3fcc81*0.05,_0x33fc90=_0x406838*0.7+Math[_0x172c9b(0x149)]()*_0x38ceab*0.05,_0x55e928=_0x3000d3*0.6+Math['random']()*_0x3fcc81*0.05,_0x22acc8=_0x55e928*1.5,_0x89ed50=_0x295202['x']+_0x5d8524*_0x33fc90*0.5,_0x57f796=Math[_0x172c9b(0xfa)](_0x457d6d-_0x22acc8,_0x295202['y']+_0x1d8827),_0xf2c56b=_0x89ed50+_0x5d8524*_0x33fc90*0.5,_0x110703=_0x57f796+_0x55e928,_0x446837=_0xf2c56b-_0x5d8524*_0x33fc90*0.8,_0x1d025c=Math['min'](_0x457d6d,_0x110703+_0x22acc8*0.7),_0x3583ab=_0x446837+_0x5d8524*_0x33fc90*0.4,_0x189ee7=_0x1d025c+_0x55e928*0.8,_0x14bb76=_0x3583ab,_0xa465d=_0x3fcc81+_0x248f94*0x2,_0x405197=Math[_0x172c9b(0x182)](_0x4300da,Math[_0x172c9b(0xfa)](_0x38ceab-_0x4300da-_0xa4c862,_0x89ed50)),_0x336aa6=Math[_0x172c9b(0x182)](_0x4300da,Math[_0x172c9b(0xfa)](_0x38ceab-_0x4300da-_0xa4c862,_0xf2c56b)),_0x5f3411=Math['max'](_0x4300da,Math[_0x172c9b(0xfa)](_0x38ceab-_0x4300da-_0xa4c862,_0x446837)),_0xdb3d79=Math[_0x172c9b(0x182)](_0x4300da,Math[_0x172c9b(0xfa)](_0x38ceab-_0x4300da-_0xa4c862,_0x3583ab)),_0x1e39a8={'x':_0x295202['x'],'y':_0x295202['y']+_0x1d8827*0.5},_0x1cfdf4={'x':_0x405197-_0x5d8524*_0x33fc90*_0xf5c3e0,'y':_0x57f796+_0x55e928*_0x3a9183*0.3},_0x301c6c={'x':_0x405197,'y':_0x57f796},_0x4ef4af={'x':_0x405197+_0x5d8524*_0x33fc90*_0xf5c3e0,'y':_0x57f796-_0x55e928*_0x3a9183*0.3},_0x23a949={'x':_0x336aa6+_0x5d8524*_0x33fc90*_0xf5c3e0,'y':_0x110703+_0x55e928*_0x3a9183*0.5},_0x5f636e={'x':_0x336aa6,'y':_0x110703},_0x28bdc6={'x':_0x336aa6-_0x5d8524*_0x33fc90*_0xf5c3e0,'y':_0x110703-_0x55e928*_0x3a9183*0.5},_0x4edfe1={'x':_0x5f3411-_0x5d8524*_0x33fc90*_0xf5c3e0,'y':_0x1d025c+_0x55e928*_0x3a9183*0.4},_0x12d856={'x':_0x5f3411,'y':_0x1d025c},_0x1c565a={'x':_0x5f3411+_0x5d8524*_0x33fc90*_0xf5c3e0,'y':_0x1d025c-_0x55e928*_0x3a9183*0.4},_0x4b8e61={'x':_0xdb3d79+_0x5d8524*_0x33fc90*_0xf5c3e0,'y':_0x189ee7+_0x55e928*_0x3a9183*0.6},_0x4de4af={'x':_0xdb3d79,'y':_0x189ee7},_0x249a95={'x':_0xdb3d79-_0x5d8524*_0x33fc90*0.1,'y':_0x189ee7+_0x3fcc81*0.05},_0x2be50e={'x':_0x14bb76,'y':_0xa465d-_0x3fcc81*0.2},_0x4e8d1b={'x':_0x14bb76,'y':_0xa465d};_0x1c96fc=[{'p0':_0x295202,'p1':_0x1e39a8,'p2':_0x1cfdf4,'p3':_0x301c6c},{'p0':_0x301c6c,'p1':_0x4ef4af,'p2':_0x23a949,'p3':_0x5f636e},{'p0':_0x5f636e,'p1':_0x28bdc6,'p2':_0x4edfe1,'p3':_0x12d856},{'p0':_0x12d856,'p1':_0x1c565a,'p2':_0x4b8e61,'p3':_0x4de4af},{'p0':_0x4de4af,'p1':_0x249a95,'p2':_0x2be50e,'p3':_0x4e8d1b}];}}return _0x406518['push'](..._0x1c96fc),_0x406518;}catch(_0xa008c0){return console[_0x172c9b(0x104)](_0x172c9b(0x96)+_0x7ddce6?.['id']+':',_0xa008c0),[];}}function handleEnemyHit(_0x47da1c){const _0xfff436=_0x27dd;if(!_0x47da1c)return{'destroyed':![],'pointsAwarded':0x0};const _0x5136de=Date[_0xfff436(0x164)]();let _0x5cd15b=0x0,_0x4edd42=![],_0x4dd843=_0x47da1c['isDamaged'],_0x5a9505=null;const _0x33c0b2=_0x47da1c[_0xfff436(0x142)]===ENEMY3_TYPE?BOSS_WIDTH:_0x47da1c[_0xfff436(0x142)]===ENEMY1_TYPE?ENEMY1_WIDTH:ENEMY_WIDTH,_0x4e6861=_0x47da1c[_0xfff436(0x142)]===ENEMY3_TYPE?BOSS_HEIGHT:_0x47da1c[_0xfff436(0x142)]===ENEMY1_TYPE?ENEMY1_HEIGHT:ENEMY_HEIGHT,_0x2055ca=_0x47da1c[_0xfff436(0x142)]===ENEMY3_TYPE&&_0x47da1c[_0xfff436(0x77)],_0x52ca13=_0x47da1c[_0xfff436(0x142)]===ENEMY3_TYPE&&_0x47da1c[_0xfff436(0x99)],_0x1391ce=_0x47da1c['x']+_0x33c0b2/0x2,_0x160261=_0x47da1c['y']+_0x4e6861*0.2;createHitSparks(_0x1391ce,_0x160261),_0x47da1c[_0xfff436(0x13c)]--;_0x47da1c['type']===ENEMY3_TYPE&&(_0x47da1c[_0xfff436(0x159)]=_0x47da1c[_0xfff436(0x13c)]<ENEMY3_MAX_HITS);if(_0x47da1c[_0xfff436(0x13c)]<=0x0){_0x4edd42=!![];if(_0x2055ca&&_0x52ca13){if(_0x47da1c[_0xfff436(0x99)]){const _0x3caa1b=_0x47da1c[_0xfff436(0x99)][_0xfff436(0x17e)],_0x4054b3=_0x47da1c[_0xfff436(0x99)][_0xfff436(0x166)],_0x4e99a3=_0x47da1c['x']+(_0x33c0b2-_0x3caa1b)/0x2+CAPTURED_SHIP_OFFSET_X,_0x3522ed=_0x47da1c['y']+CAPTURED_SHIP_OFFSET_Y,_0x55ca52=fallingShips[_0xfff436(0xda)](_0x1ba645=>Math[_0xfff436(0xb8)](_0x1ba645['x']-_0x4e99a3)<0x1&&Math[_0xfff436(0xb8)](_0x1ba645['y']-_0x3522ed)<0x1);!_0x55ca52?fallingShips[_0xfff436(0xb3)]({'x':_0x4e99a3,'y':_0x3522ed,'width':_0x3caa1b,'height':_0x4054b3,'creationTime':_0x5136de,'tintProgress':0x1,'rotation':0x0}):console[_0xfff436(0x117)]('[handleEnemyHit]\x20Attempted\x20to\x20create\x20falling\x20ship,\x20but\x20similar\x20one\x20already\x20exists.\x20Skipping.');}else console['error'](_0xfff436(0xdb));_0x47da1c['hasCapturedShip']=![],_0x47da1c[_0xfff436(0x99)]=null;}else _0x2055ca&&!_0x52ca13&&(console[_0xfff436(0x104)]('[handleEnemyHit]\x20CRITICAL:\x20Boss\x20'+_0x47da1c['id']+'\x20destroyed,\x20had\x20ship\x20initially\x20but\x20dimensions\x20missing!\x20Resetting\x20state\x20anyway.'),_0x47da1c[_0xfff436(0x77)]=![],_0x47da1c[_0xfff436(0x99)]=null);if(isChallengingStage){let _0x30669f=0x64;const _0xacc580=csLastHitTime;csLastHitTime=_0x5136de,csLastChainHitPosition={'x':_0x47da1c['x'],'y':_0x47da1c['y']},csCurrentChainHits>0x0&&_0x5136de-_0xacc580<CS_CHAIN_BREAK_TIME_MS?csCurrentChainHits++:(csCurrentChainHits=0x1,csCurrentChainScore=0x0),csCurrentChainHits>=CS_CHAIN_SCORE_THRESHOLD&&(_0x30669f*=0x2),_0x5cd15b=_0x30669f,csCurrentChainScore+=_0x5cd15b,scoreEarnedThisCS+=_0x5cd15b,challengingStageEnemiesHit++,_0x5a9505=explosionSound;}else{if(_0x47da1c['state']===_0xfff436(0x14f))_0x5cd15b=_0x47da1c['type']===ENEMY1_TYPE?0x32:_0x47da1c['type']===ENEMY2_TYPE?0x50:0x0,_0x47da1c[_0xfff436(0x142)]===ENEMY3_TYPE&&(_0x5cd15b=0x96),_0x5a9505=explosionSound;else{_0x5cd15b=_0x47da1c[_0xfff436(0x142)]===ENEMY1_TYPE?0x64:_0x47da1c['type']===ENEMY2_TYPE?0xa0:0x0;if(_0x47da1c['type']===ENEMY3_TYPE){if(_0x2055ca){const _0x12f02e=[0x3e8,0x5dc,0x7d0,0xbb8];_0x5cd15b=_0x12f02e[Math['floor'](Math[_0xfff436(0x149)]()*_0x12f02e[_0xfff436(0x140)])],_0x5a9505=bossHit2Sound;}else _0x4dd843?(_0x5cd15b=0x190,_0x5a9505=bossHit2Sound):(_0x5cd15b=0x0,console[_0xfff436(0x117)](_0xfff436(0x156)+_0x5cd15b+_0xfff436(0x84)+(_0x47da1c[_0xfff436(0x13c)]+0x1)),_0x5a9505=explosionSound);}else _0x5a9505=explosionSound;if(_0x4edd42&&_0x5cd15b>0x0){const _0x4d0c5e=normalWaveLastHitTime;normalWaveLastHitTime=_0x5136de,normalWaveLastChainHitPosition={'x':_0x47da1c['x'],'y':_0x47da1c['y']};normalWaveLastChainHitPosition&&_0x5136de-_0x4d0c5e<NORMAL_WAVE_CHAIN_BREAK_TIME_MS?normalWaveCurrentChainHits++:(normalWaveCurrentChainHits=0x1,normalWaveCurrentChainScore=0x0);if(NORMAL_WAVE_CHAIN_BONUS_ENABLED&&normalWaveCurrentChainHits>=NORMAL_WAVE_CHAIN_SCORE_THRESHOLD){const _0x42e302=[0x12c,0x258,0x3e8,0x5dc,0x7d0,0xbb8],_0x2b9766=Math[_0xfff436(0xfa)](_0x42e302['length']-0x1,normalWaveCurrentChainHits-NORMAL_WAVE_CHAIN_SCORE_THRESHOLD),_0x3d8a36=_0x42e302[_0x2b9766];_0x5cd15b+=_0x3d8a36,normalWaveCurrentChainScore+=_0x3d8a36;}}}}if(_0x5cd15b>0x0){score+=_0x5cd15b,highScore=Math[_0xfff436(0x182)](highScore,score);let _0x3719ae=![],_0x4f7913=null;if(!isManualControl)_0x3719ae=player1TriggeredHighScoreSound,_0x4f7913=()=>{player1TriggeredHighScoreSound=!![];};else isTwoPlayerMode?currentPlayer===0x1?(_0x3719ae=player1TriggeredHighScoreSound,_0x4f7913=()=>{player1TriggeredHighScoreSound=!![];}):(_0x3719ae=player2TriggeredHighScoreSound,_0x4f7913=()=>{player2TriggeredHighScoreSound=!![];}):(_0x3719ae=player1TriggeredHighScoreSound,_0x4f7913=()=>{player1TriggeredHighScoreSound=!![];});if(!_0x3719ae){if(score>highScore-_0x5cd15b){if(_0x4f7913)_0x4f7913();playSound(hiScoreSound);}}_0x4edd42&&(!isManualControl||currentPlayer===0x1||!isTwoPlayerMode?(player1Score=score,player1EnemiesHit++):(player2Score=score,player2EnemiesHit++));checkAndAwardExtraLife();const _0x4a6770=_0x47da1c['state']===_0xfff436(0x14f)||isChallengingStage?FLOATING_SCORE_COLOR_GRID:FLOATING_SCORE_COLOR_ACTIVE;floatingScores[_0xfff436(0xb3)]({'text':_0x5cd15b[_0xfff436(0x154)](),'x':_0x47da1c['x']+_0x33c0b2/0x2,'y':_0x47da1c['y'],'color':_0x4a6770,'creationTime':_0x5136de,'displayStartTime':_0x5136de+FLOATING_SCORE_APPEAR_DELAY});}createExplosion(_0x47da1c['x']+_0x33c0b2/0x2,_0x47da1c['y']+_0x4e6861/0x2);_0x47da1c['id']===capturingBossId&&stopSound(captureSound);if(_0x47da1c[_0xfff436(0xfd)]===_0xfff436(0xd1)||_0x47da1c[_0xfff436(0xfd)]===_0xfff436(0xec)||_0x47da1c[_0xfff436(0xfd)]===_0xfff436(0x11e)||_0x47da1c[_0xfff436(0xfd)]===_0xfff436(0x9f)||_0x47da1c[_0xfff436(0xfd)]===_0xfff436(0xa4)||_0x47da1c[_0xfff436(0xfd)]===_0xfff436(0x100)){if(_0x47da1c[_0xfff436(0x142)]===ENEMY3_TYPE)stopSound(bossGalagaDiveSound);else stopSound(butterflyDiveSound);}}else _0x4edd42=![],_0x47da1c[_0xfff436(0x142)]===ENEMY3_TYPE?(_0x5a9505=bossHit1Sound,_0x5cd15b=0x0):_0x5cd15b=0x0;return _0x5a9505&&playSound(_0x5a9505),{'destroyed':_0x4edd42,'pointsAwarded':_0x5cd15b};}function createHitSparks(_0x4b7f70,_0x293a71){const _0xc6c8d2=_0x27dd;if(!gameCtx)return;const _0x1b8297=Date[_0xc6c8d2(0x164)]();for(let _0x46ca57=0x0;_0x46ca57<HIT_SPARK_COUNT;_0x46ca57++){const _0x4c8754=Math['random']()*Math['PI']*0x2,_0x4c7d82=HIT_SPARK_SPEED*(0.7+Math[_0xc6c8d2(0x149)]()*0.6),_0x5347e9=HIT_SPARK_LIFETIME*(0.8+Math[_0xc6c8d2(0x149)]()*0.4);hitSparks[_0xc6c8d2(0xb3)]({'x':_0x4b7f70,'y':_0x293a71,'vx':Math[_0xc6c8d2(0x108)](_0x4c8754)*_0x4c7d82,'vy':Math[_0xc6c8d2(0xc1)](_0x4c8754)*_0x4c7d82,'creationTime':_0x1b8297,'lifetime':_0x5347e9,'size':HIT_SPARK_SIZE,'color':HIT_SPARK_COLOR});}}function updateHitSparks(){const _0x1be1ca=_0x27dd,_0x43a5b0=Date[_0x1be1ca(0x164)]();for(let _0x5b8497=hitSparks[_0x1be1ca(0x140)]-0x1;_0x5b8497>=0x0;_0x5b8497--){const _0x305768=hitSparks[_0x5b8497],_0x27607f=_0x43a5b0-_0x305768[_0x1be1ca(0xcc)];_0x27607f>=_0x305768[_0x1be1ca(0x15c)]?hitSparks[_0x1be1ca(0x76)](_0x5b8497,0x1):(_0x305768['vy']+=HIT_SPARK_GRAVITY,_0x305768['x']+=_0x305768['vx'],_0x305768['y']+=_0x305768['vy'],_0x305768[_0x1be1ca(0xf1)]=Math[_0x1be1ca(0x182)](0x0,0x1-_0x27607f*HIT_SPARK_FADE_SPEED));}}function moveEntities(){const _0xa7006d=_0x27dd;if(isPaused)return;try{if(ship&&isInGameState&&playerLives>0x0&&gameOverSequenceStartTime===0x0&&!isShowingPlayerGameOverMessage&&!isWaitingForRespawn){let _0x3d5e73=ship[_0xa7006d(0x17e)];isDualShipActive&&(_0x3d5e73+=DUAL_SHIP_OFFSET_X);let _0x28c6bd=ship['x'];if(isManualControl){let _0x3e6b28=![],_0x198c4e=![];currentPlayer===0x1||!isTwoPlayerMode?(_0x3e6b28=leftPressed,_0x198c4e=rightPressed):(_0x3e6b28=p2LeftPressed,_0x198c4e=p2RightPressed);if(_0x3e6b28&&ship['x']>0x0)_0x28c6bd=ship['x']-ship[_0xa7006d(0x188)];else _0x198c4e&&ship['x']<gameCanvas[_0xa7006d(0x17e)]-_0x3d5e73&&(_0x28c6bd=ship['x']+ship['speed']);ship['x']=Math[_0xa7006d(0x182)](0x0,Math[_0xa7006d(0xfa)](gameCanvas['width']-_0x3d5e73,_0x28c6bd)),ship[_0xa7006d(0x169)]=ship['x'];}else{if(typeof smoothedShipX!==_0xa7006d(0xb4)){const _0x4c91f9=0.1,_0x463371=1.2;smoothedShipX+=(ship[_0xa7006d(0x169)]-smoothedShipX)*AI_SMOOTHING_FACTOR_MOVE;const _0x25274e=smoothedShipX-ship['x'],_0x152123=ship[_0xa7006d(0x188)]*_0x463371;let _0x3bf595=0x0;if(Math['abs'](_0x25274e)>_0x4c91f9){const _0x38828d=isChallengingStage?CS_AI_MOVE_FRACTION:NORMAL_MOVE_FRACTION;_0x3bf595=_0x25274e*_0x38828d,_0x3bf595=Math[_0xa7006d(0x182)](-_0x152123,Math[_0xa7006d(0xfa)](_0x152123,_0x3bf595)),Math['abs'](_0x3bf595)>Math[_0xa7006d(0xb8)](_0x25274e)&&(_0x3bf595=_0x25274e),ship['x']+=_0x3bf595,ship['x']=Math[_0xa7006d(0x182)](0x0,Math[_0xa7006d(0xfa)](gameCanvas[_0xa7006d(0x17e)]-_0x3d5e73,ship['x']));}}else ship['x']=Math[_0xa7006d(0x182)](0x0,Math[_0xa7006d(0xfa)](gameCanvas[_0xa7006d(0x17e)]-_0x3d5e73,ship[_0xa7006d(0x169)]));}}const _0x187e96=Date[_0xa7006d(0x164)]();for(let _0x103904=bullets[_0xa7006d(0x140)]-0x1;_0x103904>=0x0;_0x103904--){const _0x50303a=bullets[_0x103904];_0x50303a?(_0x50303a['y']-=_0x50303a[_0xa7006d(0x188)],_0x50303a['y']+PLAYER_BULLET_HEIGHT<0x0&&bullets['splice'](_0x103904,0x1)):bullets[_0xa7006d(0x76)](_0x103904,0x1);}for(let _0x4e5458=enemyBullets[_0xa7006d(0x140)]-0x1;_0x4e5458>=0x0;_0x4e5458--){const _0x236e0d=enemyBullets[_0x4e5458];if(!_0x236e0d){enemyBullets[_0xa7006d(0x76)](_0x4e5458,0x1);continue;}_0x236e0d['x']+=_0x236e0d['vx'],_0x236e0d['y']+=_0x236e0d['vy'],(_0x236e0d['y']>gameCanvas[_0xa7006d(0x166)]||_0x236e0d['y']<-ENEMY_BULLET_HEIGHT||_0x236e0d['x']<-ENEMY_BULLET_WIDTH||_0x236e0d['x']>gameCanvas[_0xa7006d(0x17e)])&&enemyBullets['splice'](_0x4e5458,0x1);}for(let _0x124be9=fallingShips['length']-0x1;_0x124be9>=0x0;_0x124be9--){const _0x137216=fallingShips[_0x124be9];if(!_0x137216){fallingShips[_0xa7006d(0x76)](_0x124be9,0x1);continue;}_0x137216['y']+=FALLING_SHIP_SPEED;const _0x2a8036=_0x187e96-_0x137216[_0xa7006d(0xcc)];typeof _0x137216[_0xa7006d(0xde)]===_0xa7006d(0x102)?_0x137216[_0xa7006d(0xde)]=Math[_0xa7006d(0x182)](0x0,0x1-_0x2a8036/FALLING_SHIP_FADE_DURATION_MS):_0x137216[_0xa7006d(0xde)]=0x0;if(typeof _0x137216[_0xa7006d(0xe1)]===_0xa7006d(0x102)){const _0x560538=Math['min'](0x1,_0x2a8036/FALLING_SHIP_ROTATION_DURATION_MS);_0x137216[_0xa7006d(0xe1)]=_0x560538*0x2*(0x2*Math['PI']);}else _0x137216[_0xa7006d(0xe1)]=0x0;if(ship&&!isDualShipActive&&!isShipCaptured&&!isWaitingForRespawn&&_0x137216['y']+_0x137216[_0xa7006d(0x166)]>=gameCanvas[_0xa7006d(0x166)]-AUTO_DOCK_THRESHOLD){fallingShips['splice'](_0x124be9,0x1),isDualShipActive=!![];currentPlayer===0x1?player1IsDualShipActive=!![]:player2IsDualShipActive=!![];playSound(dualShipSound);continue;}_0x137216['y']>gameCanvas[_0xa7006d(0x166)]+_0x137216[_0xa7006d(0x166)]&&fallingShips[_0xa7006d(0x76)](_0x124be9,0x1);}let _0x120d58=0x0;if(!isChallengingStage&&!isWaveTransitioning&&isGridSoundPlaying&&enemies[_0xa7006d(0xda)](_0x17f038=>_0x17f038?.['state']===_0xa7006d(0x14f))&&!isShowingPlayerGameOverMessage){const _0x3fed43=enemies[_0xa7006d(0x8f)](_0x2568d7=>_0x2568d7?.[_0xa7006d(0xfd)]===_0xa7006d(0x14f));if(_0x3fed43['length']>0x0){let _0x25073d=gameCanvas['width'],_0x3f64fa=0x0;_0x3fed43[_0xa7006d(0x7e)](_0x33da43=>{const _0x3e5bd1=_0xa7006d;_0x33da43&&(_0x25073d=Math['min'](_0x25073d,_0x33da43['x']),_0x3f64fa=Math['max'](_0x3f64fa,_0x33da43['x']+_0x33da43[_0x3e5bd1(0x17e)]));});const _0x370d35=gameCanvas[_0xa7006d(0x17e)]*GRID_HORIZONTAL_MARGIN_PERCENT,_0x353d0f=gameCanvas[_0xa7006d(0x17e)]*(0x1-GRID_HORIZONTAL_MARGIN_PERCENT);if(gridMoveDirection===0x1&&_0x3f64fa>=_0x353d0f)gridMoveDirection=-0x1;else gridMoveDirection===-0x1&&_0x25073d<=_0x370d35&&(gridMoveDirection=0x1);const _0x1d8d63=scaleValue(level,BASE_GRID_MOVE_SPEED,MAX_GRID_MOVE_SPEED);_0x120d58=_0x1d8d63*gridMoveDirection,currentGridOffsetX+=_0x120d58,enemies[_0xa7006d(0x7e)](_0x2f66a6=>{const _0x5956e8=_0xa7006d;if(_0x2f66a6&&(_0x2f66a6['state']===_0x5956e8(0xa4)||_0x2f66a6[_0x5956e8(0xfd)]===_0x5956e8(0x14f)||_0x2f66a6[_0x5956e8(0xfd)]===_0x5956e8(0x181)))try{const _0x215c4c=_0x2f66a6[_0x5956e8(0x142)]===ENEMY3_TYPE?BOSS_WIDTH:_0x2f66a6['type']===ENEMY1_TYPE?ENEMY1_WIDTH:ENEMY_WIDTH,{x:_0xed6648,y:_0xc2a9e5}=getCurrentGridSlotPosition(_0x2f66a6[_0x5956e8(0x138)],_0x2f66a6[_0x5956e8(0x8a)],_0x215c4c);_0x2f66a6[_0x5956e8(0xa9)]=_0xed6648,_0x2f66a6[_0x5956e8(0x12e)]=_0xc2a9e5;}catch(_0x25bd0e){console[_0x5956e8(0x104)]('Error\x20updating\x20target\x20grid\x20pos\x20for\x20enemy\x20'+_0x2f66a6?.['id']+_0x5956e8(0x78)+_0x2f66a6?.['state']+_0x5956e8(0x12a),_0x25bd0e);}});}else isGridSoundPlaying&&(stopSound(gridBackgroundSound),isGridSoundPlaying=![]);}else isGridSoundPlaying&&(!enemies[_0xa7006d(0xda)](_0x45cb27=>_0x45cb27?.[_0xa7006d(0xfd)]==='in_grid')||isChallengingStage||isWaveTransitioning||isShowingPlayerGameOverMessage)&&(stopSound(gridBackgroundSound),isGridSoundPlaying=![]);for(let _0x49d065=enemies['length']-0x1;_0x49d065>=0x0;_0x49d065--){let _0x31ae6f=enemies[_0x49d065];if(!_0x31ae6f)continue;const _0x80db3a=_0x31ae6f['id'];if(_0x31ae6f[_0xa7006d(0x110)]&&_0x31ae6f[_0xa7006d(0xfd)]!==_0xa7006d(0xf9)){clearTimeout(_0x31ae6f[_0xa7006d(0x110)]);const _0xd37bfb=enemySpawnTimeouts[_0xa7006d(0x12c)](_0x31ae6f[_0xa7006d(0x110)]);if(_0xd37bfb>-0x1)enemySpawnTimeouts[_0xa7006d(0x76)](_0xd37bfb,0x1);_0x31ae6f[_0xa7006d(0x110)]=null;}const _0x5cfe3b=_0x31ae6f[_0xa7006d(0x142)]===ENEMY3_TYPE?BOSS_WIDTH:_0x31ae6f['type']===ENEMY1_TYPE?ENEMY1_WIDTH:ENEMY_WIDTH,_0x3f0736=_0x31ae6f[_0xa7006d(0x142)]===ENEMY3_TYPE?BOSS_HEIGHT:_0x31ae6f[_0xa7006d(0x142)]===ENEMY1_TYPE?ENEMY1_HEIGHT:ENEMY_HEIGHT;switch(_0x31ae6f[_0xa7006d(0xfd)]){case _0xa7006d(0x9f):{let _0xef765=CS_ENTRANCE_PATH_SPEED;const _0x4c677b=_0x31ae6f[_0xa7006d(0xed)]||0x1;_0xef765*=_0x4c677b;if(!isChallengingStage){enemies[_0xa7006d(0x76)](_0x49d065,0x1),_0x31ae6f=null;break;}let _0x2f8920=challengingStagePaths,_0x51ab81=_0x2f8920[_0x31ae6f['entrancePathId']];if(!_0x51ab81||_0x31ae6f[_0xa7006d(0x6b)]>=_0x51ab81[_0xa7006d(0x140)]){enemies[_0xa7006d(0x76)](_0x49d065,0x1),_0x31ae6f=null;break;}const _0x21d2c8=_0x51ab81[_0x31ae6f[_0xa7006d(0x6b)]];if(!_0x21d2c8||!_0x21d2c8['p0']||!_0x21d2c8['p1']||!_0x21d2c8['p2']||!_0x21d2c8['p3']){console['error'](_0xa7006d(0xc7)+_0x31ae6f['pathSegmentIndex']+_0xa7006d(0x17b)+_0x31ae6f[_0xa7006d(0x15e)]+_0xa7006d(0xd7)+_0x31ae6f['id']),enemies[_0xa7006d(0x76)](_0x49d065,0x1),_0x31ae6f=null;break;}_0x31ae6f[_0xa7006d(0x14e)]+=_0xef765;let _0x3ad6c7,_0x37a72b,_0x3d9be8=_0x31ae6f['x'],_0x2b2db6=_0x31ae6f['y'];if(_0x31ae6f[_0xa7006d(0x14e)]>=0x1){_0x31ae6f['pathT']=0x0,_0x31ae6f[_0xa7006d(0x6b)]++;if(_0x31ae6f[_0xa7006d(0x6b)]>=_0x51ab81['length'])enemies['splice'](_0x49d065,0x1),_0x31ae6f=null;else{const _0x151973=_0x51ab81[_0x31ae6f[_0xa7006d(0x6b)]];_0x151973?.['p0']?(_0x3ad6c7=_0x151973['p0']['x'],_0x37a72b=_0x151973['p0']['y']):(console['error'](_0xa7006d(0x9c)+_0x31ae6f[_0xa7006d(0x6b)]+_0xa7006d(0x17b)+_0x31ae6f['entrancePathId']+'.\x20Enemy\x20'+_0x80db3a),enemies[_0xa7006d(0x76)](_0x49d065,0x1),_0x31ae6f=null);}}else try{_0x3ad6c7=calculateBezierPoint(_0x31ae6f['pathT'],_0x21d2c8['p0']['x'],_0x21d2c8['p1']['x'],_0x21d2c8['p2']['x'],_0x21d2c8['p3']['x']),_0x37a72b=calculateBezierPoint(_0x31ae6f['pathT'],_0x21d2c8['p0']['y'],_0x21d2c8['p1']['y'],_0x21d2c8['p2']['y'],_0x21d2c8['p3']['y']);}catch(_0x46f84d){console['error'](_0xa7006d(0xfc)+_0x80db3a+':',_0x46f84d),enemies[_0xa7006d(0x76)](_0x49d065,0x1),_0x31ae6f=null;}_0x31ae6f&&(isNaN(_0x3ad6c7)||isNaN(_0x37a72b)?(console[_0xa7006d(0x104)](_0xa7006d(0x88)+_0x80db3a+_0xa7006d(0x118)),enemies[_0xa7006d(0x76)](_0x49d065,0x1),_0x31ae6f=null):(_0x31ae6f[_0xa7006d(0xce)]=_0x3ad6c7-_0x3d9be8,_0x31ae6f['velocityY']=_0x37a72b-_0x2b2db6,_0x31ae6f['x']=_0x3ad6c7,_0x31ae6f['y']=_0x37a72b));break;}case _0xa7006d(0xec):{if(isChallengingStage){enemies[_0xa7006d(0x76)](_0x49d065,0x1),_0x31ae6f=null;break;}let _0x490179=normalWaveEntrancePaths,_0x518ce4=_0x490179[_0x31ae6f[_0xa7006d(0x15e)]],_0x2732bb;_0x31ae6f[_0xa7006d(0x15e)]===_0xa7006d(0xf3)||_0x31ae6f[_0xa7006d(0x15e)]===_0xa7006d(0x17c)?_0x2732bb=BOSS_LOOP_ENTRANCE_PATH_SPEED:_0x2732bb=NORMAL_ENTRANCE_PATH_SPEED;if(!_0x518ce4){console['warn'](_0xa7006d(0xaf)+_0x80db3a+_0xa7006d(0x109)+_0x31ae6f[_0xa7006d(0x15e)]+'.\x20Switching\x20to\x20moving_to_grid.');try{_0x31ae6f[_0xa7006d(0xa9)]=_0x31ae6f[_0xa7006d(0xa9)]??gameCanvas[_0xa7006d(0x17e)]/0x2,_0x31ae6f[_0xa7006d(0x12e)]=_0x31ae6f[_0xa7006d(0x12e)]??ENEMY_TOP_MARGIN;}catch(_0xf94eb1){console[_0xa7006d(0x104)]('Error\x20getting\x20grid\x20pos\x20for\x20'+_0x80db3a+_0xa7006d(0x186),_0xf94eb1),_0x31ae6f[_0xa7006d(0xa9)]=gameCanvas[_0xa7006d(0x17e)]/0x2,_0x31ae6f[_0xa7006d(0x12e)]=ENEMY_TOP_MARGIN;}_0x31ae6f[_0xa7006d(0xfd)]=_0xa7006d(0x181),_0x31ae6f[_0xa7006d(0x14e)]=0x0,_0x31ae6f[_0xa7006d(0x6b)]=0x0,_0x31ae6f[_0xa7006d(0xce)]=0x0,_0x31ae6f[_0xa7006d(0x17d)]=0x0;_0x31ae6f[_0xa7006d(0xdf)]!==undefined&&squadronCompletionStatus[_0x31ae6f[_0xa7006d(0xdf)]]&&squadronCompletionStatus[_0x31ae6f['squadronId']][_0xa7006d(0xff)]++;break;}if(_0x31ae6f[_0xa7006d(0x6b)]>=_0x518ce4[_0xa7006d(0x140)]){console[_0xa7006d(0x117)](_0xa7006d(0xaf)+_0x80db3a+_0xa7006d(0xd0)+_0x31ae6f[_0xa7006d(0x6b)]+_0xa7006d(0x11d)+_0x31ae6f[_0xa7006d(0x15e)]+_0xa7006d(0x16f));try{_0x31ae6f[_0xa7006d(0xa9)]=_0x31ae6f[_0xa7006d(0xa9)]??gameCanvas[_0xa7006d(0x17e)]/0x2,_0x31ae6f['targetGridY']=_0x31ae6f[_0xa7006d(0x12e)]??ENEMY_TOP_MARGIN;}catch(_0x5e99a8){console[_0xa7006d(0x104)]('Error\x20getting\x20grid\x20pos\x20for\x20'+_0x80db3a+_0xa7006d(0x16b),_0x5e99a8),_0x31ae6f['targetGridX']=gameCanvas[_0xa7006d(0x17e)]/0x2,_0x31ae6f[_0xa7006d(0x12e)]=ENEMY_TOP_MARGIN;}_0x31ae6f[_0xa7006d(0xfd)]=_0xa7006d(0x181),_0x31ae6f[_0xa7006d(0x14e)]=0x0,_0x31ae6f[_0xa7006d(0x6b)]=0x0,_0x31ae6f[_0xa7006d(0xce)]=0x0,_0x31ae6f['velocityY']=0x0;_0x31ae6f[_0xa7006d(0xdf)]!==undefined&&squadronCompletionStatus[_0x31ae6f['squadronId']]&&squadronCompletionStatus[_0x31ae6f[_0xa7006d(0xdf)]][_0xa7006d(0xff)]++;break;}const _0x5c8546=_0x518ce4[_0x31ae6f[_0xa7006d(0x6b)]];if(!_0x5c8546||!_0x5c8546['p0']||!_0x5c8546['p1']||!_0x5c8546['p2']||!_0x5c8546['p3']){console[_0xa7006d(0x104)](_0xa7006d(0x6a)+_0x31ae6f['pathSegmentIndex']+_0xa7006d(0x8e)+_0x31ae6f[_0xa7006d(0x15e)]+_0xa7006d(0xd7)+_0x80db3a+_0xa7006d(0x16f));try{_0x31ae6f[_0xa7006d(0xa9)]=_0x31ae6f[_0xa7006d(0xa9)]??gameCanvas['width']/0x2,_0x31ae6f[_0xa7006d(0x12e)]=_0x31ae6f[_0xa7006d(0x12e)]??ENEMY_TOP_MARGIN+_0x31ae6f['gridRow']*(ENEMY_HEIGHT+ENEMY_V_SPACING);}catch(_0x362b9f){console[_0xa7006d(0x104)](_0xa7006d(0x126)+_0x80db3a+_0xa7006d(0x133),_0x362b9f),_0x31ae6f[_0xa7006d(0xa9)]=gameCanvas[_0xa7006d(0x17e)]/0x2,_0x31ae6f['targetGridY']=ENEMY_TOP_MARGIN;}_0x31ae6f[_0xa7006d(0xfd)]='moving_to_grid',_0x31ae6f[_0xa7006d(0x14e)]=0x0,_0x31ae6f['pathSegmentIndex']=0x0,_0x31ae6f[_0xa7006d(0xce)]=0x0,_0x31ae6f[_0xa7006d(0x17d)]=0x0;_0x31ae6f[_0xa7006d(0xdf)]!==undefined&&squadronCompletionStatus[_0x31ae6f[_0xa7006d(0xdf)]]&&squadronCompletionStatus[_0x31ae6f[_0xa7006d(0xdf)]][_0xa7006d(0xff)]++;break;}_0x31ae6f[_0xa7006d(0x14e)]+=_0x2732bb;let _0x3c9712,_0x16a5fb,_0x50f6b8=_0x31ae6f['x'],_0x12052b=_0x31ae6f['y'];if(_0x31ae6f[_0xa7006d(0x14e)]>=0x1){_0x31ae6f[_0xa7006d(0x14e)]=0x0,_0x31ae6f[_0xa7006d(0x6b)]++;if(_0x31ae6f[_0xa7006d(0x6b)]>=_0x518ce4[_0xa7006d(0x140)]){let _0x336aba,_0x10b11f;try{_0x336aba=calculateBezierPoint(0x1,_0x5c8546['p0']['x'],_0x5c8546['p1']['x'],_0x5c8546['p2']['x'],_0x5c8546['p3']['x']),_0x10b11f=calculateBezierPoint(0x1,_0x5c8546['p0']['y'],_0x5c8546['p1']['y'],_0x5c8546['p2']['y'],_0x5c8546['p3']['y']);}catch(_0x4caad8){console[_0xa7006d(0x104)](_0xa7006d(0xd3)+_0x80db3a+'\x20at\x20end\x20of\x20normal\x20path\x20'+_0x31ae6f[_0xa7006d(0x15e)],_0x4caad8),_0x336aba=_0x5c8546['p3']['x'],_0x10b11f=_0x5c8546['p3']['y'];}_0x31ae6f['x']=_0x336aba,_0x31ae6f['y']=_0x10b11f;try{_0x31ae6f[_0xa7006d(0xa9)]=_0x31ae6f['targetGridX']??gameCanvas['width']/0x2,_0x31ae6f[_0xa7006d(0x12e)]=_0x31ae6f[_0xa7006d(0x12e)]??ENEMY_TOP_MARGIN;}catch(_0x20d40e){console[_0xa7006d(0x104)](_0xa7006d(0xfb)+_0x80db3a+_0xa7006d(0xbb)+_0x31ae6f[_0xa7006d(0x15e)],_0x20d40e),_0x31ae6f[_0xa7006d(0xa9)]=_0x31ae6f['x'],_0x31ae6f[_0xa7006d(0x12e)]=ENEMY_TOP_MARGIN+_0x31ae6f[_0xa7006d(0x138)]*(ENEMY_HEIGHT+ENEMY_V_SPACING);}const _0x49d6cb=_0x31ae6f['state'];_0x31ae6f['state']=_0xa7006d(0x181),_0x31ae6f[_0xa7006d(0xce)]=0x0,_0x31ae6f['velocityY']=0x0,_0x31ae6f[_0xa7006d(0x6b)]=0x0;_0x49d6cb===_0xa7006d(0xec)&&_0x31ae6f[_0xa7006d(0xdf)]!==undefined&&squadronCompletionStatus[_0x31ae6f[_0xa7006d(0xdf)]]&&squadronCompletionStatus[_0x31ae6f[_0xa7006d(0xdf)]][_0xa7006d(0xff)]++;break;}else{const _0x47268b=_0x518ce4[_0x31ae6f[_0xa7006d(0x6b)]];if(_0x47268b?.['p0'])_0x3c9712=_0x47268b['p0']['x'],_0x16a5fb=_0x47268b['p0']['y'];else{console[_0xa7006d(0x104)](_0xa7006d(0x176)+_0x31ae6f[_0xa7006d(0x6b)]+_0xa7006d(0x8e)+_0x31ae6f[_0xa7006d(0x15e)]+_0xa7006d(0xd7)+_0x80db3a+_0xa7006d(0x16f));try{_0x31ae6f[_0xa7006d(0xa9)]=_0x31ae6f[_0xa7006d(0xa9)]??gameCanvas[_0xa7006d(0x17e)]/0x2,_0x31ae6f[_0xa7006d(0x12e)]=_0x31ae6f[_0xa7006d(0x12e)]??ENEMY_TOP_MARGIN;}catch(_0x241c62){console[_0xa7006d(0x104)](_0xa7006d(0x126)+_0x80db3a+_0xa7006d(0x180),_0x241c62),_0x31ae6f[_0xa7006d(0xa9)]=gameCanvas[_0xa7006d(0x17e)]/0x2,_0x31ae6f[_0xa7006d(0x12e)]=ENEMY_TOP_MARGIN;}_0x31ae6f[_0xa7006d(0xfd)]=_0xa7006d(0x181),_0x31ae6f['pathT']=0x0,_0x31ae6f[_0xa7006d(0x6b)]=0x0,_0x31ae6f[_0xa7006d(0xce)]=0x0,_0x31ae6f[_0xa7006d(0x17d)]=0x0;_0x31ae6f[_0xa7006d(0xdf)]!==undefined&&squadronCompletionStatus[_0x31ae6f[_0xa7006d(0xdf)]]&&squadronCompletionStatus[_0x31ae6f[_0xa7006d(0xdf)]][_0xa7006d(0xff)]++;break;}}}else try{_0x3c9712=calculateBezierPoint(_0x31ae6f[_0xa7006d(0x14e)],_0x5c8546['p0']['x'],_0x5c8546['p1']['x'],_0x5c8546['p2']['x'],_0x5c8546['p3']['x']),_0x16a5fb=calculateBezierPoint(_0x31ae6f[_0xa7006d(0x14e)],_0x5c8546['p0']['y'],_0x5c8546['p1']['y'],_0x5c8546['p2']['y'],_0x5c8546['p3']['y']);}catch(_0xc7d497){console[_0xa7006d(0x104)](_0xa7006d(0x120)+_0x80db3a+':',_0xc7d497);try{_0x31ae6f[_0xa7006d(0xa9)]=_0x31ae6f[_0xa7006d(0xa9)]??gameCanvas['width']/0x2,_0x31ae6f[_0xa7006d(0x12e)]=_0x31ae6f[_0xa7006d(0x12e)]??ENEMY_TOP_MARGIN;}catch(_0x32b279){console[_0xa7006d(0x104)]('Error\x20getting\x20grid\x20pos\x20for\x20'+_0x80db3a+'\x20after\x20bezier\x20error',_0x32b279),_0x31ae6f['targetGridX']=gameCanvas[_0xa7006d(0x17e)]/0x2,_0x31ae6f[_0xa7006d(0x12e)]=ENEMY_TOP_MARGIN;}_0x31ae6f[_0xa7006d(0xfd)]='moving_to_grid',_0x31ae6f[_0xa7006d(0x14e)]=0x0,_0x31ae6f[_0xa7006d(0x6b)]=0x0,_0x31ae6f[_0xa7006d(0xce)]=0x0,_0x31ae6f[_0xa7006d(0x17d)]=0x0;_0x31ae6f[_0xa7006d(0xdf)]!==undefined&&squadronCompletionStatus[_0x31ae6f['squadronId']]&&squadronCompletionStatus[_0x31ae6f[_0xa7006d(0xdf)]][_0xa7006d(0xff)]++;break;}if(_0x31ae6f&&_0x31ae6f['state']===_0xa7006d(0xec)){if(isNaN(_0x3c9712)||isNaN(_0x16a5fb)){console[_0xa7006d(0x104)]('NaN\x20detected\x20in\x20Normal\x20path\x20calculation\x20for\x20enemy\x20'+_0x80db3a+'.\x20Switching\x20to\x20moving_to_grid.');try{_0x31ae6f[_0xa7006d(0xa9)]=_0x31ae6f[_0xa7006d(0xa9)]??gameCanvas[_0xa7006d(0x17e)]/0x2,_0x31ae6f[_0xa7006d(0x12e)]=_0x31ae6f[_0xa7006d(0x12e)]??ENEMY_TOP_MARGIN;}catch(_0x3322f4){console['error'](_0xa7006d(0x126)+_0x80db3a+'\x20after\x20NaN',_0x3322f4),_0x31ae6f[_0xa7006d(0xa9)]=gameCanvas[_0xa7006d(0x17e)]/0x2,_0x31ae6f[_0xa7006d(0x12e)]=ENEMY_TOP_MARGIN;}_0x31ae6f[_0xa7006d(0xfd)]=_0xa7006d(0x181),_0x31ae6f[_0xa7006d(0x14e)]=0x0,_0x31ae6f[_0xa7006d(0x6b)]=0x0,_0x31ae6f[_0xa7006d(0xce)]=0x0,_0x31ae6f['velocityY']=0x0,_0x31ae6f[_0xa7006d(0xdf)]!==undefined&&squadronCompletionStatus[_0x31ae6f['squadronId']]&&squadronCompletionStatus[_0x31ae6f[_0xa7006d(0xdf)]]['completed']++;}else{let _0x10459a=_0x3c9712;const _0x23c282=currentWavePatternIndex===0x1&&(_0x31ae6f[_0xa7006d(0xdf)]===0x2||_0x31ae6f[_0xa7006d(0xdf)]===0x3),_0x46b14e=typeof _0x31ae6f[_0xa7006d(0xd4)]===_0xa7006d(0x102)&&_0x31ae6f[_0xa7006d(0xd4)]%0x2!==0x0;if(_0x23c282&&_0x46b14e){const _0x250596=_0x5cfe3b+ENTRANCE_PAIR_HORIZONTAL_GAP;_0x10459a=_0x3c9712+_0x250596;}_0x31ae6f[_0xa7006d(0xce)]=_0x10459a-_0x50f6b8,_0x31ae6f['velocityY']=_0x16a5fb-_0x12052b,_0x31ae6f['x']=_0x10459a,_0x31ae6f['y']=_0x16a5fb;}}break;}case'moving_to_grid':{if(_0x31ae6f[_0xa7006d(0xa9)]==null||_0x31ae6f[_0xa7006d(0x12e)]==null){console[_0xa7006d(0x117)](_0xa7006d(0xaf)+_0x80db3a+_0xa7006d(0x6f));try{const {x:_0x17e936,y:_0x1b31d4}=getCurrentGridSlotPosition(_0x31ae6f[_0xa7006d(0x138)],_0x31ae6f[_0xa7006d(0x8a)],_0x5cfe3b);_0x31ae6f[_0xa7006d(0xa9)]=_0x17e936,_0x31ae6f[_0xa7006d(0x12e)]=_0x1b31d4;}catch(_0x2d2994){console[_0xa7006d(0x104)](_0xa7006d(0x126)+_0x80db3a+_0xa7006d(0x111),_0x2d2994),_0x31ae6f['state']='in_grid',_0x31ae6f['x']=gameCanvas[_0xa7006d(0x17e)]/0x2,_0x31ae6f['y']=ENEMY_TOP_MARGIN;break;}}const _0x5a0459=_0x31ae6f['targetGridX'],_0x5ec36f=_0x31ae6f[_0xa7006d(0x12e)],_0x172dc9=_0x5a0459-_0x31ae6f['x'],_0x567b0e=_0x5ec36f-_0x31ae6f['y'],_0x571834=Math[_0xa7006d(0x150)](_0x172dc9*_0x172dc9+_0x567b0e*_0x567b0e),_0x1af8b8=ENTRANCE_SPEED*1.2,_0x620276=_0x1af8b8*0.5;if(_0x571834>_0x620276)_0x31ae6f[_0xa7006d(0xce)]=_0x172dc9/_0x571834*_0x1af8b8,_0x31ae6f[_0xa7006d(0x17d)]=_0x567b0e/_0x571834*_0x1af8b8,_0x31ae6f['x']+=_0x31ae6f['velocityX'],_0x31ae6f['y']+=_0x31ae6f['velocityY'];else{_0x31ae6f['x']=_0x5a0459,_0x31ae6f['y']=_0x5ec36f,_0x31ae6f[_0xa7006d(0xce)]=0x0,_0x31ae6f[_0xa7006d(0x17d)]=0x0;const _0x56786d=_0x31ae6f[_0xa7006d(0xfd)];_0x31ae6f[_0xa7006d(0xfd)]=_0xa7006d(0x14f),_0x31ae6f[_0xa7006d(0x92)]=![];!isGridSoundPlaying&&!isChallengingStage&&(isGridSoundPlaying=!![],playSound(gridBackgroundSound));GRID_BREATH_ENABLED&&!isGridBreathingActive&&!isChallengingStage&&(isGridBreathingActive=!![],gridBreathStartTime=_0x187e96,currentGridBreathFactor=0x0);!firstEnemyLanded&&!isFullGridWave&&!isChallengingStage&&(lastGridFireCheckTime=Date[_0xa7006d(0x164)](),firstEnemyLanded=!![]);if(_0x56786d===_0xa7006d(0x181)&&!isChallengingStage&&!isFullGridWave&&_0x31ae6f[_0xa7006d(0xdf)]!==undefined){const _0x566a18=_0x31ae6f[_0xa7006d(0xdf)],_0x124980=squadronCompletionStatus[_0x566a18];if(_0x124980&&!_0x124980['hasFiredPostLanding']){const _0x5bc848=enemies['every'](_0x59b2f1=>{const _0x4068ba=_0xa7006d;if(_0x59b2f1&&_0x59b2f1[_0x4068ba(0xdf)]===_0x566a18)return _0x59b2f1['state']===_0x4068ba(0x14f)||!enemies[_0x4068ba(0xda)](_0x10c24d=>_0x10c24d['id']===_0x59b2f1['id']);return!![];});if(_0x5bc848){_0x124980[_0xa7006d(0xd5)]=!![];const _0x138ab1=enemies['filter'](_0x46c606=>_0x46c606&&_0x46c606['squadronId']===_0x566a18&&_0x46c606['state']===_0xa7006d(0x14f)&&(_0x46c606[_0xa7006d(0x142)]===ENEMY2_TYPE||_0x46c606[_0xa7006d(0x142)]===ENEMY3_TYPE)&&!(_0x46c606['type']===ENEMY3_TYPE&&_0x46c606[_0xa7006d(0x77)]));if(_0x138ab1['length']>0x0){const _0x1409a6=_0x138ab1[Math['floor'](Math[_0xa7006d(0x149)]()*_0x138ab1[_0xa7006d(0x140)])],_0x204a93=_0x1409a6['id'],_0x56b2fb=0xc8+Math[_0xa7006d(0x149)]()*0x190,_0x3af187=setTimeout(()=>{const _0x2c96fb=_0xa7006d;try{const _0x3c3ae4=enemySpawnTimeouts['indexOf'](_0x3af187);if(_0x3c3ae4>-0x1)enemySpawnTimeouts[_0x2c96fb(0x76)](_0x3c3ae4,0x1);if(isPaused||!isInGameState||playerLives<=0x0||isChallengingStage||isWaveTransitioning||isShipCaptured)return;const _0x21ecfd=enemies[_0x2c96fb(0xf2)](_0x1ce464=>_0x1ce464&&_0x1ce464['id']===_0x204a93);_0x21ecfd&&_0x21ecfd[_0x2c96fb(0xfd)]===_0x2c96fb(0x14f)&&(createBulletSimple(_0x21ecfd)&&(playSound(enemyShootSound),_0x21ecfd[_0x2c96fb(0xa1)]=Date['now']()));}catch(_0x4fc9fc){console[_0x2c96fb(0x104)](_0x2c96fb(0x13a)+_0x204a93+':',_0x4fc9fc);}},_0x56b2fb);enemySpawnTimeouts['push'](_0x3af187);}}}}}break;}case _0xa7006d(0x14f):{typeof _0x31ae6f[_0xa7006d(0xa9)]===_0xa7006d(0x102)&&!isNaN(_0x31ae6f['targetGridX'])&&(_0x31ae6f['x']=_0x31ae6f[_0xa7006d(0xa9)]);typeof _0x31ae6f[_0xa7006d(0x12e)]===_0xa7006d(0x102)&&!isNaN(_0x31ae6f[_0xa7006d(0x12e)])&&(_0x31ae6f['y']=_0x31ae6f['targetGridY']);_0x31ae6f[_0xa7006d(0xce)]=isGridSoundPlaying?_0x120d58:0x0,_0x31ae6f[_0xa7006d(0x17d)]=0x0;_0x31ae6f[_0xa7006d(0x142)]===ENEMY3_TYPE&&_0x31ae6f[_0xa7006d(0x77)]&&_0x31ae6f[_0xa7006d(0x99)]&&(_0x31ae6f[_0xa7006d(0xc3)]=_0x31ae6f['x']+CAPTURED_SHIP_OFFSET_X,_0x31ae6f['capturedShipY']=_0x31ae6f['y']+CAPTURED_SHIP_OFFSET_Y);break;}case _0xa7006d(0x130):{_0x31ae6f[_0xa7006d(0xce)]=0x0,_0x31ae6f[_0xa7006d(0x17d)]=0x0;break;}case _0xa7006d(0xf9):{_0x31ae6f[_0xa7006d(0xce)]=0x0,_0x31ae6f['velocityY']=0x0;break;}case _0xa7006d(0x11e):{if(isShipCaptured){_0x31ae6f['state']=_0xa7006d(0xa4);try{const {x:_0x4c6433,y:_0x140f15}=getCurrentGridSlotPosition(_0x31ae6f[_0xa7006d(0x138)],_0x31ae6f[_0xa7006d(0x8a)],_0x5cfe3b);_0x31ae6f[_0xa7006d(0xa9)]=_0x4c6433,_0x31ae6f[_0xa7006d(0x12e)]=_0x140f15;}catch(_0x5caf26){console[_0xa7006d(0x104)](_0xa7006d(0x90)+_0x31ae6f['id']+':',_0x5caf26),_0x31ae6f[_0xa7006d(0xa9)]=gameCanvas['width']/0x2,_0x31ae6f[_0xa7006d(0x12e)]=ENEMY_TOP_MARGIN;}break;}const _0xf52188=_0x31ae6f[_0xa7006d(0x169)],_0x32301a=_0x31ae6f[_0xa7006d(0xf7)];if(_0xf52188==null||_0x32301a==null){console[_0xa7006d(0x104)](_0xa7006d(0x72)+_0x31ae6f['id']+_0xa7006d(0xb1)),_0x31ae6f['state']=_0xa7006d(0xa4);try{const {x:_0x2367ea,y:_0x3ca884}=getCurrentGridSlotPosition(_0x31ae6f[_0xa7006d(0x138)],_0x31ae6f[_0xa7006d(0x8a)],_0x5cfe3b);_0x31ae6f[_0xa7006d(0xa9)]=_0x2367ea,_0x31ae6f[_0xa7006d(0x12e)]=_0x3ca884;}catch(_0x10347c){console['error'](_0xa7006d(0x90)+_0x31ae6f['id']+':',_0x10347c),_0x31ae6f[_0xa7006d(0xa9)]=gameCanvas[_0xa7006d(0x17e)]/0x2,_0x31ae6f['targetGridY']=ENEMY_TOP_MARGIN;}break;}const _0xc667cc=_0xf52188-_0x31ae6f['x'],_0x3af8f4=_0x32301a-_0x31ae6f['y'],_0x35f322=Math[_0xa7006d(0x150)](_0xc667cc*_0xc667cc+_0x3af8f4*_0x3af8f4),_0x21b039=BOSS_CAPTURE_DIVE_SPEED_FACTOR*BASE_ENEMY_ATTACK_SPEED,_0x3faaee=_0x21b039*0.6;_0x35f322>_0x3faaee?(_0x31ae6f['velocityX']=_0xc667cc/_0x35f322*_0x21b039,_0x31ae6f['velocityY']=_0x3af8f4/_0x35f322*_0x21b039,_0x31ae6f['x']+=_0x31ae6f[_0xa7006d(0xce)],_0x31ae6f['y']+=_0x31ae6f[_0xa7006d(0x17d)]):(_0x31ae6f['x']=_0xf52188,_0x31ae6f['y']=_0x32301a,_0x31ae6f[_0xa7006d(0xce)]=0x0,_0x31ae6f[_0xa7006d(0x17d)]=0x0,_0x31ae6f[_0xa7006d(0xfd)]=_0xa7006d(0x71),_0x31ae6f[_0xa7006d(0xc6)]=_0x187e96,capturingBossId=_0x31ae6f['id'],captureBeamActive=!![],captureBeamSource={'x':_0x31ae6f['x']+_0x5cfe3b/0x2,'y':_0x31ae6f['y']+_0x3f0736},captureBeamTargetY=_0x31ae6f['y'],captureBeamProgress=0x0,playSound(captureSound));break;}case _0xa7006d(0x71):{_0x31ae6f[_0xa7006d(0xce)]=0x0,_0x31ae6f[_0xa7006d(0x17d)]=0x0;if(isShipCaptured&&_0x31ae6f['id']!==capturedBossIdWithMessage){console[_0xa7006d(0x117)](_0xa7006d(0xf0)+_0x31ae6f['id']+_0xa7006d(0x82)+capturedBossIdWithMessage+')\x20was\x20already\x20captured.\x20Returning.'),captureBeamActive=![];if(capturingBossId===_0x31ae6f['id'])capturingBossId=null;_0x31ae6f[_0xa7006d(0xfd)]=_0xa7006d(0xa4);try{const {x:_0x2f8d11,y:_0x576017}=getCurrentGridSlotPosition(_0x31ae6f[_0xa7006d(0x138)],_0x31ae6f[_0xa7006d(0x8a)],_0x5cfe3b);_0x31ae6f[_0xa7006d(0xa9)]=_0x2f8d11,_0x31ae6f['targetGridY']=_0x576017;}catch(_0x2db4d2){console[_0xa7006d(0x104)](_0xa7006d(0x90)+_0x31ae6f['id']+':',_0x2db4d2),_0x31ae6f['targetGridX']=gameCanvas[_0xa7006d(0x17e)]/0x2,_0x31ae6f[_0xa7006d(0x12e)]=ENEMY_TOP_MARGIN;}stopSound(captureSound);break;}const _0x259177=_0x187e96-_0x31ae6f[_0xa7006d(0xc6)],_0x26012f=CAPTURE_BEAM_ANIMATION_DURATION_MS/0x2,_0x270dac=CAPTURE_BEAM_DURATION_MS;if(_0x259177<_0x26012f)captureBeamProgress=_0x259177/_0x26012f;else{if(_0x259177<_0x270dac-_0x26012f)captureBeamProgress=0x1;else{if(_0x259177<_0x270dac)captureBeamProgress=0x1-(_0x259177-(_0x270dac-_0x26012f))/_0x26012f;else{captureBeamProgress=0x0,captureBeamActive=![],capturingBossId=null,stopSound(captureSound),_0x31ae6f[_0xa7006d(0xfd)]=_0xa7006d(0xd1),_0x31ae6f[_0xa7006d(0x106)]=generateAttackPath(_0x31ae6f),_0x31ae6f['attackPathSegmentIndex']=0x0,_0x31ae6f[_0xa7006d(0x74)]=0x0,_0x31ae6f['speed']=BASE_ENEMY_ATTACK_SPEED*ENEMY3_ATTACK_SPEED_FACTOR,_0x31ae6f['lastFiredTime']=0x0,_0x31ae6f[_0xa7006d(0x11a)]=!![],_0x31ae6f[_0xa7006d(0x148)]=0x0,_0x31ae6f['attackGroupId']=null;break;}}}captureBeamProgress=Math[_0xa7006d(0x182)](0x0,Math[_0xa7006d(0xfa)](0x1,captureBeamProgress));if(ship&&captureBeamActive&&captureBeamProgress>=0.95&&!isShipCaptured&&!isInvincible){const _0x35e945=BOSS_WIDTH*CAPTURE_BEAM_WIDTH_TOP_FACTOR,_0x233fa4=SHIP_WIDTH*CAPTURE_BEAM_WIDTH_BOTTOM_FACTOR,_0x332134=_0x31ae6f['x']+_0x5cfe3b/0x2,_0x5248a5=_0x31ae6f['y']+_0x3f0736,_0x390ade=gameCanvas[_0xa7006d(0x166)]-LIFE_ICON_MARGIN_BOTTOM-LIFE_ICON_SIZE-0xa,_0x1b4032=Math[_0xa7006d(0x182)](_0x35e945,_0x233fa4),_0x1c04db=_0x332134-_0x1b4032/0x2,_0x527f48=_0x5248a5,_0x563005=_0x390ade-_0x5248a5;if(_0x563005>0x0){const _0x5b39d7={'x':_0x1c04db,'y':_0x527f48,'width':_0x1b4032,'height':_0x563005},_0x495136={'x':ship['x'],'y':ship['y'],'width':ship[_0xa7006d(0x17e)],'height':ship[_0xa7006d(0x166)]};if(checkCollision(_0x495136,_0x5b39d7)){isShipCaptured=!![],_0x31ae6f[_0xa7006d(0x99)]={'width':ship[_0xa7006d(0x17e)],'height':ship[_0xa7006d(0x166)]},_0x31ae6f['hasCapturedShip']=!![],stopSound(captureSound),_0x31ae6f[_0xa7006d(0xfd)]=_0xa7006d(0x100),_0x31ae6f[_0xa7006d(0xa9)]=null,_0x31ae6f['targetGridY']=null,_0x31ae6f['initialCaptureAnimationY']=ship['y'],_0x31ae6f[_0xa7006d(0x80)]=0x0,isShowingCaptureMessage=!![],captureMessageStartTime=_0x187e96,capturedBossIdWithMessage=_0x31ae6f['id'],playSound(shipCapturedSound);const _0x5e2bcb=currentPlayer;playerLives--,csCurrentChainHits=0x0,csCurrentChainScore=0x0,csLastHitTime=0x0,csLastChainHitPosition=null,normalWaveCurrentChainHits=0x0,normalWaveCurrentChainScore=0x0,normalWaveLastHitTime=0x0,normalWaveLastChainHitPosition=null,leftPressed=![],rightPressed=![],shootPressed=![],p2LeftPressed=![],p2RightPressed=![],p2ShootPressed=![],p1JustFiredSingle=![],p2JustFiredSingle=![],p1FireInputWasDown=![],p2FireInputWasDown=![];if(playerLives<=0x0){if(_0x5e2bcb===0x1)player1Lives=0x0;if(_0x5e2bcb===0x2)player2Lives=0x0;if(isTwoPlayerMode){isShowingPlayerGameOverMessage=!![],playerGameOverMessageStartTime=_0x187e96,playerWhoIsGameOver=_0x5e2bcb;const _0x19f278=_0x5e2bcb===0x1?0x2:0x1,_0x31a1d4=_0x19f278===0x1?player1Lives:player2Lives;_0x31a1d4>0x0?nextActionAfterPlayerGameOver='switch_player':nextActionAfterPlayerGameOver='show_results';bullets=[],enemyBullets=[],explosions=[],fallingShips=[],isDualShipActive=![];if(_0x5e2bcb===0x1)player1IsDualShipActive=![];else player2IsDualShipActive=![];playSound(gameOverSound);}else triggerFinalGameOverSequence();break;}else{if(isTwoPlayerMode){if(_0x5e2bcb===0x1)player1Lives=playerLives;else player2Lives=playerLives;}ship&&gameCanvas&&(ship['y']=gameCanvas[_0xa7006d(0x166)]-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN,!isManualControl&&(aiNeedsStabilization=!![])),(!isManualControl||isTwoPlayerMode)&&(forceCenterShipNextReset=!![]),isShipCaptured=![],isInvincible=!![],invincibilityEndTime=_0x187e96+INVINCIBILITY_DURATION_MS;}}}else console[_0xa7006d(0x117)]('Beam\x20collision\x20box\x20has\x20invalid\x20height:',_0x563005);}break;}case _0xa7006d(0x100):{_0x31ae6f[_0xa7006d(0xce)]=0x0,_0x31ae6f[_0xa7006d(0x17d)]=0x0;if(_0x31ae6f[_0xa7006d(0x77)]&&_0x31ae6f[_0xa7006d(0x99)]&&typeof _0x31ae6f[_0xa7006d(0x160)]===_0xa7006d(0x102)){const _0xb07974=_0x187e96-captureMessageStartTime,_0x34ab56=Math[_0xa7006d(0xfa)](0x1,_0xb07974/CAPTURE_MESSAGE_DURATION),_0xaa721a=_0x31ae6f['y']+CAPTURED_SHIP_OFFSET_Y,_0x22a87e=_0x31ae6f[_0xa7006d(0x160)];_0x31ae6f[_0xa7006d(0xa3)]=_0x22a87e+(_0xaa721a-_0x22a87e)*_0x34ab56,_0x31ae6f[_0xa7006d(0xc3)]=_0x31ae6f['x']+CAPTURED_SHIP_OFFSET_X;}else _0x31ae6f[_0xa7006d(0xc3)]=_0x31ae6f['x']+CAPTURED_SHIP_OFFSET_X,_0x31ae6f[_0xa7006d(0xa3)]=_0x31ae6f['y']+CAPTURED_SHIP_OFFSET_Y;break;}case'attacking':{if(isEntrancePhaseActive)break;const _0xbf76e3=_0x31ae6f[_0xa7006d(0x106)],_0x228618=3.8;if(!_0xbf76e3||_0xbf76e3[_0xa7006d(0x140)]===0x0){console[_0xa7006d(0x104)]('Enemy\x20'+_0x80db3a+_0xa7006d(0x143)),_0x31ae6f[_0xa7006d(0xfd)]=_0xa7006d(0xa4);try{const {x:_0x418d18,y:_0xe97911}=getCurrentGridSlotPosition(_0x31ae6f['gridRow'],_0x31ae6f[_0xa7006d(0x8a)],_0x5cfe3b);_0x31ae6f[_0xa7006d(0xa9)]=_0x418d18,_0x31ae6f[_0xa7006d(0x12e)]=_0xe97911;}catch(_0x56ae4a){console[_0xa7006d(0x104)](_0xa7006d(0x177)+_0x80db3a+'\x20(no\x20attack\x20path):',_0x56ae4a),_0x31ae6f[_0xa7006d(0xa9)]=gameCanvas[_0xa7006d(0x17e)]/0x2,_0x31ae6f[_0xa7006d(0x12e)]=ENEMY_TOP_MARGIN;}break;}if(_0x31ae6f[_0xa7006d(0x168)]>=_0xbf76e3[_0xa7006d(0x140)]){console[_0xa7006d(0x117)](_0xa7006d(0xaf)+_0x80db3a+_0xa7006d(0x14d)+_0x31ae6f[_0xa7006d(0x168)]+'\x20out\x20of\x20bounds\x20('+_0xbf76e3[_0xa7006d(0x140)]+_0xa7006d(0x136)),_0x31ae6f[_0xa7006d(0xfd)]=_0xa7006d(0xa4);try{const {x:_0x9f5c34,y:_0x145c35}=getCurrentGridSlotPosition(_0x31ae6f[_0xa7006d(0x138)],_0x31ae6f[_0xa7006d(0x8a)],_0x5cfe3b);_0x31ae6f[_0xa7006d(0xa9)]=_0x9f5c34,_0x31ae6f[_0xa7006d(0x12e)]=_0x145c35;}catch(_0x312014){console[_0xa7006d(0x104)]('Error\x20getting\x20grid\x20pos\x20for\x20returning\x20enemy\x20'+_0x80db3a+_0xa7006d(0xbf),_0x312014),_0x31ae6f[_0xa7006d(0xa9)]=gameCanvas[_0xa7006d(0x17e)]/0x2,_0x31ae6f[_0xa7006d(0x12e)]=ENEMY_TOP_MARGIN;}break;}const _0x454e34=_0xbf76e3[_0x31ae6f['attackPathSegmentIndex']];if(!_0x454e34||!_0x454e34['p0']||!_0x454e34['p1']||!_0x454e34['p2']||!_0x454e34['p3']){console['error'](_0xa7006d(0xaf)+_0x80db3a+_0xa7006d(0x17a)+_0x31ae6f[_0xa7006d(0x168)]+_0xa7006d(0x163)),_0x31ae6f['state']=_0xa7006d(0xa4);try{const {x:_0x2a0b95,y:_0x178492}=getCurrentGridSlotPosition(_0x31ae6f[_0xa7006d(0x138)],_0x31ae6f[_0xa7006d(0x8a)],_0x5cfe3b);_0x31ae6f['targetGridX']=_0x2a0b95,_0x31ae6f[_0xa7006d(0x12e)]=_0x178492;}catch(_0x3e2047){console['error'](_0xa7006d(0x177)+_0x80db3a+'\x20(invalid\x20attack\x20segment):',_0x3e2047),_0x31ae6f[_0xa7006d(0xa9)]=gameCanvas[_0xa7006d(0x17e)]/0x2,_0x31ae6f['targetGridY']=ENEMY_TOP_MARGIN;}break;}const _0x2e2c21=_0x31ae6f[_0xa7006d(0x188)]/0x3e8*_0x228618;_0x31ae6f[_0xa7006d(0x74)]+=_0x2e2c21;let _0x555e78,_0x1091c7;const _0x45410d=_0x31ae6f['x'],_0x3c93db=_0x31ae6f['y'];if(_0x31ae6f[_0xa7006d(0x74)]>=0x1){try{_0x555e78=calculateBezierPoint(0x1,_0x454e34['p0']['x'],_0x454e34['p1']['x'],_0x454e34['p2']['x'],_0x454e34['p3']['x']),_0x1091c7=calculateBezierPoint(0x1,_0x454e34['p0']['y'],_0x454e34['p1']['y'],_0x454e34['p2']['y'],_0x454e34['p3']['y']);}catch(_0x3e6c64){console[_0xa7006d(0x104)](_0xa7006d(0x14a)+_0x31ae6f['id']+':',_0x3e6c64),_0x555e78=_0x31ae6f['x'],_0x1091c7=_0x31ae6f['y'],_0x31ae6f[_0xa7006d(0xfd)]='returning';try{const {x:_0x7b014e,y:_0x19804e}=getCurrentGridSlotPosition(_0x31ae6f[_0xa7006d(0x138)],_0x31ae6f['gridCol'],_0x5cfe3b);_0x31ae6f[_0xa7006d(0xa9)]=_0x7b014e,_0x31ae6f[_0xa7006d(0x12e)]=_0x19804e;}catch(_0x575556){console[_0xa7006d(0x104)](_0xa7006d(0x10a)+_0x31ae6f['id']+':',_0x575556),_0x31ae6f[_0xa7006d(0xa9)]=gameCanvas[_0xa7006d(0x17e)]/0x2,_0x31ae6f[_0xa7006d(0x12e)]=ENEMY_TOP_MARGIN;}break;}_0x31ae6f[_0xa7006d(0x74)]=0x0,_0x31ae6f[_0xa7006d(0x168)]++;if(_0x31ae6f[_0xa7006d(0x168)]>=_0xbf76e3['length']){_0x31ae6f[_0xa7006d(0xfd)]=_0xa7006d(0xa4),_0x31ae6f[_0xa7006d(0xa1)]=0x0,_0x31ae6f[_0xa7006d(0x148)]=0x0,_0x31ae6f[_0xa7006d(0x174)]=null;try{const {x:_0x473d0e,y:_0xe4bbbe}=getCurrentGridSlotPosition(_0x31ae6f[_0xa7006d(0x138)],_0x31ae6f[_0xa7006d(0x8a)],_0x5cfe3b);_0x31ae6f['targetGridX']=_0x473d0e,_0x31ae6f[_0xa7006d(0x12e)]=_0xe4bbbe;}catch(_0x4685eb){console['error'](_0xa7006d(0x177)+_0x80db3a+_0xa7006d(0x189),_0x4685eb),_0x31ae6f['targetGridX']=gameCanvas['width']/0x2,_0x31ae6f[_0xa7006d(0x12e)]=ENEMY_TOP_MARGIN;}}else{const _0x31584f=_0xbf76e3[_0x31ae6f[_0xa7006d(0x168)]];if(!_0x31584f?.['p0']){console[_0xa7006d(0x104)](_0xa7006d(0xaf)+_0x80db3a+_0xa7006d(0x10f)+_0x31ae6f[_0xa7006d(0x168)]+_0xa7006d(0x163)),_0x555e78=_0x31ae6f['x'],_0x1091c7=_0x31ae6f['y'],_0x31ae6f[_0xa7006d(0xfd)]='returning';try{const {x:_0x45ab61,y:_0x26514a}=getCurrentGridSlotPosition(_0x31ae6f[_0xa7006d(0x138)],_0x31ae6f[_0xa7006d(0x8a)],_0x5cfe3b);_0x31ae6f[_0xa7006d(0xa9)]=_0x45ab61,_0x31ae6f['targetGridY']=_0x26514a;}catch(_0x43f629){console[_0xa7006d(0x104)](_0xa7006d(0xbe)+_0x31ae6f['id']+':',_0x43f629),_0x31ae6f['targetGridX']=gameCanvas['width']/0x2,_0x31ae6f[_0xa7006d(0x12e)]=ENEMY_TOP_MARGIN;}break;}}}else try{_0x555e78=calculateBezierPoint(_0x31ae6f[_0xa7006d(0x74)],_0x454e34['p0']['x'],_0x454e34['p1']['x'],_0x454e34['p2']['x'],_0x454e34['p3']['x']),_0x1091c7=calculateBezierPoint(_0x31ae6f[_0xa7006d(0x74)],_0x454e34['p0']['y'],_0x454e34['p1']['y'],_0x454e34['p2']['y'],_0x454e34['p3']['y']);}catch(_0x458e1b){console['error'](_0xa7006d(0x129)+_0x31ae6f['id']+':',_0x458e1b),_0x555e78=_0x31ae6f['x'],_0x1091c7=_0x31ae6f['y'],_0x31ae6f['state']=_0xa7006d(0xa4);try{const {x:_0x202484,y:_0x4f4684}=getCurrentGridSlotPosition(_0x31ae6f['gridRow'],_0x31ae6f[_0xa7006d(0x8a)],_0x5cfe3b);_0x31ae6f[_0xa7006d(0xa9)]=_0x202484,_0x31ae6f[_0xa7006d(0x12e)]=_0x4f4684;}catch(_0x11fd65){console[_0xa7006d(0x104)](_0xa7006d(0xcb)+_0x31ae6f['id']+':',_0x11fd65),_0x31ae6f[_0xa7006d(0xa9)]=gameCanvas[_0xa7006d(0x17e)]/0x2,_0x31ae6f[_0xa7006d(0x12e)]=ENEMY_TOP_MARGIN;}break;}if(_0x31ae6f&&_0x31ae6f[_0xa7006d(0xfd)]===_0xa7006d(0xd1)){const _0x44f53b=_0x31ae6f[_0xa7006d(0x148)]||0x0,_0x187902=_0x555e78+_0x44f53b,_0x48b309=_0x1091c7;_0x31ae6f[_0xa7006d(0xce)]=_0x187902-_0x45410d,_0x31ae6f[_0xa7006d(0x17d)]=_0x48b309-_0x3c93db,_0x31ae6f['x']=_0x187902,_0x31ae6f['y']=_0x48b309;if(_0x31ae6f['y']>gameCanvas[_0xa7006d(0x166)]+_0x3f0736*1.5){_0x31ae6f['state']=_0xa7006d(0xa4),_0x31ae6f['attackPathSegmentIndex']=0x0,_0x31ae6f[_0xa7006d(0x74)]=0x0,_0x31ae6f[_0xa7006d(0xa1)]=0x0,_0x31ae6f[_0xa7006d(0x148)]=0x0,_0x31ae6f[_0xa7006d(0x174)]=null,_0x31ae6f['y']=-_0x3f0736*(1.1+Math[_0xa7006d(0x149)]()*0.4),_0x31ae6f['x']=Math[_0xa7006d(0x149)]()*(gameCanvas[_0xa7006d(0x17e)]-_0x5cfe3b),_0x31ae6f['velocityX']=0x0,_0x31ae6f[_0xa7006d(0x17d)]=0x0;try{const {x:_0x5b1013,y:_0x2364e6}=getCurrentGridSlotPosition(_0x31ae6f['gridRow'],_0x31ae6f['gridCol'],_0x5cfe3b);_0x31ae6f[_0xa7006d(0xa9)]=_0x5b1013,_0x31ae6f[_0xa7006d(0x12e)]=_0x2364e6;}catch(_0x17fd19){console[_0xa7006d(0x104)](_0xa7006d(0x177)+_0x80db3a+_0xa7006d(0x115),_0x17fd19),_0x31ae6f[_0xa7006d(0xa9)]=gameCanvas[_0xa7006d(0x17e)]/0x2,_0x31ae6f['targetGridY']=ENEMY_TOP_MARGIN;}}}break;}case _0xa7006d(0xa4):{if(isEntrancePhaseActive)break;if(_0x31ae6f[_0xa7006d(0xa9)]==null||_0x31ae6f['targetGridY']==null){console['warn'](_0xa7006d(0xaf)+_0x80db3a+'\x20returning\x20without\x20target\x20coords.\x20Recalculating.');try{const {x:_0x2ca351,y:_0x5a8902}=getCurrentGridSlotPosition(_0x31ae6f[_0xa7006d(0x138)],_0x31ae6f['gridCol'],_0x5cfe3b);_0x31ae6f[_0xa7006d(0xa9)]=_0x2ca351,_0x31ae6f['targetGridY']=_0x5a8902;}catch(_0x30e6f5){console[_0xa7006d(0x104)](_0xa7006d(0x126)+_0x80db3a+_0xa7006d(0x184),_0x30e6f5),_0x31ae6f[_0xa7006d(0xfd)]='in_grid',_0x31ae6f['x']=gameCanvas['width']/0x2,_0x31ae6f['y']=ENEMY_TOP_MARGIN;break;}}const _0x3a9383=_0x31ae6f['targetGridX'],_0x285b47=_0x31ae6f[_0xa7006d(0x12e)],_0x49cbea=_0x3a9383-_0x31ae6f['x'],_0x2676a7=_0x285b47-_0x31ae6f['y'],_0x2b84f0=Math[_0xa7006d(0x150)](_0x49cbea*_0x49cbea+_0x2676a7*_0x2676a7),_0x5509f8=scaleValue(level,BASE_RETURN_SPEED_FACTOR,MAX_RETURN_SPEED_FACTOR),_0x3afb61=BASE_RETURN_SPEED*_0x5509f8,_0x10f5c8=_0x3afb61*0.5;_0x2b84f0>_0x10f5c8?(_0x31ae6f[_0xa7006d(0xce)]=_0x49cbea/_0x2b84f0*_0x3afb61,_0x31ae6f[_0xa7006d(0x17d)]=_0x2676a7/_0x2b84f0*_0x3afb61,_0x31ae6f['x']+=_0x31ae6f[_0xa7006d(0xce)],_0x31ae6f['y']+=_0x31ae6f[_0xa7006d(0x17d)]):(_0x31ae6f['x']=_0x3a9383,_0x31ae6f['y']=_0x285b47,_0x31ae6f['velocityX']=0x0,_0x31ae6f[_0xa7006d(0x17d)]=0x0,_0x31ae6f[_0xa7006d(0xfd)]='in_grid',_0x31ae6f[_0xa7006d(0x92)]=!![],_0x31ae6f['attackFormationOffsetX']=0x0,_0x31ae6f[_0xa7006d(0x174)]=null,_0x31ae6f[_0xa7006d(0xe2)]('returnLogDone')&&delete _0x31ae6f[_0xa7006d(0xab)],!isGridSoundPlaying&&!isChallengingStage&&(isGridSoundPlaying=!![],playSound(gridBackgroundSound)));break;}}if(_0x31ae6f&&!isShowingPlayerGameOverMessage&&!(isShipCaptured&&_0x31ae6f[_0xa7006d(0xfd)]===_0xa7006d(0x71))){const _0x198645={'x':0x0,'y':0x0,'width':PLAYER_BULLET_WIDTH,'height':PLAYER_BULLET_HEIGHT},_0x3eaa2b={'x':_0x31ae6f['x'],'y':_0x31ae6f['y'],'width':_0x5cfe3b,'height':_0x3f0736};for(let _0x17beaa=bullets[_0xa7006d(0x140)]-0x1;_0x17beaa>=0x0;_0x17beaa--){const _0x2cae79=bullets[_0x17beaa];if(!_0x2cae79)continue;_0x198645['x']=_0x2cae79['x'],_0x198645['y']=_0x2cae79['y'];if(checkCollision(_0x198645,_0x3eaa2b)){const _0x49d305=handleEnemyHit(_0x31ae6f);bullets[_0xa7006d(0x76)](_0x17beaa,0x1);if(_0x49d305[_0xa7006d(0xe6)]){enemies[_0xa7006d(0x76)](_0x49d065,0x1),_0x31ae6f=null;break;}}}}if(_0x31ae6f&&ship&&!isShipCaptured&&!isWaitingForRespawn&&!isShowingPlayerGameOverMessage&&!isInvincible){const _0x4198ef=[_0xa7006d(0xd1),'following_entrance_path',_0xa7006d(0x9f),_0xa7006d(0x11e)];if(_0x4198ef['includes'](_0x31ae6f[_0xa7006d(0xfd)])){const _0x2d21d1={'x':_0x31ae6f['x'],'y':_0x31ae6f['y'],'width':_0x5cfe3b,'height':_0x3f0736},_0x20f05c={'x':ship['x'],'y':ship['y'],'width':ship['width'],'height':ship[_0xa7006d(0x166)]},_0x207646=isDualShipActive?{'x':ship['x']+DUAL_SHIP_OFFSET_X,'y':ship['y'],'width':ship[_0xa7006d(0x17e)],'height':ship[_0xa7006d(0x166)]}:null;let _0x4a6a0e=![],_0x461b08=![];if(checkCollision(_0x2d21d1,_0x20f05c))_0x4a6a0e=!![],_0x461b08=![];else _0x207646&&checkCollision(_0x2d21d1,_0x207646)&&(_0x4a6a0e=!![],_0x461b08=!![]);if(_0x4a6a0e){createExplosion(_0x31ae6f['x']+_0x5cfe3b/0x2,_0x31ae6f['y']+_0x3f0736/0x2),playSound(lostLifeSound),enemies[_0xa7006d(0x76)](_0x49d065,0x1),_0x31ae6f=null;if(isDualShipActive){isDualShipActive=![];if(currentPlayer===0x1)player1IsDualShipActive=![];else player2IsDualShipActive=![];_0x461b08?createExplosion(_0x207646['x']+ship['width']/0x2,_0x207646['y']+ship[_0xa7006d(0x166)]/0x2):createExplosion(_0x20f05c['x']+ship[_0xa7006d(0x17e)]/0x2,_0x20f05c['y']+ship[_0xa7006d(0x166)]/0x2),isInvincible=!![],invincibilityEndTime=_0x187e96+INVINCIBILITY_DURATION_MS;}else{playerLives--,csCurrentChainHits=0x0,csCurrentChainScore=0x0,csLastHitTime=0x0,csLastChainHitPosition=null,normalWaveCurrentChainHits=0x0,normalWaveCurrentChainScore=0x0,normalWaveLastHitTime=0x0,normalWaveLastChainHitPosition=null,leftPressed=![],rightPressed=![],shootPressed=![],p2LeftPressed=![],p2RightPressed=![],p2ShootPressed=![],p1JustFiredSingle=![],p2JustFiredSingle=![],p1FireInputWasDown=![],p2FireInputWasDown=![],fallingShips=[],isInvincible=!![],invincibilityEndTime=_0x187e96+INVINCIBILITY_DURATION_MS;ship&&gameCanvas?(ship['y']=gameCanvas[_0xa7006d(0x166)]-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN,!isManualControl&&(aiNeedsStabilization=!![])):console[_0xa7006d(0x104)](_0xa7006d(0x183));if(playerLives<=0x0){const _0x1e4512=currentPlayer;if(_0x1e4512===0x1)player1Lives=0x0;if(_0x1e4512===0x2)player2Lives=0x0;if(isTwoPlayerMode){isShowingPlayerGameOverMessage=!![],playerGameOverMessageStartTime=_0x187e96,playerWhoIsGameOver=_0x1e4512;const _0x57e320=_0x1e4512===0x1?0x2:0x1,_0x2f76a0=_0x57e320===0x1?player1Lives:player2Lives;_0x2f76a0>0x0?nextActionAfterPlayerGameOver=_0xa7006d(0x12b):nextActionAfterPlayerGameOver=_0xa7006d(0x132),bullets=[],enemyBullets=[],explosions=[],playSound(gameOverSound);}else triggerFinalGameOverSequence();break;}else{if(isTwoPlayerMode){if(currentPlayer===0x1)player1Lives=playerLives;else player2Lives=playerLives;}break;}}}}}}if(ship&&!isShowingPlayerGameOverMessage&&!isShipCaptured&&!isWaitingForRespawn&&!isInvincible){const _0x224b8e={'x':ship['x'],'y':ship['y'],'width':ship[_0xa7006d(0x17e)],'height':ship[_0xa7006d(0x166)]},_0x541c36=isDualShipActive?{'x':ship['x']+DUAL_SHIP_OFFSET_X,'y':ship['y'],'width':ship[_0xa7006d(0x17e)],'height':ship[_0xa7006d(0x166)]}:null;for(let _0x1ebbf0=enemyBullets[_0xa7006d(0x140)]-0x1;_0x1ebbf0>=0x0;_0x1ebbf0--){const _0x33966f=enemyBullets[_0x1ebbf0];if(!_0x33966f){enemyBullets[_0xa7006d(0x76)](_0x1ebbf0,0x1);continue;}const _0x3ae9e4={'x':_0x33966f['x'],'y':_0x33966f['y'],'width':_0x33966f[_0xa7006d(0x17e)],'height':_0x33966f[_0xa7006d(0x166)]};let _0x170ae2=checkCollision(_0x224b8e,_0x3ae9e4),_0x55cec0=0x0;!_0x170ae2&&_0x541c36&&checkCollision(_0x541c36,_0x3ae9e4)&&(_0x170ae2=!![],_0x55cec0=0x1);if(_0x170ae2){enemyBullets[_0xa7006d(0x76)](_0x1ebbf0,0x1);if(isDualShipActive){isDualShipActive=![];if(currentPlayer===0x1)player1IsDualShipActive=![];else player2IsDualShipActive=![];_0x55cec0===0x1?createExplosion(_0x541c36['x']+ship[_0xa7006d(0x17e)]/0x2,_0x541c36['y']+ship['height']/0x2):createExplosion(_0x224b8e['x']+ship['width']/0x2,_0x224b8e['y']+ship[_0xa7006d(0x166)]/0x2),playSound(lostLifeSound),isInvincible=!![],invincibilityEndTime=_0x187e96+INVINCIBILITY_DURATION_MS;}else{playerLives--,playSound(lostLifeSound),createExplosion(ship['x']+ship[_0xa7006d(0x17e)]/0x2,ship['y']+ship[_0xa7006d(0x166)]/0x2),csCurrentChainHits=0x0,csCurrentChainScore=0x0,csLastHitTime=0x0,csLastChainHitPosition=null,normalWaveCurrentChainHits=0x0,normalWaveCurrentChainScore=0x0,normalWaveLastHitTime=0x0,normalWaveLastChainHitPosition=null,leftPressed=![],rightPressed=![],shootPressed=![],p2LeftPressed=![],p2RightPressed=![],p2ShootPressed=![],p1JustFiredSingle=![],p2JustFiredSingle=![],p1FireInputWasDown=![],p2FireInputWasDown=![],fallingShips=[],isInvincible=!![],invincibilityEndTime=_0x187e96+INVINCIBILITY_DURATION_MS;ship&&gameCanvas?(ship['y']=gameCanvas['height']-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN,!isManualControl&&(aiNeedsStabilization=!![])):console['error']('Cannot\x20reposition\x20ship\x20Y\x20-\x20ship\x20or\x20canvas\x20not\x20ready.');if(playerLives<=0x0){const _0x21bac1=currentPlayer;if(_0x21bac1===0x1)player1Lives=0x0;if(_0x21bac1===0x2)player2Lives=0x0;if(isTwoPlayerMode){isShowingPlayerGameOverMessage=!![],playerGameOverMessageStartTime=_0x187e96,playerWhoIsGameOver=_0x21bac1;const _0x49c4f9=_0x21bac1===0x1?0x2:0x1,_0x1abe75=_0x49c4f9===0x1?player1Lives:player2Lives;_0x1abe75>0x0?nextActionAfterPlayerGameOver=_0xa7006d(0x12b):nextActionAfterPlayerGameOver=_0xa7006d(0x132),bullets=[],enemyBullets=[],explosions=[],playSound(gameOverSound);}else triggerFinalGameOverSequence();break;}else{if(isTwoPlayerMode){if(currentPlayer===0x1)player1Lives=playerLives;else player2Lives=playerLives;}break;}}}}}if(ship&&!isShipCaptured&&!isWaitingForRespawn&&!isDualShipActive&&fallingShips[_0xa7006d(0x140)]>0x0&&!isInvincible){const _0x4da337={'x':ship['x'],'y':ship['y'],'width':ship[_0xa7006d(0x17e)],'height':ship[_0xa7006d(0x166)]};for(let _0x2f07d7=fallingShips['length']-0x1;_0x2f07d7>=0x0;_0x2f07d7--){const _0x5df945=fallingShips[_0x2f07d7];if(!_0x5df945)continue;const _0x329046={'x':_0x5df945['x'],'y':_0x5df945['y'],'width':_0x5df945[_0xa7006d(0x17e)],'height':_0x5df945[_0xa7006d(0x166)]};if(checkCollision(_0x4da337,_0x329046)){fallingShips[_0xa7006d(0x76)](_0x2f07d7,0x1),isDualShipActive=!![];if(currentPlayer===0x1)player1IsDualShipActive=!![];else player2IsDualShipActive=!![];playSound(dualShipSound);break;}}}updateHitSparks();}catch(_0x53c32c){console['error']('FATAL\x20Error\x20in\x20moveEntities:',_0x53c32c,_0x53c32c[_0xa7006d(0x9e)]),isGridSoundPlaying=![],stopSound(gridBackgroundSound),isEntrancePhaseActive=![],stopSound(entranceSound),isShowingPlayerGameOverMessage=![],playerGameOverMessageStartTime=0x0,playerWhoIsGameOver=0x0,nextActionAfterPlayerGameOver='',isShipCaptured=![],captureBeamActive=![],capturingBossId=null,stopSound(captureSound),stopSound(shipCapturedSound),isWaitingForRespawn=![],fallingShips=[],isDualShipActive=![],player1IsDualShipActive=![],player2IsDualShipActive=![],isInvincible=![],invincibilityEndTime=0x0,hitSparks=[];if(typeof showMenuState==='function')showMenuState();if(mainLoopId)cancelAnimationFrame(mainLoopId);mainLoopId=null,alert(_0xa7006d(0x107));}}function switchPlayerTurn(){const _0x1072ed=_0x27dd;if(!isTwoPlayerMode)return![];stopSound(hiScoreSound),highScore=Math[_0x1072ed(0x182)](highScore,score);currentPlayer===0x1?(player1Score=score,player1IsDualShipActive=isDualShipActive):(player2Score=score,player2IsDualShipActive=isDualShipActive);const _0x2bb243=currentPlayer===0x1?0x2:0x1,_0xfd70ec=_0x2bb243===0x1?player1Lives:player2Lives;if(_0xfd70ec<=0x0){const _0x58e73f=currentPlayer===0x1?player1Lives:player2Lives;return _0x58e73f<=0x0?(triggerFinalGameOverSequence(),![]):(forceCenterShipNextReset=![],![]);}return currentPlayer=_0x2bb243,score=currentPlayer===0x1?player1Score:player2Score,playerLives=currentPlayer===0x1?player1Lives:player2Lives,isDualShipActive=currentPlayer===0x1?player1IsDualShipActive:player2IsDualShipActive,forceCenterShipNextReset=!![],scoreEarnedThisCS=0x0,csCurrentChainHits=0x0,csCurrentChainScore=0x0,csLastHitTime=0x0,csLastChainHitPosition=null,normalWaveCurrentChainHits=0x0,normalWaveCurrentChainScore=0x0,normalWaveLastHitTime=0x0,normalWaveLastChainHitPosition=null,leftPressed=![],rightPressed=![],shootPressed=![],p2LeftPressed=![],p2RightPressed=![],p2ShootPressed=![],keyboardP1LeftDown=![],keyboardP1RightDown=![],keyboardP1ShootDown=![],keyboardP2LeftDown=![],keyboardP2RightDown=![],keyboardP2ShootDown=![],p1JustFiredSingle=![],p2JustFiredSingle=![],p1FireInputWasDown=![],p2FireInputWasDown=![],isShipCaptured=![],captureBeamActive=![],capturingBossId=null,isWaitingForRespawn=![],respawnTime=0x0,isInvincible=![],invincibilityEndTime=0x0,fallingShips=[],hitSparks=[],showExtraLifeMessage=![],extraLifeMessageStartTime=0x0,!![];}function firePlayerBullet(_0x38fdf2=![]){const _0x35fc98=_0x27dd;let _0x4bb26b=_0x38fdf2?0x1:currentPlayer,_0x308312=selectedFiringMode==='single',_0x1945e6=!_0x38fdf2&&isTwoPlayerMode&&currentPlayer===0x2;if(isPaused||!isInGameState||playerLives<=0x0||gameOverSequenceStartTime>0x0||!ship||isShipCaptured||isWaitingForRespawn||isShowingIntro||showReadyMessage||isCsCompletionDelayActive||showCsHitsMessage||showPerfectMessage||showCsBonusScoreMessage||showCSClearMessage||isShowingPlayerGameOverMessage)return![];try{const _0x1dc436=ship['y'];let _0x8e0235=0x0;if(isDualShipActive){const _0x3b380d=ship['x']+ship[_0x35fc98(0x17e)]/0x2,_0x576948=ship['x']+DUAL_SHIP_OFFSET_X+ship['width']/0x2,_0x1f1d1a=_0x3b380d-PLAYER_BULLET_WIDTH/0x2,_0x504aec=_0x576948-PLAYER_BULLET_WIDTH/0x2;bullets['push']({'x':_0x1f1d1a,'y':_0x1dc436,'width':PLAYER_BULLET_WIDTH,'height':PLAYER_BULLET_HEIGHT,'speed':PLAYER_BULLET_SPEED}),bullets[_0x35fc98(0xb3)]({'x':_0x504aec,'y':_0x1dc436,'width':PLAYER_BULLET_WIDTH,'height':PLAYER_BULLET_HEIGHT,'speed':PLAYER_BULLET_SPEED}),_0x8e0235=0x2;}else{const _0xebebfe=ship['x']+ship[_0x35fc98(0x17e)]/0x2-PLAYER_BULLET_WIDTH/0x2;bullets['push']({'x':_0xebebfe,'y':_0x1dc436,'width':PLAYER_BULLET_WIDTH,'height':PLAYER_BULLET_HEIGHT,'speed':PLAYER_BULLET_SPEED}),_0x8e0235=0x1;}_0x308312&&!_0x38fdf2&&(_0x1945e6?p2JustFiredSingle=!![]:p1JustFiredSingle=!![]);playSound(playerShootSound);if(_0x4bb26b===0x1||_0x38fdf2)player1ShotsFired+=_0x8e0235;else _0x4bb26b===0x2&&(player2ShotsFired+=_0x8e0235);return!![];}catch(_0x393b1d){return console[_0x35fc98(0x104)](_0x35fc98(0x94),_0x393b1d),![];}}function handlePlayerInput(){const _0x155f64=_0x27dd;try{if(isPaused||!isManualControl||playerLives<=0x0||!ship||!gameCanvas||!isInGameState||gameOverSequenceStartTime>0x0||isShowingPlayerGameOverMessage||isWaitingForRespawn){leftPressed=![],rightPressed=![],shootPressed=![],p2LeftPressed=![],p2RightPressed=![],p2ShootPressed=![],p1FireInputWasDown=![],p2FireInputWasDown=![],keyboardP1LeftDown=![],keyboardP1RightDown=![],keyboardP1ShootDown=![],keyboardP2LeftDown=![],keyboardP2RightDown=![],keyboardP2ShootDown=![];return;}leftPressed=![],rightPressed=![],shootPressed=![],p2LeftPressed=![],p2RightPressed=![],p2ShootPressed=![];let _0xa2ab98=keyboardP1LeftDown,_0x56a74b=keyboardP1RightDown,_0x4c3b40=keyboardP1ShootDown,_0x35b6cd=keyboardP2LeftDown,_0x55be70=keyboardP2RightDown,_0x3a6640=keyboardP2ShootDown,_0x1c2bb7=![],_0x54254a=![],_0x153148=![],_0x148204=![],_0x4d76e3=![],_0x179c74=![];const _0x5ce69e=selectedFiringMode==='single';if(connectedGamepadIndex!==null){const _0x218586=navigator[_0x155f64(0x9b)]();if(_0x218586?.[connectedGamepadIndex]){const _0xd7fc5c=_0x218586[connectedGamepadIndex],_0x24517a=processSingleController(_0xd7fc5c,previousGameButtonStates);_0x1c2bb7=_0x24517a[_0x155f64(0xbd)],_0x54254a=_0x24517a[_0x155f64(0x171)],_0x153148=_0x24517a[_0x155f64(0x162)];const _0x2f9b2f=previousGameButtonStates[PS5_BUTTON_CROSS]??![],_0x5b8125=!_0x153148&&_0x2f9b2f;if(_0x5b8125&&_0x5ce69e)p1JustFiredSingle=![];previousButtonStates=_0x24517a[_0x155f64(0x139)];if(_0x24517a[_0x155f64(0x14b)]){togglePause();return;}if(_0x24517a[_0x155f64(0x185)]){stopGameAndShowMenu();return;}}else{if(previousButtonStates[_0x155f64(0x140)]>0x0)previousButtonStates=[];if(_0x5ce69e)p1JustFiredSingle=![];p1FireInputWasDown=![];}}else{if(previousButtonStates[_0x155f64(0x140)]>0x0)previousButtonStates=[];}if(isTwoPlayerMode&&connectedGamepadIndexP2!==null){const _0x216b86=navigator[_0x155f64(0x9b)]();if(_0x216b86?.[connectedGamepadIndexP2]){const _0x52fb18=_0x216b86[connectedGamepadIndexP2],_0x524426=processSingleController(_0x52fb18,previousGameButtonStatesP2);_0x148204=_0x524426[_0x155f64(0xbd)],_0x4d76e3=_0x524426[_0x155f64(0x171)],_0x179c74=_0x524426['shoot'];const _0x54ce93=previousGameButtonStatesP2[PS5_BUTTON_CROSS]??![],_0x1b09ba=!_0x179c74&&_0x54ce93;if(_0x1b09ba&&_0x5ce69e)p2JustFiredSingle=![];previousGameButtonStatesP2=_0x524426['newButtonStates'];}else{if(previousGameButtonStatesP2[_0x155f64(0x140)]>0x0)previousGameButtonStatesP2=[];if(_0x5ce69e)p2JustFiredSingle=![];p2FireInputWasDown=![];}}else{if(previousGameButtonStatesP2[_0x155f64(0x140)]>0x0)previousGameButtonStatesP2=[];}let _0x323313=![],_0x3a37bd=![];const _0x79e607=Date['now']();let _0x1148db=_0x4c3b40||_0x153148,_0x26032b=![];const _0x3f4c1f=isTwoPlayerMode&&connectedGamepadIndexP2===null&&connectedGamepadIndex!==null;isTwoPlayerMode&&(_0x26032b=_0x3a6640||_0x179c74||_0x3f4c1f&&_0x153148);const _0x7920dd=_0x1148db&&!p1FireInputWasDown,_0xaa0465=!_0x1148db&&p1FireInputWasDown,_0x5a24f6=_0x26032b&&!p2FireInputWasDown,_0x2251c0=!_0x26032b&&p2FireInputWasDown;if(currentPlayer===0x1||!isTwoPlayerMode)leftPressed=_0xa2ab98||_0x1c2bb7,rightPressed=_0x56a74b||_0x54254a,_0x5ce69e?(_0x7920dd&&!p1JustFiredSingle&&(_0x323313=!![]),_0xaa0465&&(p1JustFiredSingle=![])):_0x1148db&&_0x79e607-playerLastShotTime>=SHOOT_COOLDOWN&&(_0x323313=!![]),shootPressed=_0x323313;else{if(isTwoPlayerMode&&currentPlayer===0x2){p2LeftPressed=_0x35b6cd||_0x148204||_0x3f4c1f&&_0x1c2bb7,p2RightPressed=_0x55be70||_0x4d76e3||_0x3f4c1f&&_0x54254a;const _0x2e4069=_0x3f4c1f&&(!_0x153148&&(previousGameButtonStates[PS5_BUTTON_CROSS]??![]));_0x5ce69e?(_0x5a24f6&&!p2JustFiredSingle&&(_0x3a37bd=!![]),(_0x2251c0||_0x2e4069)&&(p2JustFiredSingle=![])):_0x26032b&&_0x79e607-playerLastShotTime>=SHOOT_COOLDOWN&&(_0x3a37bd=!![]),p2ShootPressed=_0x3a37bd;}}(_0x323313||_0x3a37bd)&&(firePlayerBullet(![])&&(!_0x5ce69e&&(playerLastShotTime=_0x79e607))),p1FireInputWasDown=_0x1148db,p2FireInputWasDown=_0x26032b;}catch(_0x263e88){console['error']('Error\x20handling\x20player\x20input:',_0x263e88),leftPressed=![],rightPressed=![],shootPressed=![],p2LeftPressed=![],p2RightPressed=![],p2ShootPressed=![],p1JustFiredSingle=![],p2JustFiredSingle=![],p1FireInputWasDown=![],p2FireInputWasDown=![];}}function aiControl(){const _0x36c69a=_0x27dd;try{if(isPaused||isManualControl||playerLives<=0x0||!ship||!gameCanvas||!isInGameState||gameOverSequenceStartTime>0x0||isShowingPlayerGameOverMessage||isShipCaptured||isWaitingForRespawn){if(ship)ship[_0x36c69a(0x169)]=ship['x'];aiNeedsStabilization=!![],smoothedShipX=undefined;return;}smoothedShipX===undefined&&(smoothedShipX=ship['x']);const _0x3795d0=Date['now'](),_0x3dc0a4=gameCanvas[_0x36c69a(0x17e)],_0x5ca2c0=gameCanvas[_0x36c69a(0x166)];let _0x52a157=ship['width'];isDualShipActive&&(_0x52a157=DUAL_SHIP_OFFSET_X+ship[_0x36c69a(0x17e)]);const _0x5ca154=ship['x']+_0x52a157/0x2,_0x6a5455=ship['y'],_0x5b59eb=_0x3dc0a4/0x2;let _0x15b519;isDualShipActive?_0x15b519=_0x5b59eb-_0x52a157/0x2:_0x15b519=_0x5b59eb-ship[_0x36c69a(0x17e)]/0x2;const _0x523fe6=showReadyMessage||showCSClearMessage||showCsHitsMessage||showPerfectMessage||showCsBonusScoreMessage||showExtraLifeMessage||isCsCompletionDelayActive;let _0x317ff1=smoothedShipX,_0x4213d7=![],_0x237b15=![],_0x42d061=smoothedShipX,_0x1ca77f=null,_0x3f2f78=![];aiNeedsStabilization&&!_0x523fe6&&(aiStabilizationEndTime=_0x3795d0+AI_STABILIZATION_DURATION,aiNeedsStabilization=![],smoothedShipX=ship['x']);if(_0x3795d0<aiStabilizationEndTime&&!_0x523fe6)_0x317ff1=_0x15b519;else{_0x237b15=![],_0x42d061=smoothedShipX;if(!isInvincible){let _0x5ec50f=[];const _0x549578=isChallengingStage?FINAL_DODGE_LOOKAHEAD*0.8:isEntrancePhaseActive?ENTRANCE_BULLET_DODGE_LOOKAHEAD:FINAL_DODGE_LOOKAHEAD,_0x1da483=isChallengingStage?FINAL_DODGE_BUFFER_BASE*0.8:isEntrancePhaseActive?ENTRANCE_BULLET_DODGE_BUFFER:FINAL_DODGE_BUFFER_BASE,_0x5ef8e2={'x':ship['x']-_0x1da483/0x2,'y':ship['y']-_0x549578,'width':_0x52a157+_0x1da483,'height':_0x549578+ship[_0x36c69a(0x166)]};for(const _0x3e10e5 of enemyBullets){if(_0x3e10e5&&_0x3e10e5['y']+_0x3e10e5['height']>0x0&&_0x3e10e5['y']<_0x5ca2c0){const _0x3481b4={'x':_0x3e10e5['x'],'y':_0x3e10e5['y'],'width':_0x3e10e5[_0x36c69a(0x17e)],'height':_0x3e10e5['height']};checkCollision(_0x5ef8e2,_0x3481b4)&&_0x5ec50f[_0x36c69a(0xb3)](_0x3e10e5);}}if(_0x5ec50f['length']>0x0){_0x237b15=!![];let _0x56ed5e=_0x3dc0a4,_0x25a737=0x0,_0x160225=Infinity;_0x5ec50f[_0x36c69a(0x7e)](_0x4213ee=>{const _0x6a20a=_0x36c69a;_0x56ed5e=Math['min'](_0x56ed5e,_0x4213ee['x']),_0x25a737=Math[_0x6a20a(0x182)](_0x25a737,_0x4213ee['x']+_0x4213ee[_0x6a20a(0x17e)]),_0x160225=Math[_0x6a20a(0xfa)](_0x160225,_0x6a5455-(_0x4213ee['y']+_0x4213ee[_0x6a20a(0x166)]));});const _0x546b19=(_0x56ed5e+_0x25a737)/0x2,_0x1bd027=_0x5ca154<_0x546b19?-0x1:0x1,_0x107950=0x1-Math[_0x36c69a(0xfa)](0x1,Math[_0x36c69a(0x182)](0x0,_0x160225)/_0x549578),_0x5965ef=isChallengingStage?1.6:isEntrancePhaseActive?2.2:1.8,_0x52a198=isChallengingStage?1.3:isEntrancePhaseActive?1.8:1.5,_0x239b43=Math[_0x36c69a(0x182)](0x0,_0x5ec50f[_0x36c69a(0x140)]-0x1)*_0x52a157*0.3,_0x2d924d=_0x52a157*(_0x5965ef+_0x107950*_0x52a198)+_0x239b43;_0x42d061=smoothedShipX+_0x1bd027*_0x2d924d;}if(!_0x237b15&&!isChallengingStage&&!isFullGridWave){let _0xc9108c=![],_0x11d65e=Infinity;for(const _0x356b70 of enemies){if(_0x356b70&&_0x356b70['type']===ENEMY3_TYPE&&_0x356b70[_0x36c69a(0xfd)]===_0x36c69a(0x11e)&&_0x356b70[_0x36c69a(0x169)]!=null){const _0x56c778=AI_COLLISION_LOOKAHEAD*1.5,_0x4a01b0=FINAL_DODGE_BUFFER_BASE*1.8,_0x3da480=0.2,_0x43a9e2=_0x356b70['x']+(_0x356b70[_0x36c69a(0x169)]-_0x356b70['x'])*_0x3da480,_0x1fa6af={'x':_0x43a9e2,'y':_0x356b70['y'],'width':_0x356b70[_0x36c69a(0x17e)],'height':_0x356b70['height']},_0x1756ff={'x':ship['x']-_0x4a01b0/0x2,'y':ship['y']-_0x56c778,'width':_0x52a157+_0x4a01b0,'height':_0x56c778+ship[_0x36c69a(0x166)]};if(checkCollision(_0x1756ff,_0x1fa6af)){const _0x1d2e42=_0x6a5455-(_0x356b70['y']+_0x356b70[_0x36c69a(0x166)]);if(_0x1d2e42<_0x11d65e){_0x11d65e=_0x1d2e42,_0x237b15=!![],_0xc9108c=!![];const _0x57648d=_0x356b70[_0x36c69a(0x169)]+_0x356b70[_0x36c69a(0x17e)]/0x2,_0x716761=_0x3dc0a4/0x2,_0x27b261=_0x57648d<_0x716761?0x1:-0x1,_0x1bfdfa=0x1-Math['min'](0x1,Math[_0x36c69a(0x182)](0x0,_0x1d2e42)/_0x56c778),_0x44e0ee=_0x52a157*(2.5+_0x1bfdfa*0x2);_0x42d061=smoothedShipX+_0x27b261*_0x44e0ee;}}}}}if(!_0x237b15){const _0x508706=AI_COLLISION_LOOKAHEAD,_0x175a45=NORMAL_WAVE_ATTACKING_DODGE_BUFFER_MULTIPLIER,_0x34894d=BEE_DODGE_BUFFER_HORIZONTAL_FACTOR;let _0x33d078=Infinity;for(const _0x8997d9 of enemies){if(_0x8997d9&&_0x8997d9[_0x36c69a(0xfd)]===_0x36c69a(0xd1)&&_0x8997d9['y']+_0x8997d9[_0x36c69a(0x166)]>0x0&&_0x8997d9['y']<_0x5ca2c0){let _0x2f208d=FINAL_DODGE_BUFFER_BASE*_0x175a45;_0x8997d9[_0x36c69a(0x142)]===ENEMY1_TYPE&&(_0x2f208d*=_0x34894d);const _0x21fa1f={'x':ship['x']-_0x2f208d/0x2,'y':ship['y']-_0x508706,'width':_0x52a157+_0x2f208d,'height':_0x508706+ship[_0x36c69a(0x166)]},_0x2906cb={'x':_0x8997d9['x'],'y':_0x8997d9['y'],'width':_0x8997d9[_0x36c69a(0x17e)],'height':_0x8997d9[_0x36c69a(0x166)]};if(checkCollision(_0x21fa1f,_0x2906cb)){const _0x4f19a0=_0x6a5455-(_0x8997d9['y']+_0x8997d9[_0x36c69a(0x166)]);if(_0x4f19a0<_0x33d078){_0x33d078=_0x4f19a0,_0x237b15=!![];const _0x5f2813=_0x8997d9['x']+_0x8997d9['width']/0x2,_0x3edf15=_0x5ca154<_0x5f2813?-0x1:0x1,_0x18ada2=0x1-Math[_0x36c69a(0xfa)](0x1,Math[_0x36c69a(0x182)](0x0,_0x4f19a0)/_0x508706),_0x5611e3=_0x52a157*(0x2+_0x18ada2*1.8);_0x42d061=smoothedShipX+_0x3edf15*_0x5611e3;}}}}}if(!_0x237b15&&!isFullGridWave){const _0x3913a1=AI_COLLISION_LOOKAHEAD;let _0x572a60=Infinity;for(const _0x256013 of enemies){const _0x5a2499=_0x256013&&(_0x256013[_0x36c69a(0xfd)]===_0x36c69a(0xec)||_0x256013[_0x36c69a(0xfd)]===_0x36c69a(0xa4));if(_0x5a2499&&_0x256013['y']+_0x256013[_0x36c69a(0x166)]>0x0&&_0x256013['y']<_0x5ca2c0){let _0x172a3b=FINAL_DODGE_BUFFER_BASE;_0x256013[_0x36c69a(0x142)]===ENEMY1_TYPE&&(_0x172a3b*=BEE_DODGE_BUFFER_HORIZONTAL_FACTOR);const _0x3acb3d={'x':ship['x']-_0x172a3b/0x2,'y':ship['y']-_0x3913a1,'width':_0x52a157+_0x172a3b,'height':_0x3913a1+ship[_0x36c69a(0x166)]},_0x5b5d30={'x':_0x256013['x'],'y':_0x256013['y'],'width':_0x256013[_0x36c69a(0x17e)],'height':_0x256013[_0x36c69a(0x166)]};if(checkCollision(_0x3acb3d,_0x5b5d30)){const _0x31f288=_0x6a5455-(_0x256013['y']+_0x256013['height']);if(_0x31f288<_0x572a60){_0x572a60=_0x31f288,_0x237b15=!![];const _0x1d4119=_0x256013['x']+_0x256013[_0x36c69a(0x17e)]/0x2,_0x3c3763=_0x5ca154<_0x1d4119?-0x1:0x1,_0x4f4ef4=0x1-Math['min'](0x1,Math[_0x36c69a(0x182)](0x0,_0x31f288)/_0x3913a1),_0x1e9930=_0x52a157*(0x2+_0x4f4ef4*1.8);_0x42d061=smoothedShipX+_0x3c3763*_0x1e9930;}}}}}}if(_0x237b15&&!isInvincible){const _0x54272a=Math[_0x36c69a(0x182)](AI_ANTI_CORNER_BUFFER,Math[_0x36c69a(0xfa)](_0x3dc0a4-_0x52a157-AI_ANTI_CORNER_BUFFER,_0x42d061));_0x317ff1=_0x54272a,_0x1ca77f=null,_0x4213d7=![];}else{if(fallingShips[_0x36c69a(0x140)]>0x0&&!isShipCaptured&&!isWaitingForRespawn){const _0x3b61d2=fallingShips[0x0];if(_0x3b61d2){const _0x7dba43=_0x3b61d2['x']+_0x3b61d2[_0x36c69a(0x17e)]/0x2;_0x317ff1=_0x7dba43-_0x52a157/0x2,_0x317ff1=Math[_0x36c69a(0x182)](AI_EDGE_BUFFER,Math[_0x36c69a(0xfa)](_0x3dc0a4-_0x52a157-AI_EDGE_BUFFER,_0x317ff1)),_0x1ca77f=null;let _0x2c05d6=-Infinity,_0x1c88c7=null;for(const _0x51e197 of enemies){if(_0x51e197&&_0x51e197['y']<_0x6a5455){const _0x24276a=_0x51e197['x']+_0x51e197[_0x36c69a(0x17e)]/0x2,_0x671fc8=Math[_0x36c69a(0xb8)](_0x24276a-_0x5ca154),_0x4b7bad=_0x6a5455-(_0x51e197['y']+_0x51e197[_0x36c69a(0x166)]);if(_0x671fc8<_0x52a157*1.5&&_0x4b7bad>0x0){const _0x49ef76=_0x5ca2c0-_0x51e197['y']-_0x671fc8*0x2-_0x4b7bad;_0x49ef76>_0x2c05d6&&(_0x2c05d6=_0x49ef76,_0x1c88c7=_0x51e197);}}}if(_0x1c88c7){let _0x1c30f6=!![];const _0x47f2be={'x':ship['x']-ENTRANCE_SHOOT_BULLET_CHECK_BUFFER/0x2,'y':ship['y']-ENTRANCE_SHOOT_BULLET_CHECK_LOOKAHEAD,'width':_0x52a157+ENTRANCE_SHOOT_BULLET_CHECK_BUFFER,'height':ENTRANCE_SHOOT_BULLET_CHECK_LOOKAHEAD+ship['height']};for(const _0x1652a3 of enemyBullets){if(_0x1652a3&&_0x1652a3['y']+_0x1652a3['height']>0x0&&_0x1652a3['y']<_0x5ca2c0){const _0x5badd1={'x':_0x1652a3['x'],'y':_0x1652a3['y'],'width':_0x1652a3[_0x36c69a(0x17e)],'height':_0x1652a3[_0x36c69a(0x166)]};if(checkCollision(_0x47f2be,_0x5badd1)){_0x1c30f6=![];break;}}}_0x1c30f6&&!(_0x1c88c7[_0x36c69a(0x142)]===ENEMY3_TYPE&&_0x1c88c7['state']===_0x36c69a(0xf9))&&(_0x4213d7=!![],_0x1ca77f=_0x1c88c7);}}}else{let _0x243ea1=![],_0x16a631=null;if(!isFullGridWave&&!isManualControl&&captureBeamActive&&capturingBossId&&playerLives>0x1&&!isShipCaptured&&!isInvincible){_0x16a631=enemies[_0x36c69a(0xf2)](_0x8e2b45=>_0x8e2b45['id']===capturingBossId);if(_0x16a631&&_0x16a631[_0x36c69a(0xfd)]==='capturing'){_0x243ea1=!![];const _0x250cee=_0x3795d0-_0x16a631[_0x36c69a(0xc6)];if(_0x250cee>=AI_CAPTURE_WAIT_DURATION_MS){_0x3f2f78=!![];const _0x5cff1c=_0x16a631['x']+_0x16a631[_0x36c69a(0x17e)]/0x2;_0x317ff1=_0x5cff1c-_0x52a157/0x2,_0x1ca77f=null,_0x4213d7=![];}}}if(!_0x3f2f78){_0x1ca77f=null;if(isEntrancePhaseActive&&!isChallengingStage&&!isFullGridWave){_0x317ff1=_0x15b519;let _0x100e7e=-Infinity,_0x303f0c=null;for(const _0x1ab6fd of enemies){if(_0x1ab6fd&&(_0x1ab6fd[_0x36c69a(0xfd)]===_0x36c69a(0xec)||_0x1ab6fd[_0x36c69a(0xfd)]===_0x36c69a(0x181))&&_0x1ab6fd['y']<_0x6a5455){const _0x8ff1f=_0x1ab6fd['x']+_0x1ab6fd[_0x36c69a(0x17e)]/0x2,_0x1b2507=_0x1ab6fd['y']+_0x1ab6fd['height']/0x2,_0x3b1c19=_0x8ff1f-_0x5ca154,_0x13682f=_0x6a5455-_0x1b2507,_0x5d5892=Math[_0x36c69a(0x150)](_0x3b1c19*_0x3b1c19+_0x13682f*_0x13682f),_0x269777=Math['max'](0x0,_0x52a157*1.5-Math['abs'](_0x3b1c19)),_0x4932dd=(_0x5ca2c0-_0x1ab6fd['y'])*1.5+_0x269777-_0x5d5892*0.5;_0x4932dd>_0x100e7e&&(_0x100e7e=_0x4932dd,_0x303f0c=_0x1ab6fd);}}if(_0x303f0c){_0x1ca77f=_0x303f0c;const _0x3d2879=_0x1ca77f['x']+_0x1ca77f['width']/0x2,_0x4e21fd=Math[_0x36c69a(0xb8)](_0x5ca154-_0x3d2879),_0x1ec3f8=_0x52a157*ENTRANCE_SHOOT_ALIGNMENT_FACTOR;let _0x5bdfe2=!![];const _0x30122a={'x':ship['x']-ENTRANCE_SHOOT_BULLET_CHECK_BUFFER/0x2,'y':ship['y']-ENTRANCE_SHOOT_BULLET_CHECK_LOOKAHEAD,'width':_0x52a157+ENTRANCE_SHOOT_BULLET_CHECK_BUFFER,'height':ENTRANCE_SHOOT_BULLET_CHECK_LOOKAHEAD+ship[_0x36c69a(0x166)]};for(const _0x47f143 of enemyBullets){if(_0x47f143&&_0x47f143['y']+_0x47f143[_0x36c69a(0x166)]>0x0&&_0x47f143['y']<_0x5ca2c0){const _0x345121={'x':_0x47f143['x'],'y':_0x47f143['y'],'width':_0x47f143[_0x36c69a(0x17e)],'height':_0x47f143[_0x36c69a(0x166)]};if(checkCollision(_0x30122a,_0x345121)){_0x5bdfe2=![];break;}}}_0x5bdfe2&&_0x4e21fd<_0x1ec3f8&&((isDualShipActive||_0x1ca77f['type']!==ENEMY3_TYPE||captureAttemptMadeThisLevel||isShipCaptured)&&(_0x4213d7=!![]));}}else{if(isChallengingStage){let _0x33a5f4=Infinity;_0x1ca77f=null;for(const _0x124bb5 of enemies){if(_0x124bb5&&_0x124bb5[_0x36c69a(0xfd)]===_0x36c69a(0x9f)&&_0x124bb5['y']<_0x6a5455){const _0x287410=_0x124bb5['x']+_0x124bb5[_0x36c69a(0x17e)]/0x2,_0x58d809=Math['abs'](_0x287410-_0x5ca154),_0x577d9b=(0x1-Math['min'](0x1,_0x124bb5['y']/_0x6a5455))*0x2,_0x2996f5=_0x58d809/_0x3dc0a4*0.5,_0x1dc084=_0x577d9b+_0x2996f5;_0x1dc084<_0x33a5f4&&(_0x33a5f4=_0x1dc084,_0x1ca77f=_0x124bb5);}}let _0x4a5e71=_0x5ca154;if(_0x1ca77f){const _0x533d2d=_0x1ca77f['x']+_0x1ca77f[_0x36c69a(0x17e)]/0x2,_0x17626b=_0x1ca77f['y']+_0x1ca77f[_0x36c69a(0x166)]/0x2,_0x52360a=_0x6a5455-_0x17626b;let _0x2d8790=_0x533d2d;const _0x2e3537=_0x1ca77f[_0x36c69a(0xdf)]===0x2||_0x1ca77f[_0x36c69a(0xdf)]===0x3;if(!_0x2e3537&&_0x52360a>0x0&&PLAYER_BULLET_SPEED>0.1){const _0x3c3dc2=Math[_0x36c69a(0xfa)](MAX_PREDICTION_TIME_CS,_0x52360a/PLAYER_BULLET_SPEED),_0x596074=0.4,_0x532baf=(_0x1ca77f['velocityX']||0x0)*_0x3c3dc2;_0x2d8790=_0x533d2d+_0x532baf*_0x596074,_0x2d8790=Math[_0x36c69a(0x182)](_0x1ca77f['width']/0x2,Math['min'](_0x3dc0a4-_0x1ca77f[_0x36c69a(0x17e)]/0x2,_0x2d8790));}_0x4a5e71=_0x2d8790,_0x317ff1=_0x4a5e71-_0x52a157/0x2,_0x317ff1=Math['max'](AI_EDGE_BUFFER,Math[_0x36c69a(0xfa)](_0x3dc0a4-_0x52a157-AI_EDGE_BUFFER,_0x317ff1));const _0x4362d2=_0x52a157*1.5,_0x2af7c3=Math[_0x36c69a(0xb8)](_0x5ca154-_0x4a5e71);_0x2af7c3<_0x4362d2&&(_0x4213d7=!![]);}else{const _0x15a79b=Math[_0x36c69a(0xc1)](_0x3795d0/AI_WIGGLE_PERIOD*0x2*Math['PI'])*AI_WIGGLE_AMPLITUDE*0.5;_0x317ff1=_0x15b519+_0x15a79b,_0x317ff1=Math[_0x36c69a(0x182)](AI_EDGE_BUFFER,Math[_0x36c69a(0xfa)](_0x3dc0a4-_0x52a157-AI_EDGE_BUFFER,_0x317ff1));}}else{let _0x4c2c94=-Infinity;_0x1ca77f=null;const _0x42b4e4=_0x243ea1&&!_0x3f2f78;for(const _0x3d14dd of enemies){if(!_0x3d14dd)continue;if(_0x42b4e4&&_0x3d14dd['id']===capturingBossId)continue;let _0x52165f=![],_0x333313=0x0;switch(_0x3d14dd['state']){case _0x36c69a(0x14f):_0x52165f=!![],_0x333313=_0x42b4e4?0x4e20:0x4650;break;case'moving_to_grid':case'returning':_0x52165f=!![],_0x333313=0x2328;break;case'preparing_attack':_0x52165f=!![],_0x333313=0x1b58;break;case _0x36c69a(0xd1):_0x52165f=!![],_0x333313=0x1770;break;case _0x36c69a(0xf9):_0x52165f=!![],_0x333313=0x61a8;break;}if(_0x52165f){let _0x3be730=_0x333313,_0x2069ad=_0x3d14dd[_0x36c69a(0x159)]&&_0x3d14dd[_0x36c69a(0x142)]===ENEMY3_TYPE?0x1388:0x0,_0x22ca4b=(_0x5ca2c0-_0x3d14dd['y'])*0x2,_0x148024=Math[_0x36c69a(0x182)](0x0,_0x52a157*0x1-Math[_0x36c69a(0xb8)](_0x3d14dd['x']+_0x3d14dd[_0x36c69a(0x17e)]/0x2-_0x5ca154))*0x1;_0x3be730+=_0x22ca4b+_0x2069ad+_0x148024,_0x3be730>_0x4c2c94&&(_0x4c2c94=_0x3be730,_0x1ca77f=_0x3d14dd);}}let _0x1fff17=_0x15b519+_0x52a157/0x2;if(_0x1ca77f){const _0x1b2cdd=_0x1ca77f['x']+_0x1ca77f['width']/0x2,_0x2b4296=_0x1ca77f['y']+_0x1ca77f[_0x36c69a(0x166)]/0x2,_0x7fc0f5=_0x6a5455-_0x2b4296;let _0x5b08b9=_0x1b2cdd;if(_0x1ca77f[_0x36c69a(0xfd)]!==_0x36c69a(0x14f)&&_0x1ca77f[_0x36c69a(0xfd)]!==_0x36c69a(0xf9)){if(_0x7fc0f5>0x0&&PLAYER_BULLET_SPEED>0.1){const _0x53427e=Math[_0x36c69a(0xfa)](MAX_PREDICTION_TIME,_0x7fc0f5/PLAYER_BULLET_SPEED);let _0x4da8e1=_0x1b2cdd+(_0x1ca77f[_0x36c69a(0xce)]||0x0)*_0x53427e;_0x5b08b9=Math['max'](_0x1ca77f['width']/0x2,Math[_0x36c69a(0xfa)](_0x3dc0a4-_0x1ca77f[_0x36c69a(0x17e)]/0x2,_0x4da8e1));}}_0x1fff17=_0x5b08b9,_0x317ff1=_0x1fff17-_0x52a157/0x2;if(_0x1ca77f['state']===_0x36c69a(0x14f)||_0x1ca77f[_0x36c69a(0xfd)]===_0x36c69a(0xf9))_0x317ff1=Math['max'](AI_EDGE_BUFFER,Math[_0x36c69a(0xfa)](_0x3dc0a4-_0x52a157-AI_EDGE_BUFFER,_0x317ff1));else{const _0x48ac15=_0x3dc0a4*0.6/0x2,_0x47f59b=_0x5b59eb-_0x48ac15,_0x2574fe=_0x5b59eb+_0x48ac15-_0x52a157;_0x317ff1=Math[_0x36c69a(0x182)](_0x47f59b,Math[_0x36c69a(0xfa)](_0x2574fe,_0x317ff1)),_0x317ff1=Math[_0x36c69a(0x182)](AI_EDGE_BUFFER,Math[_0x36c69a(0xfa)](_0x3dc0a4-_0x52a157-AI_EDGE_BUFFER,_0x317ff1));}let _0x124653=![],_0x4ea532=Math[_0x36c69a(0xb8)](_0x5ca154-_0x1fff17),_0xfe224f=_0x1ca77f[_0x36c69a(0xfd)]===_0x36c69a(0x14f)||_0x1ca77f[_0x36c69a(0xfd)]===_0x36c69a(0xf9)?_0x52a157*GRID_SHOOT_ALIGNMENT_FACTOR:_0x52a157*FINAL_SHOOT_ALIGNMENT_THRESHOLD;const _0x88d763=ship['x']<AI_EDGE_BUFFER*AI_EDGE_SHOOT_BUFFER_FACTOR,_0x10abb9=ship['x']>_0x3dc0a4-_0x52a157-AI_EDGE_SHOOT_BUFFER_FACTOR,_0x25633a=_0x1fff17>_0x3dc0a4*AI_EDGE_SHOOT_TARGET_THRESHOLD_FACTOR,_0x333a68=_0x1fff17<_0x3dc0a4*(0x1-AI_EDGE_SHOOT_TARGET_THRESHOLD_FACTOR);(_0x88d763&&_0x25633a||_0x10abb9&&_0x333a68)&&(_0x124653=!![]);if(!_0x124653&&_0x4ea532<_0xfe224f){let _0x18426e=![];if(_0x1ca77f[_0x36c69a(0xfd)]!==_0x36c69a(0x14f)&&_0x1ca77f['state']!==_0x36c69a(0xf9))for(const _0x2d7cd5 of enemies){if(!_0x2d7cd5||_0x2d7cd5===_0x1ca77f)continue;if(_0x42b4e4&&_0x2d7cd5['id']===capturingBossId)continue;if(_0x2d7cd5['y']<_0x6a5455&&_0x2d7cd5['y']+_0x2d7cd5[_0x36c69a(0x166)]>_0x1ca77f['y']){const _0x198183=_0x2d7cd5['x']-AI_SHOT_CLEARANCE_BUFFER,_0xf4d8fa=_0x2d7cd5['x']+_0x2d7cd5[_0x36c69a(0x17e)]+AI_SHOT_CLEARANCE_BUFFER;if(_0x1fff17>_0x198183&&_0x1fff17<_0xf4d8fa){_0x18426e=!![];break;}}}!_0x18426e&&((!_0x42b4e4||_0x1ca77f['id']!==capturingBossId)&&(_0x4213d7=!![]));}}else{const _0x2565c4=Math[_0x36c69a(0xc1)](_0x3795d0/AI_WIGGLE_PERIOD*0x2*Math['PI'])*AI_WIGGLE_AMPLITUDE;_0x317ff1=_0x15b519+_0x2565c4,_0x317ff1=Math[_0x36c69a(0x182)](AI_EDGE_BUFFER,Math[_0x36c69a(0xfa)](_0x3dc0a4-_0x52a157-AI_EDGE_BUFFER,_0x317ff1));}}}}}}}ship[_0x36c69a(0x169)]=_0x317ff1;if(_0x4213d7&&!_0x237b15&&!_0x3f2f78){let _0x3f1afb=!![];!isChallengingStage&&(_0x3f1afb=_0x3795d0>=aiCanShootTime),_0x3f1afb&&_0x3795d0-aiLastShotTime>=AI_SHOOT_COOLDOWN&&(firePlayerBullet(!![])&&(aiLastShotTime=_0x3795d0));}}catch(_0x45984d){console[_0x36c69a(0x104)]('Error\x20in\x20aiControl:',_0x45984d,_0x45984d[_0x36c69a(0x9e)]);if(ship)ship[_0x36c69a(0x169)]=ship['x'];aiNeedsStabilization=!![],smoothedShipX=undefined;}}function findAndDetachEnemy(){const _0x415f02=_0x27dd;try{if(!isFullGridWave&&isShipCaptured){const _0x3a735f=enemies['find'](_0x1bb49d=>_0x1bb49d&&_0x1bb49d[_0x415f02(0x142)]===ENEMY3_TYPE&&_0x1bb49d[_0x415f02(0x77)]&&_0x1bb49d[_0x415f02(0xfd)]==='in_grid');if(_0x3a735f){console[_0x415f02(0xe3)](_0x415f02(0x13d)+_0x3a735f['id']+_0x415f02(0x7c)),_0x3a735f[_0x415f02(0x92)]=!![],_0x3a735f[_0x415f02(0xd2)]=_0x415f02(0xad);const _0x5cfee8=new Set([_0x3a735f['id']]);return resetJustReturnedFlags(_0x5cfee8),[_0x3a735f];}}if(isEntrancePhaseActive)return null;let _0x36c784=enemies[_0x415f02(0x8f)](_0x2f2956=>_0x2f2956&&_0x2f2956[_0x415f02(0xfd)]===_0x415f02(0x14f)&&!_0x2f2956[_0x415f02(0x92)]);if(_0x36c784['length']===0x0){_0x36c784=enemies[_0x415f02(0x8f)](_0x35e927=>_0x35e927&&_0x35e927[_0x415f02(0xfd)]===_0x415f02(0x14f));if(_0x36c784[_0x415f02(0x140)]===0x0)return null;}if(_0x36c784[_0x415f02(0x140)]===0x0)return null;_0x36c784[_0x415f02(0x6d)]((_0x59259e,_0x397e29)=>(_0x397e29[_0x415f02(0x138)]||0x0)-(_0x59259e[_0x415f02(0x138)]||0x0));const _0x5476d1=_0x36c784[_0x415f02(0x140)]<=0x3;let _0x456ce1=[];const _0xd1e9=_0x415f02(0xad);gridJustCompleted&&(gridJustCompleted=![]);let _0x1edc9c=![];if(level>0x1&&!_0x5476d1&&_0x36c784['length']>=0x3){const _0x534aa9=_0x36c784['filter'](_0x1fd132=>_0x1fd132[_0x415f02(0x142)]===ENEMY3_TYPE&&!_0x1fd132[_0x415f02(0x77)]);for(const _0x232194 of _0x534aa9){const _0x522899=_0x36c784[_0x415f02(0xf2)](_0x20a6f4=>_0x20a6f4[_0x415f02(0x142)]===ENEMY2_TYPE&&_0x20a6f4[_0x415f02(0x138)]===_0x232194[_0x415f02(0x138)]&&_0x20a6f4['gridCol']===_0x232194[_0x415f02(0x8a)]-0x1),_0x13ad9b=_0x36c784[_0x415f02(0xf2)](_0x3437bc=>_0x3437bc['type']===ENEMY2_TYPE&&_0x3437bc[_0x415f02(0x138)]===_0x232194['gridRow']&&_0x3437bc[_0x415f02(0x8a)]===_0x232194[_0x415f02(0x8a)]+0x1);if(_0x522899&&_0x13ad9b){_0x456ce1=[_0x232194,_0x522899,_0x13ad9b],_0x1edc9c=!![];break;}}}if(!_0x1edc9c&&!_0x5476d1){const _0x128ba1=_0x36c784[_0x415f02(0x8f)](_0x312a1c=>_0x312a1c[_0x415f02(0x142)]===ENEMY1_TYPE),_0x5487eb=scaleValue(level,BASE_BEE_GROUP_ATTACK_PROBABILITY,MAX_BEE_GROUP_ATTACK_PROBABILITY)*1.2;if(_0x128ba1[_0x415f02(0x140)]>=0x2&&Math[_0x415f02(0x149)]()<_0x5487eb){const _0x47f31b=scaleValue(level,BASE_BEE_TRIPLE_ATTACK_PROBABILITY,MAX_BEE_TRIPLE_ATTACK_PROBABILITY)*1.1,_0x61cd85=_0x128ba1[_0x415f02(0x140)]>=0x3&&Math['random']()<_0x47f31b?0x3:0x2;let _0x327156=![];_0x128ba1[_0x415f02(0x6d)](()=>Math['random']()-0.5);for(let _0xaca43c=0x0;_0xaca43c<_0x128ba1[_0x415f02(0x140)];_0xaca43c++){const _0xc5b7=_0x128ba1[_0xaca43c];let _0x2a43b1=[_0xc5b7];const _0x4ddfd3=_0x128ba1[_0x415f02(0x8f)](_0x4a8e3e=>_0x4a8e3e['id']!==_0xc5b7['id']&&_0x4a8e3e[_0x415f02(0x138)]===_0xc5b7[_0x415f02(0x138)]);_0x4ddfd3[_0x415f02(0x6d)]((_0x2c09ab,_0x39237f)=>Math[_0x415f02(0xb8)](_0x2c09ab[_0x415f02(0x8a)]-_0xc5b7['gridCol'])-Math[_0x415f02(0xb8)](_0x39237f[_0x415f02(0x8a)]-_0xc5b7[_0x415f02(0x8a)]));for(let _0x3af78b=0x0;_0x3af78b<_0x4ddfd3['length']&&_0x2a43b1[_0x415f02(0x140)]<_0x61cd85;_0x3af78b++){_0x2a43b1[_0x415f02(0xb3)](_0x4ddfd3[_0x3af78b]);}if(_0x2a43b1[_0x415f02(0x140)]===_0x61cd85){_0x456ce1=_0x2a43b1,_0x1edc9c=!![],_0x327156=!![];break;}}!_0x327156&&_0x128ba1[_0x415f02(0x140)]>=_0x61cd85&&(_0x456ce1=_0x128ba1['slice'](0x0,_0x61cd85),_0x1edc9c=!![]);}}if(!_0x1edc9c&&!_0x5476d1){const _0x27ac98=_0x36c784[_0x415f02(0x8f)](_0x2c2e54=>_0x2c2e54[_0x415f02(0x142)]===ENEMY2_TYPE),_0x12e0c0=0.2;if(_0x27ac98[_0x415f02(0x140)]>=0x2&&Math[_0x415f02(0x149)]()<_0x12e0c0){const _0x1872f7=0x2;let _0x282b2e=![];_0x27ac98[_0x415f02(0x6d)](()=>Math['random']()-0.5);for(let _0x497179=0x0;_0x497179<_0x27ac98[_0x415f02(0x140)];_0x497179++){const _0x52444b=_0x27ac98[_0x497179];let _0x5503d3=[_0x52444b];const _0xec74b7=_0x27ac98['filter'](_0x26ac67=>_0x26ac67['id']!==_0x52444b['id']&&_0x26ac67[_0x415f02(0x138)]===_0x52444b[_0x415f02(0x138)]);_0xec74b7[_0x415f02(0x6d)]((_0x5dc1b6,_0x1cb52e)=>Math[_0x415f02(0xb8)](_0x5dc1b6[_0x415f02(0x8a)]-_0x52444b[_0x415f02(0x8a)])-Math['abs'](_0x1cb52e[_0x415f02(0x8a)]-_0x52444b['gridCol']));for(let _0x116b88=0x0;_0x116b88<_0xec74b7[_0x415f02(0x140)]&&_0x5503d3['length']<_0x1872f7;_0x116b88++){_0x5503d3['push'](_0xec74b7[_0x116b88]);}if(_0x5503d3[_0x415f02(0x140)]===_0x1872f7){_0x456ce1=_0x5503d3,_0x1edc9c=!![],_0x282b2e=!![];break;}}!_0x282b2e&&_0x27ac98[_0x415f02(0x140)]>=_0x1872f7&&(_0x456ce1=_0x27ac98[_0x415f02(0xf4)](0x0,_0x1872f7),_0x1edc9c=!![]);}}if(!_0x1edc9c&&_0x36c784['length']>0x0){const _0x4ff971=_0x36c784[0x0];_0x456ce1[_0x415f02(0xb3)](_0x4ff971);if(_0x36c784[_0x415f02(0x140)]>0x1&&!_0x5476d1&&Math[_0x415f02(0x149)]()<0.2){const _0x799ff4=_0x36c784[_0x415f02(0xf2)](_0x1ff3bb=>_0x1ff3bb['id']!==_0x4ff971['id']&&_0x1ff3bb[_0x415f02(0x138)]===_0x4ff971[_0x415f02(0x138)]&&_0x1ff3bb['gridCol']===_0x4ff971[_0x415f02(0x8a)]-0x1),_0x1191e1=_0x36c784[_0x415f02(0xf2)](_0x4f659a=>_0x4f659a['id']!==_0x4ff971['id']&&_0x4f659a['gridRow']===_0x4ff971[_0x415f02(0x138)]&&_0x4f659a[_0x415f02(0x8a)]===_0x4ff971[_0x415f02(0x8a)]+0x1),_0x1108cf=_0x799ff4||_0x1191e1;if(_0x1108cf){const _0x3cc168=_0x4ff971[_0x415f02(0x142)]===ENEMY3_TYPE&&_0x1108cf[_0x415f02(0x142)]===ENEMY3_TYPE;!_0x3cc168&&_0x456ce1[_0x415f02(0xb3)](_0x1108cf);}}_0x1edc9c=!![];}if(_0x456ce1[_0x415f02(0x140)]>0x0){_0x456ce1=_0x456ce1[_0x415f02(0x8f)](_0x13dbf2=>_0x13dbf2);if(_0x456ce1[_0x415f02(0x140)]===0x0)return null;_0x456ce1[_0x415f02(0x7e)](_0x10eea5=>{const _0x509433=_0x415f02;_0x10eea5&&(_0x10eea5['justReturned']=!![],_0x10eea5[_0x509433(0xd2)]=_0xd1e9);});const _0x31f394=new Set(_0x456ce1[_0x415f02(0xd8)](_0x7e531b=>_0x7e531b['id']));return resetJustReturnedFlags(_0x31f394),_0x456ce1;}return null;}catch(_0x5ec091){return console[_0x415f02(0x104)](_0x415f02(0x16d),_0x5ec091),null;}}function triggerImmediateCaptureDive(){const _0x2702e8=_0x27dd;try{if(playerLives<=0x1||isChallengingStage||isShipCaptured||isDualShipActive||captureAttemptMadeThisLevel)return;const _0x19726f=enemies[_0x2702e8(0x8f)](_0x1759ee=>_0x1759ee&&_0x1759ee[_0x2702e8(0xfd)]==='in_grid'&&_0x1759ee[_0x2702e8(0x142)]===ENEMY3_TYPE&&!_0x1759ee[_0x2702e8(0x77)]);if(_0x19726f[_0x2702e8(0x140)]>0x0){const _0x26252a=_0x19726f[Math[_0x2702e8(0x15d)](Math[_0x2702e8(0x149)]()*_0x19726f[_0x2702e8(0x140)])],_0x35b705=Date[_0x2702e8(0x164)]();captureAttemptMadeThisLevel=!![],_0x26252a['justReturned']=!![];const _0x288273=new Set([_0x26252a['id']]);resetJustReturnedFlags(_0x288273);const _0x3016cb=Math['random']()<0.5?'left':_0x2702e8(0x171),_0x4004fd=_0x3016cb==='left'?gameCanvas[_0x2702e8(0x17e)]*CAPTURE_DIVE_SIDE_MARGIN_FACTOR:gameCanvas[_0x2702e8(0x17e)]*(0x1-CAPTURE_DIVE_SIDE_MARGIN_FACTOR)-BOSS_WIDTH,_0x540f97=gameCanvas[_0x2702e8(0x166)]*CAPTURE_DIVE_BOTTOM_HOVER_Y_FACTOR;_0x26252a['state']=_0x2702e8(0xf9),_0x26252a['targetX']=_0x4004fd,_0x26252a[_0x2702e8(0xf7)]=_0x540f97,_0x26252a['diveStartTime']=_0x35b705,playSound(bossGalagaDiveSound);const _0x34c13d=_0x26252a['id'];_0x26252a['capturePrepareTimeout']=setTimeout(()=>{const _0x2f2e1f=_0x2702e8,_0x1c79a8=enemies[_0x2f2e1f(0xf2)](_0x4c704d=>_0x4c704d?.['id']===_0x34c13d);_0x1c79a8&&_0x1c79a8['state']==='preparing_capture'&&(_0x1c79a8['state']='diving_to_capture_position');if(_0x1c79a8)_0x1c79a8[_0x2f2e1f(0x110)]=null;const _0x55b620=enemySpawnTimeouts[_0x2f2e1f(0xa6)](_0x49ee5f=>_0x49ee5f===_0x26252a['capturePrepareTimeout']);if(_0x55b620>-0x1)enemySpawnTimeouts['splice'](_0x55b620,0x1);},0x12c),enemySpawnTimeouts[_0x2702e8(0xb3)](_0x26252a[_0x2702e8(0x110)]);}else{}}catch(_0x33d177){console[_0x2702e8(0x104)]('Error\x20in\x20triggerImmediateCaptureDive:',_0x33d177);}}function resetJustReturnedFlags(_0x482cc2){const _0x224b5e=_0x27dd;enemies[_0x224b5e(0x7e)](_0x39c338=>{const _0x42c88d=_0x224b5e;let _0x3c9890=![];if(_0x482cc2 instanceof Set)_0x3c9890=_0x482cc2['has'](_0x39c338['id']);else typeof _0x482cc2===_0x42c88d(0x16a)&&(_0x3c9890=_0x39c338['id']===_0x482cc2);_0x39c338&&_0x39c338[_0x42c88d(0xfd)]===_0x42c88d(0x14f)&&_0x39c338[_0x42c88d(0x92)]&&!_0x3c9890&&(_0x39c338[_0x42c88d(0x92)]=![]);});}function updateFloatingScores(){const _0x78bb34=_0x27dd;if(isPaused)return;try{const _0x4db894=Date[_0x78bb34(0x164)]();floatingScores=floatingScores['filter'](_0x5aa6e9=>_0x4db894-_0x5aa6e9[_0x78bb34(0xcc)]<FLOATING_SCORE_DURATION+FLOATING_SCORE_APPEAR_DELAY);}catch(_0x3d4221){console['error'](_0x78bb34(0xd6),_0x3d4221),floatingScores=[];}}function updateExplosions(){const _0x36a5fc=_0x27dd;if(isPaused)return;try{const _0x7664f9=Date[_0x36a5fc(0x164)]();for(let _0x1e45b2=explosions['length']-0x1;_0x1e45b2>=0x0;_0x1e45b2--){const _0x1e6bd5=explosions[_0x1e45b2],_0x17de58=_0x7664f9-_0x1e6bd5['creationTime'];if(_0x17de58>_0x1e6bd5[_0x36a5fc(0xb0)]){explosions[_0x36a5fc(0x76)](_0x1e45b2,0x1);continue;}_0x1e6bd5[_0x36a5fc(0xb5)][_0x36a5fc(0x7e)](_0x13785e=>{const _0x13c19b=_0x36a5fc;_0x13785e['x']+=_0x13785e['vx'],_0x13785e['y']+=_0x13785e['vy'],_0x13785e[_0x13c19b(0xf1)]=Math['max'](0x0,0x1-_0x17de58/_0x1e6bd5[_0x13c19b(0xb0)]*EXPLOSION_FADE_SPEED);});}}catch(_0x593238){console[_0x36a5fc(0x104)](_0x36a5fc(0x125),_0x593238),explosions=[];}}function moveEntities(){const _0x5b6da9=_0x27dd;if(isPaused)return;try{if(ship&&isInGameState&&playerLives>0x0&&gameOverSequenceStartTime===0x0&&!isShowingPlayerGameOverMessage&&!isWaitingForRespawn){let _0x143d88=ship[_0x5b6da9(0x17e)];isDualShipActive&&(_0x143d88+=DUAL_SHIP_OFFSET_X);let _0x56673b=ship['x'];if(isManualControl){let _0x435ccc=![],_0x1f8506=![];currentPlayer===0x1||!isTwoPlayerMode?(_0x435ccc=leftPressed,_0x1f8506=rightPressed):(_0x435ccc=p2LeftPressed,_0x1f8506=p2RightPressed);if(_0x435ccc&&ship['x']>0x0)_0x56673b=ship['x']-ship['speed'];else _0x1f8506&&ship['x']<gameCanvas[_0x5b6da9(0x17e)]-_0x143d88&&(_0x56673b=ship['x']+ship[_0x5b6da9(0x188)]);ship['x']=Math[_0x5b6da9(0x182)](0x0,Math[_0x5b6da9(0xfa)](gameCanvas['width']-_0x143d88,_0x56673b)),ship[_0x5b6da9(0x169)]=ship['x'];}else{if(typeof smoothedShipX!==_0x5b6da9(0xb4)){const _0x2c5f29=0.1,_0x5ed1c5=1.2;smoothedShipX+=(ship[_0x5b6da9(0x169)]-smoothedShipX)*AI_SMOOTHING_FACTOR_MOVE;const _0x9a2b38=smoothedShipX-ship['x'],_0x5d5e0f=ship[_0x5b6da9(0x188)]*_0x5ed1c5;let _0x32eec7=0x0;if(Math[_0x5b6da9(0xb8)](_0x9a2b38)>_0x2c5f29){const _0x4ce944=isChallengingStage?CS_AI_MOVE_FRACTION:NORMAL_MOVE_FRACTION;_0x32eec7=_0x9a2b38*_0x4ce944,_0x32eec7=Math['max'](-_0x5d5e0f,Math[_0x5b6da9(0xfa)](_0x5d5e0f,_0x32eec7)),Math[_0x5b6da9(0xb8)](_0x32eec7)>Math['abs'](_0x9a2b38)&&(_0x32eec7=_0x9a2b38),ship['x']+=_0x32eec7,ship['x']=Math['max'](0x0,Math[_0x5b6da9(0xfa)](gameCanvas[_0x5b6da9(0x17e)]-_0x143d88,ship['x']));}}else ship['x']=Math[_0x5b6da9(0x182)](0x0,Math[_0x5b6da9(0xfa)](gameCanvas[_0x5b6da9(0x17e)]-_0x143d88,ship[_0x5b6da9(0x169)]));}}const _0x2fa7f3=Date['now']();for(let _0x3fdbdf=bullets[_0x5b6da9(0x140)]-0x1;_0x3fdbdf>=0x0;_0x3fdbdf--){const _0x2e7938=bullets[_0x3fdbdf];_0x2e7938?(_0x2e7938['y']-=_0x2e7938['speed'],_0x2e7938['y']+PLAYER_BULLET_HEIGHT<0x0&&bullets[_0x5b6da9(0x76)](_0x3fdbdf,0x1)):bullets[_0x5b6da9(0x76)](_0x3fdbdf,0x1);}for(let _0x34d7d0=enemyBullets[_0x5b6da9(0x140)]-0x1;_0x34d7d0>=0x0;_0x34d7d0--){const _0x720ffb=enemyBullets[_0x34d7d0];if(!_0x720ffb){enemyBullets[_0x5b6da9(0x76)](_0x34d7d0,0x1);continue;}_0x720ffb['x']+=_0x720ffb['vx'],_0x720ffb['y']+=_0x720ffb['vy'],(_0x720ffb['y']>gameCanvas[_0x5b6da9(0x166)]||_0x720ffb['y']<-ENEMY_BULLET_HEIGHT||_0x720ffb['x']<-ENEMY_BULLET_WIDTH||_0x720ffb['x']>gameCanvas[_0x5b6da9(0x17e)])&&enemyBullets['splice'](_0x34d7d0,0x1);}for(let _0x219f13=fallingShips[_0x5b6da9(0x140)]-0x1;_0x219f13>=0x0;_0x219f13--){const _0x5632f0=fallingShips[_0x219f13];if(!_0x5632f0){fallingShips[_0x5b6da9(0x76)](_0x219f13,0x1);continue;}_0x5632f0['y']+=FALLING_SHIP_SPEED;const _0x433a5b=_0x2fa7f3-_0x5632f0['creationTime'];typeof _0x5632f0['tintProgress']===_0x5b6da9(0x102)?_0x5632f0[_0x5b6da9(0xde)]=Math[_0x5b6da9(0x182)](0x0,0x1-_0x433a5b/FALLING_SHIP_FADE_DURATION_MS):_0x5632f0[_0x5b6da9(0xde)]=0x0;if(typeof _0x5632f0[_0x5b6da9(0xe1)]==='number'){const _0x1124bb=Math['min'](0x1,_0x433a5b/FALLING_SHIP_ROTATION_DURATION_MS);_0x5632f0[_0x5b6da9(0xe1)]=_0x1124bb*0x2*(0x2*Math['PI']);}else _0x5632f0[_0x5b6da9(0xe1)]=0x0;if(ship&&!isDualShipActive&&!isShipCaptured&&!isWaitingForRespawn&&_0x5632f0['y']+_0x5632f0['height']>=gameCanvas['height']-AUTO_DOCK_THRESHOLD){fallingShips[_0x5b6da9(0x76)](_0x219f13,0x1),isDualShipActive=!![];currentPlayer===0x1?player1IsDualShipActive=!![]:player2IsDualShipActive=!![];playSound(dualShipSound);continue;}_0x5632f0['y']>gameCanvas[_0x5b6da9(0x166)]+_0x5632f0[_0x5b6da9(0x166)]&&fallingShips[_0x5b6da9(0x76)](_0x219f13,0x1);}let _0x5c3809=0x0;const _0x4cff20=enemies['some'](_0x506a5e=>_0x506a5e?.[_0x5b6da9(0xfd)]===_0x5b6da9(0x14f)),_0x256c5a=!isChallengingStage&&!isWaveTransitioning&&_0x4cff20&&!isShowingPlayerGameOverMessage;if(_0x256c5a){!isGridSoundPlaying&&(isGridSoundPlaying=!![],playSound(gridBackgroundSound));const _0x1c5df4=enemies[_0x5b6da9(0x8f)](_0x2bb7da=>_0x2bb7da?.[_0x5b6da9(0xfd)]===_0x5b6da9(0x14f));if(_0x1c5df4['length']>0x0){let _0x10df64=gameCanvas[_0x5b6da9(0x17e)],_0x5ddfc3=0x0;_0x1c5df4[_0x5b6da9(0x7e)](_0x3715b7=>{const _0x4487b2=_0x5b6da9;_0x3715b7&&(_0x10df64=Math[_0x4487b2(0xfa)](_0x10df64,_0x3715b7['x']),_0x5ddfc3=Math['max'](_0x5ddfc3,_0x3715b7['x']+_0x3715b7[_0x4487b2(0x17e)]));});const _0x3ad315=gameCanvas[_0x5b6da9(0x17e)]*GRID_HORIZONTAL_MARGIN_PERCENT,_0x2b0265=gameCanvas[_0x5b6da9(0x17e)]*(0x1-GRID_HORIZONTAL_MARGIN_PERCENT);if(gridMoveDirection===0x1&&_0x5ddfc3>=_0x2b0265)gridMoveDirection=-0x1;else gridMoveDirection===-0x1&&_0x10df64<=_0x3ad315&&(gridMoveDirection=0x1);const _0x5006ca=scaleValue(level,BASE_GRID_MOVE_SPEED,MAX_GRID_MOVE_SPEED);_0x5c3809=_0x5006ca*gridMoveDirection,currentGridOffsetX+=_0x5c3809,enemies[_0x5b6da9(0x7e)](_0x1be036=>{const _0x29bd23=_0x5b6da9;if(_0x1be036&&(_0x1be036[_0x29bd23(0xfd)]===_0x29bd23(0xa4)||_0x1be036['state']===_0x29bd23(0x14f)||_0x1be036[_0x29bd23(0xfd)]===_0x29bd23(0x181)))try{const _0x2a7370=_0x1be036[_0x29bd23(0x142)]===ENEMY3_TYPE?BOSS_WIDTH:_0x1be036['type']===ENEMY1_TYPE?ENEMY1_WIDTH:ENEMY_WIDTH,{x:_0x5a634a,y:_0x502c4e}=getCurrentGridSlotPosition(_0x1be036[_0x29bd23(0x138)],_0x1be036[_0x29bd23(0x8a)],_0x2a7370);_0x1be036[_0x29bd23(0xa9)]=_0x5a634a,_0x1be036[_0x29bd23(0x12e)]=_0x502c4e;}catch(_0xe17531){console[_0x29bd23(0x104)](_0x29bd23(0xfe)+_0x1be036?.['id']+_0x29bd23(0x78)+_0x1be036?.[_0x29bd23(0xfd)]+')\x20during\x20shift:',_0xe17531);}});}}else isGridSoundPlaying&&(stopSound(gridBackgroundSound),isGridSoundPlaying=![]),_0x5c3809=0x0;for(let _0x3d41dd=enemies[_0x5b6da9(0x140)]-0x1;_0x3d41dd>=0x0;_0x3d41dd--){let _0x117e2c=enemies[_0x3d41dd];if(!_0x117e2c)continue;const _0x46aeaf=_0x117e2c['id'];if(_0x117e2c[_0x5b6da9(0x110)]&&_0x117e2c[_0x5b6da9(0xfd)]!==_0x5b6da9(0xf9)){clearTimeout(_0x117e2c['capturePrepareTimeout']);const _0x12225e=enemySpawnTimeouts[_0x5b6da9(0x12c)](_0x117e2c['capturePrepareTimeout']);if(_0x12225e>-0x1)enemySpawnTimeouts['splice'](_0x12225e,0x1);_0x117e2c[_0x5b6da9(0x110)]=null;}const _0x292ed4=_0x117e2c[_0x5b6da9(0x142)]===ENEMY3_TYPE?BOSS_WIDTH:_0x117e2c['type']===ENEMY1_TYPE?ENEMY1_WIDTH:ENEMY_WIDTH,_0x56cbf1=_0x117e2c[_0x5b6da9(0x142)]===ENEMY3_TYPE?BOSS_HEIGHT:_0x117e2c[_0x5b6da9(0x142)]===ENEMY1_TYPE?ENEMY1_HEIGHT:ENEMY_HEIGHT;switch(_0x117e2c['state']){case _0x5b6da9(0x9f):{let _0x519fec=CS_ENTRANCE_PATH_SPEED;const _0x56734a=_0x117e2c[_0x5b6da9(0xed)]||0x1;_0x519fec*=_0x56734a;if(!isChallengingStage){enemies[_0x5b6da9(0x76)](_0x3d41dd,0x1),_0x117e2c=null;break;}let _0x3fb1e2=challengingStagePaths,_0x3bc1ab=_0x3fb1e2[_0x117e2c[_0x5b6da9(0x15e)]];if(!_0x3bc1ab||_0x117e2c[_0x5b6da9(0x6b)]>=_0x3bc1ab['length']){enemies[_0x5b6da9(0x76)](_0x3d41dd,0x1),_0x117e2c=null;break;}const _0x26c55b=_0x3bc1ab[_0x117e2c['pathSegmentIndex']];if(!_0x26c55b||!_0x26c55b['p0']||!_0x26c55b['p1']||!_0x26c55b['p2']||!_0x26c55b['p3']){console['error'](_0x5b6da9(0xc7)+_0x117e2c[_0x5b6da9(0x6b)]+_0x5b6da9(0x17b)+_0x117e2c['entrancePathId']+_0x5b6da9(0xd7)+_0x117e2c['id']),enemies[_0x5b6da9(0x76)](_0x3d41dd,0x1),_0x117e2c=null;break;}_0x117e2c[_0x5b6da9(0x14e)]+=_0x519fec;let _0x5a90b6,_0x43a433,_0x3e7fc1=_0x117e2c['x'],_0x3432ae=_0x117e2c['y'];if(_0x117e2c[_0x5b6da9(0x14e)]>=0x1){_0x117e2c['pathT']=0x0,_0x117e2c[_0x5b6da9(0x6b)]++;if(_0x117e2c['pathSegmentIndex']>=_0x3bc1ab[_0x5b6da9(0x140)])enemies['splice'](_0x3d41dd,0x1),_0x117e2c=null;else{const _0x44389e=_0x3bc1ab[_0x117e2c['pathSegmentIndex']];_0x44389e?.['p0']?(_0x5a90b6=_0x44389e['p0']['x'],_0x43a433=_0x44389e['p0']['y']):(console[_0x5b6da9(0x104)](_0x5b6da9(0x9c)+_0x117e2c['pathSegmentIndex']+_0x5b6da9(0x17b)+_0x117e2c[_0x5b6da9(0x15e)]+_0x5b6da9(0xd7)+_0x46aeaf),enemies[_0x5b6da9(0x76)](_0x3d41dd,0x1),_0x117e2c=null);}}else try{_0x5a90b6=calculateBezierPoint(_0x117e2c['pathT'],_0x26c55b['p0']['x'],_0x26c55b['p1']['x'],_0x26c55b['p2']['x'],_0x26c55b['p3']['x']),_0x43a433=calculateBezierPoint(_0x117e2c[_0x5b6da9(0x14e)],_0x26c55b['p0']['y'],_0x26c55b['p1']['y'],_0x26c55b['p2']['y'],_0x26c55b['p3']['y']);}catch(_0x14edad){console[_0x5b6da9(0x104)](_0x5b6da9(0xfc)+_0x46aeaf+':',_0x14edad),enemies[_0x5b6da9(0x76)](_0x3d41dd,0x1),_0x117e2c=null;}_0x117e2c&&(isNaN(_0x5a90b6)||isNaN(_0x43a433)?(console[_0x5b6da9(0x104)](_0x5b6da9(0x88)+_0x46aeaf+_0x5b6da9(0x118)),enemies[_0x5b6da9(0x76)](_0x3d41dd,0x1),_0x117e2c=null):(_0x117e2c[_0x5b6da9(0xce)]=_0x5a90b6-_0x3e7fc1,_0x117e2c[_0x5b6da9(0x17d)]=_0x43a433-_0x3432ae,_0x117e2c['x']=_0x5a90b6,_0x117e2c['y']=_0x43a433));break;}case _0x5b6da9(0xec):{if(isChallengingStage){enemies['splice'](_0x3d41dd,0x1),_0x117e2c=null;break;}let _0x3a09a0=normalWaveEntrancePaths,_0xb2c888=_0x3a09a0[_0x117e2c[_0x5b6da9(0x15e)]],_0x333b83;_0x117e2c[_0x5b6da9(0x15e)]===_0x5b6da9(0xf3)||_0x117e2c[_0x5b6da9(0x15e)]===_0x5b6da9(0x17c)?_0x333b83=BOSS_LOOP_ENTRANCE_PATH_SPEED:_0x333b83=NORMAL_ENTRANCE_PATH_SPEED;if(!_0xb2c888){console[_0x5b6da9(0x117)](_0x5b6da9(0xaf)+_0x46aeaf+'\x20missing\x20SHARED\x20path\x20'+_0x117e2c['entrancePathId']+'.\x20Switching\x20to\x20moving_to_grid.');try{_0x117e2c[_0x5b6da9(0xa9)]=_0x117e2c[_0x5b6da9(0xa9)]??gameCanvas['width']/0x2,_0x117e2c[_0x5b6da9(0x12e)]=_0x117e2c[_0x5b6da9(0x12e)]??ENEMY_TOP_MARGIN;}catch(_0xeef708){console['error'](_0x5b6da9(0x126)+_0x46aeaf+_0x5b6da9(0x186),_0xeef708),_0x117e2c[_0x5b6da9(0xa9)]=gameCanvas[_0x5b6da9(0x17e)]/0x2,_0x117e2c[_0x5b6da9(0x12e)]=ENEMY_TOP_MARGIN;}_0x117e2c[_0x5b6da9(0xfd)]=_0x5b6da9(0x181),_0x117e2c[_0x5b6da9(0x14e)]=0x0,_0x117e2c['pathSegmentIndex']=0x0,_0x117e2c[_0x5b6da9(0xce)]=0x0,_0x117e2c['velocityY']=0x0;_0x117e2c[_0x5b6da9(0xdf)]!==undefined&&squadronCompletionStatus[_0x117e2c[_0x5b6da9(0xdf)]]&&squadronCompletionStatus[_0x117e2c[_0x5b6da9(0xdf)]][_0x5b6da9(0xff)]++;break;}if(_0x117e2c[_0x5b6da9(0x6b)]>=_0xb2c888[_0x5b6da9(0x140)]){console['warn']('Enemy\x20'+_0x46aeaf+'\x20path\x20index\x20'+_0x117e2c[_0x5b6da9(0x6b)]+_0x5b6da9(0x11d)+_0x117e2c['entrancePathId']+_0x5b6da9(0x16f));try{_0x117e2c['targetGridX']=_0x117e2c[_0x5b6da9(0xa9)]??gameCanvas[_0x5b6da9(0x17e)]/0x2,_0x117e2c[_0x5b6da9(0x12e)]=_0x117e2c[_0x5b6da9(0x12e)]??ENEMY_TOP_MARGIN;}catch(_0xb66ab8){console[_0x5b6da9(0x104)](_0x5b6da9(0x126)+_0x46aeaf+_0x5b6da9(0x16b),_0xb66ab8),_0x117e2c[_0x5b6da9(0xa9)]=gameCanvas['width']/0x2,_0x117e2c['targetGridY']=ENEMY_TOP_MARGIN;}_0x117e2c[_0x5b6da9(0xfd)]=_0x5b6da9(0x181),_0x117e2c[_0x5b6da9(0x14e)]=0x0,_0x117e2c[_0x5b6da9(0x6b)]=0x0,_0x117e2c['velocityX']=0x0,_0x117e2c['velocityY']=0x0;_0x117e2c['squadronId']!==undefined&&squadronCompletionStatus[_0x117e2c['squadronId']]&&squadronCompletionStatus[_0x117e2c['squadronId']]['completed']++;break;}const _0x4170b6=_0xb2c888[_0x117e2c[_0x5b6da9(0x6b)]];if(!_0x4170b6||!_0x4170b6['p0']||!_0x4170b6['p1']||!_0x4170b6['p2']||!_0x4170b6['p3']){console[_0x5b6da9(0x104)]('Invalid\x20Normal\x20Bezier\x20segment\x20'+_0x117e2c[_0x5b6da9(0x6b)]+_0x5b6da9(0x8e)+_0x117e2c[_0x5b6da9(0x15e)]+'.\x20Enemy\x20'+_0x46aeaf+_0x5b6da9(0x16f));try{_0x117e2c['targetGridX']=_0x117e2c[_0x5b6da9(0xa9)]??gameCanvas[_0x5b6da9(0x17e)]/0x2,_0x117e2c[_0x5b6da9(0x12e)]=_0x117e2c[_0x5b6da9(0x12e)]??ENEMY_TOP_MARGIN+_0x117e2c[_0x5b6da9(0x138)]*(ENEMY_HEIGHT+ENEMY_V_SPACING);}catch(_0x563099){console[_0x5b6da9(0x104)](_0x5b6da9(0x126)+_0x46aeaf+_0x5b6da9(0x133),_0x563099),_0x117e2c[_0x5b6da9(0xa9)]=gameCanvas[_0x5b6da9(0x17e)]/0x2,_0x117e2c['targetGridY']=ENEMY_TOP_MARGIN;}_0x117e2c[_0x5b6da9(0xfd)]=_0x5b6da9(0x181),_0x117e2c[_0x5b6da9(0x14e)]=0x0,_0x117e2c[_0x5b6da9(0x6b)]=0x0,_0x117e2c[_0x5b6da9(0xce)]=0x0,_0x117e2c['velocityY']=0x0;_0x117e2c[_0x5b6da9(0xdf)]!==undefined&&squadronCompletionStatus[_0x117e2c[_0x5b6da9(0xdf)]]&&squadronCompletionStatus[_0x117e2c[_0x5b6da9(0xdf)]][_0x5b6da9(0xff)]++;break;}_0x117e2c[_0x5b6da9(0x14e)]+=_0x333b83;let _0x2e846c,_0x2a139f,_0x4d7545=_0x117e2c['x'],_0x2788ce=_0x117e2c['y'];if(_0x117e2c[_0x5b6da9(0x14e)]>=0x1){_0x117e2c[_0x5b6da9(0x14e)]=0x0,_0x117e2c[_0x5b6da9(0x6b)]++;if(_0x117e2c['pathSegmentIndex']>=_0xb2c888[_0x5b6da9(0x140)]){let _0x42bf67,_0x1b533f;try{_0x42bf67=calculateBezierPoint(0x1,_0x4170b6['p0']['x'],_0x4170b6['p1']['x'],_0x4170b6['p2']['x'],_0x4170b6['p3']['x']),_0x1b533f=calculateBezierPoint(0x1,_0x4170b6['p0']['y'],_0x4170b6['p1']['y'],_0x4170b6['p2']['y'],_0x4170b6['p3']['y']);}catch(_0x528372){console['error'](_0x5b6da9(0xd3)+_0x46aeaf+_0x5b6da9(0xbb)+_0x117e2c['entrancePathId'],_0x528372),_0x42bf67=_0x4170b6['p3']['x'],_0x1b533f=_0x4170b6['p3']['y'];}_0x117e2c['x']=_0x42bf67,_0x117e2c['y']=_0x1b533f;try{_0x117e2c['targetGridX']=_0x117e2c['targetGridX']??gameCanvas[_0x5b6da9(0x17e)]/0x2,_0x117e2c[_0x5b6da9(0x12e)]=_0x117e2c['targetGridY']??ENEMY_TOP_MARGIN;}catch(_0x299fcc){console[_0x5b6da9(0x104)]('Error\x20getting\x20target\x20grid\x20pos\x20for\x20'+_0x46aeaf+_0x5b6da9(0xbb)+_0x117e2c[_0x5b6da9(0x15e)],_0x299fcc),_0x117e2c['targetGridX']=_0x117e2c['x'],_0x117e2c['targetGridY']=ENEMY_TOP_MARGIN+_0x117e2c[_0x5b6da9(0x138)]*(ENEMY_HEIGHT+ENEMY_V_SPACING);}const _0x251f56=_0x117e2c[_0x5b6da9(0xfd)];_0x117e2c[_0x5b6da9(0xfd)]=_0x5b6da9(0x181),_0x117e2c[_0x5b6da9(0xce)]=0x0,_0x117e2c[_0x5b6da9(0x17d)]=0x0,_0x117e2c[_0x5b6da9(0x6b)]=0x0;_0x251f56===_0x5b6da9(0xec)&&_0x117e2c['squadronId']!==undefined&&squadronCompletionStatus[_0x117e2c[_0x5b6da9(0xdf)]]&&squadronCompletionStatus[_0x117e2c[_0x5b6da9(0xdf)]]['completed']++;break;}else{const _0x107316=_0xb2c888[_0x117e2c[_0x5b6da9(0x6b)]];if(_0x107316?.['p0'])_0x2e846c=_0x107316['p0']['x'],_0x2a139f=_0x107316['p0']['y'];else{console['error'](_0x5b6da9(0x176)+_0x117e2c[_0x5b6da9(0x6b)]+_0x5b6da9(0x8e)+_0x117e2c[_0x5b6da9(0x15e)]+_0x5b6da9(0xd7)+_0x46aeaf+_0x5b6da9(0x16f));try{_0x117e2c[_0x5b6da9(0xa9)]=_0x117e2c[_0x5b6da9(0xa9)]??gameCanvas[_0x5b6da9(0x17e)]/0x2,_0x117e2c[_0x5b6da9(0x12e)]=_0x117e2c[_0x5b6da9(0x12e)]??ENEMY_TOP_MARGIN;}catch(_0x6bb079){console[_0x5b6da9(0x104)]('Error\x20getting\x20grid\x20pos\x20for\x20'+_0x46aeaf+_0x5b6da9(0x180),_0x6bb079),_0x117e2c['targetGridX']=gameCanvas[_0x5b6da9(0x17e)]/0x2,_0x117e2c[_0x5b6da9(0x12e)]=ENEMY_TOP_MARGIN;}_0x117e2c['state']=_0x5b6da9(0x181),_0x117e2c['pathT']=0x0,_0x117e2c[_0x5b6da9(0x6b)]=0x0,_0x117e2c[_0x5b6da9(0xce)]=0x0,_0x117e2c[_0x5b6da9(0x17d)]=0x0;_0x117e2c['squadronId']!==undefined&&squadronCompletionStatus[_0x117e2c[_0x5b6da9(0xdf)]]&&squadronCompletionStatus[_0x117e2c[_0x5b6da9(0xdf)]][_0x5b6da9(0xff)]++;break;}}}else try{_0x2e846c=calculateBezierPoint(_0x117e2c[_0x5b6da9(0x14e)],_0x4170b6['p0']['x'],_0x4170b6['p1']['x'],_0x4170b6['p2']['x'],_0x4170b6['p3']['x']),_0x2a139f=calculateBezierPoint(_0x117e2c[_0x5b6da9(0x14e)],_0x4170b6['p0']['y'],_0x4170b6['p1']['y'],_0x4170b6['p2']['y'],_0x4170b6['p3']['y']);}catch(_0x4e5f7a){console[_0x5b6da9(0x104)](_0x5b6da9(0x120)+_0x46aeaf+':',_0x4e5f7a);try{_0x117e2c[_0x5b6da9(0xa9)]=_0x117e2c[_0x5b6da9(0xa9)]??gameCanvas['width']/0x2,_0x117e2c[_0x5b6da9(0x12e)]=_0x117e2c[_0x5b6da9(0x12e)]??ENEMY_TOP_MARGIN;}catch(_0x870de8){console[_0x5b6da9(0x104)](_0x5b6da9(0x126)+_0x46aeaf+'\x20after\x20bezier\x20error',_0x870de8),_0x117e2c[_0x5b6da9(0xa9)]=gameCanvas['width']/0x2,_0x117e2c[_0x5b6da9(0x12e)]=ENEMY_TOP_MARGIN;}_0x117e2c[_0x5b6da9(0xfd)]='moving_to_grid',_0x117e2c[_0x5b6da9(0x14e)]=0x0,_0x117e2c[_0x5b6da9(0x6b)]=0x0,_0x117e2c['velocityX']=0x0,_0x117e2c[_0x5b6da9(0x17d)]=0x0;_0x117e2c[_0x5b6da9(0xdf)]!==undefined&&squadronCompletionStatus[_0x117e2c[_0x5b6da9(0xdf)]]&&squadronCompletionStatus[_0x117e2c['squadronId']][_0x5b6da9(0xff)]++;break;}if(_0x117e2c&&_0x117e2c[_0x5b6da9(0xfd)]===_0x5b6da9(0xec)){if(isNaN(_0x2e846c)||isNaN(_0x2a139f)){console[_0x5b6da9(0x104)](_0x5b6da9(0xbc)+_0x46aeaf+'.\x20Switching\x20to\x20moving_to_grid.');try{_0x117e2c[_0x5b6da9(0xa9)]=_0x117e2c['targetGridX']??gameCanvas[_0x5b6da9(0x17e)]/0x2,_0x117e2c[_0x5b6da9(0x12e)]=_0x117e2c[_0x5b6da9(0x12e)]??ENEMY_TOP_MARGIN;}catch(_0x3ca4a5){console[_0x5b6da9(0x104)](_0x5b6da9(0x126)+_0x46aeaf+_0x5b6da9(0xea),_0x3ca4a5),_0x117e2c[_0x5b6da9(0xa9)]=gameCanvas[_0x5b6da9(0x17e)]/0x2,_0x117e2c[_0x5b6da9(0x12e)]=ENEMY_TOP_MARGIN;}_0x117e2c['state']='moving_to_grid',_0x117e2c[_0x5b6da9(0x14e)]=0x0,_0x117e2c[_0x5b6da9(0x6b)]=0x0,_0x117e2c[_0x5b6da9(0xce)]=0x0,_0x117e2c[_0x5b6da9(0x17d)]=0x0,_0x117e2c[_0x5b6da9(0xdf)]!==undefined&&squadronCompletionStatus[_0x117e2c[_0x5b6da9(0xdf)]]&&squadronCompletionStatus[_0x117e2c[_0x5b6da9(0xdf)]][_0x5b6da9(0xff)]++;}else{let _0x3aa2a9=_0x2e846c;const _0x532487=currentWavePatternIndex===0x1&&(_0x117e2c[_0x5b6da9(0xdf)]===0x2||_0x117e2c['squadronId']===0x3),_0x3b793e=typeof _0x117e2c['squadronEnemyIndex']===_0x5b6da9(0x102)&&_0x117e2c[_0x5b6da9(0xd4)]%0x2!==0x0;if(_0x532487&&_0x3b793e){const _0x5f2592=_0x292ed4+ENTRANCE_PAIR_HORIZONTAL_GAP;_0x3aa2a9=_0x2e846c+_0x5f2592;}_0x117e2c[_0x5b6da9(0xce)]=_0x3aa2a9-_0x4d7545,_0x117e2c['velocityY']=_0x2a139f-_0x2788ce,_0x117e2c['x']=_0x3aa2a9,_0x117e2c['y']=_0x2a139f;}}break;}case _0x5b6da9(0x181):{if(_0x117e2c['targetGridX']==null||_0x117e2c['targetGridY']==null){console[_0x5b6da9(0x117)](_0x5b6da9(0xaf)+_0x46aeaf+_0x5b6da9(0x6f));try{const {x:_0x1a89c3,y:_0x27c84c}=getCurrentGridSlotPosition(_0x117e2c[_0x5b6da9(0x138)],_0x117e2c['gridCol'],_0x292ed4);_0x117e2c[_0x5b6da9(0xa9)]=_0x1a89c3,_0x117e2c[_0x5b6da9(0x12e)]=_0x27c84c;}catch(_0x1694b2){console[_0x5b6da9(0x104)](_0x5b6da9(0x126)+_0x46aeaf+'\x20in\x20moving_to_grid',_0x1694b2),_0x117e2c['state']=_0x5b6da9(0x14f),_0x117e2c['x']=gameCanvas[_0x5b6da9(0x17e)]/0x2,_0x117e2c['y']=ENEMY_TOP_MARGIN;break;}}const _0x1ce50f=_0x117e2c[_0x5b6da9(0xa9)],_0x2db97c=_0x117e2c[_0x5b6da9(0x12e)],_0x2becf2=_0x1ce50f-_0x117e2c['x'],_0x375a7e=_0x2db97c-_0x117e2c['y'],_0x18e925=Math[_0x5b6da9(0x150)](_0x2becf2*_0x2becf2+_0x375a7e*_0x375a7e),_0x4974a3=ENTRANCE_SPEED*1.2,_0x19cef1=_0x4974a3*0.5;if(_0x18e925>_0x19cef1)_0x117e2c[_0x5b6da9(0xce)]=_0x2becf2/_0x18e925*_0x4974a3,_0x117e2c[_0x5b6da9(0x17d)]=_0x375a7e/_0x18e925*_0x4974a3,_0x117e2c['x']+=_0x117e2c[_0x5b6da9(0xce)],_0x117e2c['y']+=_0x117e2c[_0x5b6da9(0x17d)];else{_0x117e2c['x']=_0x1ce50f,_0x117e2c['y']=_0x2db97c,_0x117e2c['velocityX']=0x0,_0x117e2c[_0x5b6da9(0x17d)]=0x0;const _0xde3654=_0x117e2c['state'];_0x117e2c[_0x5b6da9(0xfd)]='in_grid',_0x117e2c[_0x5b6da9(0x92)]=![];!isGridSoundPlaying&&!isChallengingStage&&(isGridSoundPlaying=!![],playSound(gridBackgroundSound));GRID_BREATH_ENABLED&&!isGridBreathingActive&&!isChallengingStage&&(isGridBreathingActive=!![],gridBreathStartTime=_0x2fa7f3,currentGridBreathFactor=0x0);!firstEnemyLanded&&!isFullGridWave&&!isChallengingStage&&(lastGridFireCheckTime=Date[_0x5b6da9(0x164)](),firstEnemyLanded=!![]);if(_0xde3654===_0x5b6da9(0x181)&&!isChallengingStage&&!isFullGridWave&&_0x117e2c['squadronId']!==undefined){const _0x1cdd4a=_0x117e2c[_0x5b6da9(0xdf)],_0x2e9a58=squadronCompletionStatus[_0x1cdd4a];if(_0x2e9a58&&!_0x2e9a58['hasFiredPostLanding']){const _0xbc58da=enemies[_0x5b6da9(0x13b)](_0x59cd91=>{const _0x2c123c=_0x5b6da9;if(_0x59cd91&&_0x59cd91['squadronId']===_0x1cdd4a)return _0x59cd91['state']==='in_grid'||!enemies[_0x2c123c(0xda)](_0x4978a0=>_0x4978a0['id']===_0x59cd91['id']);return!![];});if(_0xbc58da){_0x2e9a58[_0x5b6da9(0xd5)]=!![];const _0x11be97=enemies[_0x5b6da9(0x8f)](_0x4120e2=>_0x4120e2&&_0x4120e2['squadronId']===_0x1cdd4a&&_0x4120e2['state']===_0x5b6da9(0x14f)&&(_0x4120e2[_0x5b6da9(0x142)]===ENEMY2_TYPE||_0x4120e2[_0x5b6da9(0x142)]===ENEMY3_TYPE)&&!(_0x4120e2[_0x5b6da9(0x142)]===ENEMY3_TYPE&&_0x4120e2[_0x5b6da9(0x77)]));if(_0x11be97[_0x5b6da9(0x140)]>0x0){const _0x444f84=_0x11be97[Math['floor'](Math[_0x5b6da9(0x149)]()*_0x11be97[_0x5b6da9(0x140)])],_0x52d03e=_0x444f84['id'],_0x23b9b3=0xc8+Math['random']()*0x190,_0x3a2c81=setTimeout(()=>{const _0x8ddb60=_0x5b6da9;try{const _0x34acd1=enemySpawnTimeouts[_0x8ddb60(0x12c)](_0x3a2c81);if(_0x34acd1>-0x1)enemySpawnTimeouts[_0x8ddb60(0x76)](_0x34acd1,0x1);if(isPaused||!isInGameState||playerLives<=0x0||isChallengingStage||isWaveTransitioning||isShipCaptured)return;const _0x150766=enemies[_0x8ddb60(0xf2)](_0x518db6=>_0x518db6&&_0x518db6['id']===_0x52d03e);_0x150766&&_0x150766[_0x8ddb60(0xfd)]===_0x8ddb60(0x14f)&&(createBulletSimple(_0x150766)&&(playSound(enemyShootSound),_0x150766[_0x8ddb60(0xa1)]=Date[_0x8ddb60(0x164)]()));}catch(_0x9e22ea){console[_0x8ddb60(0x104)]('Error\x20during\x20post-landing\x20fire\x20for\x20'+_0x52d03e+':',_0x9e22ea);}},_0x23b9b3);enemySpawnTimeouts['push'](_0x3a2c81);}}}}}break;}case _0x5b6da9(0x14f):{try{const _0x5d8149=_0x117e2c[_0x5b6da9(0x142)]===ENEMY3_TYPE?BOSS_WIDTH:_0x117e2c[_0x5b6da9(0x142)]===ENEMY1_TYPE?ENEMY1_WIDTH:ENEMY_WIDTH,{x:_0xc6743d,y:_0x3ef01c}=getCurrentGridSlotPosition(_0x117e2c[_0x5b6da9(0x138)],_0x117e2c[_0x5b6da9(0x8a)],_0x5d8149);typeof _0xc6743d===_0x5b6da9(0x102)&&!isNaN(_0xc6743d)&&(_0x117e2c['x']=_0xc6743d),typeof _0x3ef01c===_0x5b6da9(0x102)&&!isNaN(_0x3ef01c)&&(_0x117e2c['y']=_0x3ef01c),_0x117e2c[_0x5b6da9(0xa9)]=_0xc6743d,_0x117e2c[_0x5b6da9(0x12e)]=_0x3ef01c;}catch(_0xeaa5d8){console['error'](_0x5b6da9(0x70)+_0x117e2c['id']+':',_0xeaa5d8);}_0x117e2c['velocityX']=_0x256c5a?_0x5c3809:0x0,_0x117e2c[_0x5b6da9(0x17d)]=0x0;_0x117e2c['type']===ENEMY3_TYPE&&_0x117e2c[_0x5b6da9(0x77)]&&_0x117e2c[_0x5b6da9(0x99)]&&(_0x117e2c[_0x5b6da9(0xc3)]=_0x117e2c['x']+CAPTURED_SHIP_OFFSET_X,_0x117e2c[_0x5b6da9(0xa3)]=_0x117e2c['y']+CAPTURED_SHIP_OFFSET_Y);break;}case _0x5b6da9(0x130):{_0x117e2c[_0x5b6da9(0xce)]=0x0,_0x117e2c[_0x5b6da9(0x17d)]=0x0;break;}case'preparing_capture':{_0x117e2c[_0x5b6da9(0xce)]=0x0,_0x117e2c[_0x5b6da9(0x17d)]=0x0;break;}case'diving_to_capture_position':{if(isShipCaptured){_0x117e2c[_0x5b6da9(0xfd)]='returning';try{const {x:_0xa1513d,y:_0x3d29f4}=getCurrentGridSlotPosition(_0x117e2c['gridRow'],_0x117e2c[_0x5b6da9(0x8a)],_0x292ed4);_0x117e2c['targetGridX']=_0xa1513d,_0x117e2c[_0x5b6da9(0x12e)]=_0x3d29f4;}catch(_0x34fb8d){console[_0x5b6da9(0x104)](_0x5b6da9(0x90)+_0x117e2c['id']+':',_0x34fb8d),_0x117e2c['targetGridX']=gameCanvas[_0x5b6da9(0x17e)]/0x2,_0x117e2c['targetGridY']=ENEMY_TOP_MARGIN;}break;}const _0x2b40cc=_0x117e2c[_0x5b6da9(0x169)],_0x225cb1=_0x117e2c[_0x5b6da9(0xf7)];if(_0x2b40cc==null||_0x225cb1==null){console[_0x5b6da9(0x104)]('Boss\x20'+_0x117e2c['id']+'\x20diving\x20to\x20capture\x20without\x20targetX/Y!\x20Aborting.'),_0x117e2c[_0x5b6da9(0xfd)]=_0x5b6da9(0xa4);try{const {x:_0x21341b,y:_0x1df1dd}=getCurrentGridSlotPosition(_0x117e2c[_0x5b6da9(0x138)],_0x117e2c[_0x5b6da9(0x8a)],_0x292ed4);_0x117e2c['targetGridX']=_0x21341b,_0x117e2c[_0x5b6da9(0x12e)]=_0x1df1dd;}catch(_0x3736f1){console['error'](_0x5b6da9(0x90)+_0x117e2c['id']+':',_0x3736f1),_0x117e2c[_0x5b6da9(0xa9)]=gameCanvas['width']/0x2,_0x117e2c[_0x5b6da9(0x12e)]=ENEMY_TOP_MARGIN;}break;}const _0x48c759=_0x2b40cc-_0x117e2c['x'],_0x162543=_0x225cb1-_0x117e2c['y'],_0x41ab61=Math[_0x5b6da9(0x150)](_0x48c759*_0x48c759+_0x162543*_0x162543),_0x58cd3e=BOSS_CAPTURE_DIVE_SPEED_FACTOR*BASE_ENEMY_ATTACK_SPEED,_0x3125b7=_0x58cd3e*0.6;_0x41ab61>_0x3125b7?(_0x117e2c[_0x5b6da9(0xce)]=_0x48c759/_0x41ab61*_0x58cd3e,_0x117e2c['velocityY']=_0x162543/_0x41ab61*_0x58cd3e,_0x117e2c['x']+=_0x117e2c[_0x5b6da9(0xce)],_0x117e2c['y']+=_0x117e2c['velocityY']):(_0x117e2c['x']=_0x2b40cc,_0x117e2c['y']=_0x225cb1,_0x117e2c[_0x5b6da9(0xce)]=0x0,_0x117e2c[_0x5b6da9(0x17d)]=0x0,_0x117e2c[_0x5b6da9(0xfd)]='capturing',_0x117e2c[_0x5b6da9(0xc6)]=_0x2fa7f3,capturingBossId=_0x117e2c['id'],captureBeamActive=!![],captureBeamSource={'x':_0x117e2c['x']+_0x292ed4/0x2,'y':_0x117e2c['y']+_0x56cbf1},captureBeamTargetY=_0x117e2c['y'],captureBeamProgress=0x0,playSound(captureSound));break;}case _0x5b6da9(0x71):{_0x117e2c[_0x5b6da9(0xce)]=0x0,_0x117e2c[_0x5b6da9(0x17d)]=0x0;if(isShipCaptured&&_0x117e2c['id']!==capturedBossIdWithMessage){console[_0x5b6da9(0x117)](_0x5b6da9(0xf0)+_0x117e2c['id']+_0x5b6da9(0x82)+capturedBossIdWithMessage+_0x5b6da9(0xe0)),captureBeamActive=![];if(capturingBossId===_0x117e2c['id'])capturingBossId=null;_0x117e2c[_0x5b6da9(0xfd)]=_0x5b6da9(0xa4);try{const {x:_0x3008b3,y:_0x4a8ef3}=getCurrentGridSlotPosition(_0x117e2c[_0x5b6da9(0x138)],_0x117e2c[_0x5b6da9(0x8a)],_0x292ed4);_0x117e2c['targetGridX']=_0x3008b3,_0x117e2c['targetGridY']=_0x4a8ef3;}catch(_0x16c0cb){console[_0x5b6da9(0x104)](_0x5b6da9(0x90)+_0x117e2c['id']+':',_0x16c0cb),_0x117e2c[_0x5b6da9(0xa9)]=gameCanvas[_0x5b6da9(0x17e)]/0x2,_0x117e2c['targetGridY']=ENEMY_TOP_MARGIN;}stopSound(captureSound);break;}const _0x3498d0=_0x2fa7f3-_0x117e2c[_0x5b6da9(0xc6)],_0x1929c7=CAPTURE_BEAM_ANIMATION_DURATION_MS/0x2,_0x4e374b=CAPTURE_BEAM_DURATION_MS;if(_0x3498d0<_0x1929c7)captureBeamProgress=_0x3498d0/_0x1929c7;else{if(_0x3498d0<_0x4e374b-_0x1929c7)captureBeamProgress=0x1;else{if(_0x3498d0<_0x4e374b)captureBeamProgress=0x1-(_0x3498d0-(_0x4e374b-_0x1929c7))/_0x1929c7;else{captureBeamProgress=0x0,captureBeamActive=![],capturingBossId=null,stopSound(captureSound),_0x117e2c[_0x5b6da9(0xfd)]='attacking',_0x117e2c[_0x5b6da9(0x106)]=generateAttackPath(_0x117e2c),_0x117e2c[_0x5b6da9(0x168)]=0x0,_0x117e2c[_0x5b6da9(0x74)]=0x0,_0x117e2c[_0x5b6da9(0x188)]=BASE_ENEMY_ATTACK_SPEED*ENEMY3_ATTACK_SPEED_FACTOR,_0x117e2c[_0x5b6da9(0xa1)]=0x0,_0x117e2c[_0x5b6da9(0x11a)]=!![],_0x117e2c['attackFormationOffsetX']=0x0,_0x117e2c[_0x5b6da9(0x174)]=null;break;}}}captureBeamProgress=Math['max'](0x0,Math[_0x5b6da9(0xfa)](0x1,captureBeamProgress));if(ship&&captureBeamActive&&captureBeamProgress>=0.95&&!isShipCaptured&&!isInvincible){const _0x346ecd=BOSS_WIDTH*CAPTURE_BEAM_WIDTH_TOP_FACTOR,_0x274960=SHIP_WIDTH*CAPTURE_BEAM_WIDTH_BOTTOM_FACTOR,_0x15578e=_0x117e2c['x']+_0x292ed4/0x2,_0x41a11f=_0x117e2c['y']+_0x56cbf1,_0x4ccdda=gameCanvas[_0x5b6da9(0x166)]-LIFE_ICON_MARGIN_BOTTOM-LIFE_ICON_SIZE-0xa,_0x39a904=Math[_0x5b6da9(0x182)](_0x346ecd,_0x274960),_0x781492=_0x15578e-_0x39a904/0x2,_0x28976a=_0x41a11f,_0x4b2927=_0x4ccdda-_0x41a11f;if(_0x4b2927>0x0){const _0x863e5d={'x':_0x781492,'y':_0x28976a,'width':_0x39a904,'height':_0x4b2927},_0x114b92={'x':ship['x'],'y':ship['y'],'width':ship['width'],'height':ship[_0x5b6da9(0x166)]};if(checkCollision(_0x114b92,_0x863e5d)){isShipCaptured=!![],_0x117e2c[_0x5b6da9(0x99)]={'width':ship[_0x5b6da9(0x17e)],'height':ship[_0x5b6da9(0x166)]},_0x117e2c['hasCapturedShip']=!![],stopSound(captureSound),_0x117e2c[_0x5b6da9(0xfd)]='showing_capture_message',_0x117e2c['targetGridX']=null,_0x117e2c['targetGridY']=null,_0x117e2c[_0x5b6da9(0x160)]=ship['y'],_0x117e2c[_0x5b6da9(0x80)]=0x0,isShowingCaptureMessage=!![],captureMessageStartTime=_0x2fa7f3,capturedBossIdWithMessage=_0x117e2c['id'],playSound(shipCapturedSound);const _0x60e36=currentPlayer;playerLives--,csCurrentChainHits=0x0,csCurrentChainScore=0x0,csLastHitTime=0x0,csLastChainHitPosition=null,normalWaveCurrentChainHits=0x0,normalWaveCurrentChainScore=0x0,normalWaveLastHitTime=0x0,normalWaveLastChainHitPosition=null,leftPressed=![],rightPressed=![],shootPressed=![],p2LeftPressed=![],p2RightPressed=![],p2ShootPressed=![],p1JustFiredSingle=![],p2JustFiredSingle=![],p1FireInputWasDown=![],p2FireInputWasDown=![];if(playerLives<=0x0){if(_0x60e36===0x1)player1Lives=0x0;if(_0x60e36===0x2)player2Lives=0x0;if(isTwoPlayerMode){isShowingPlayerGameOverMessage=!![],playerGameOverMessageStartTime=_0x2fa7f3,playerWhoIsGameOver=_0x60e36;const _0x345d17=_0x60e36===0x1?0x2:0x1,_0x43ede5=_0x345d17===0x1?player1Lives:player2Lives;_0x43ede5>0x0?nextActionAfterPlayerGameOver=_0x5b6da9(0x12b):nextActionAfterPlayerGameOver=_0x5b6da9(0x132);bullets=[],enemyBullets=[],explosions=[],fallingShips=[],isDualShipActive=![];if(_0x60e36===0x1)player1IsDualShipActive=![];else player2IsDualShipActive=![];playSound(gameOverSound);}else triggerFinalGameOverSequence();break;}else{if(isTwoPlayerMode){if(_0x60e36===0x1)player1Lives=playerLives;else player2Lives=playerLives;}ship&&gameCanvas&&(ship['y']=gameCanvas[_0x5b6da9(0x166)]-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN,!isManualControl&&(aiNeedsStabilization=!![])),(!isManualControl||isTwoPlayerMode)&&(forceCenterShipNextReset=!![]),isShipCaptured=![],isInvincible=!![],invincibilityEndTime=_0x2fa7f3+INVINCIBILITY_DURATION_MS;}}}else console['warn']('Beam\x20collision\x20box\x20has\x20invalid\x20height:',_0x4b2927);}break;}case _0x5b6da9(0x100):{_0x117e2c[_0x5b6da9(0xce)]=0x0,_0x117e2c[_0x5b6da9(0x17d)]=0x0;if(_0x117e2c[_0x5b6da9(0x77)]&&_0x117e2c[_0x5b6da9(0x99)]&&typeof _0x117e2c[_0x5b6da9(0x160)]===_0x5b6da9(0x102)){const _0x3674f0=_0x2fa7f3-captureMessageStartTime,_0x101f23=Math[_0x5b6da9(0xfa)](0x1,_0x3674f0/CAPTURE_MESSAGE_DURATION),_0x1bb738=_0x117e2c['y']+CAPTURED_SHIP_OFFSET_Y,_0xf79313=_0x117e2c[_0x5b6da9(0x160)];_0x117e2c[_0x5b6da9(0xa3)]=_0xf79313+(_0x1bb738-_0xf79313)*_0x101f23,_0x117e2c[_0x5b6da9(0xc3)]=_0x117e2c['x']+CAPTURED_SHIP_OFFSET_X;}else _0x117e2c['capturedShipX']=_0x117e2c['x']+CAPTURED_SHIP_OFFSET_X,_0x117e2c[_0x5b6da9(0xa3)]=_0x117e2c['y']+CAPTURED_SHIP_OFFSET_Y;break;}case'attacking':{if(isEntrancePhaseActive)break;const _0x130a07=_0x117e2c[_0x5b6da9(0x106)],_0x524a95=3.8;if(!_0x130a07||_0x130a07[_0x5b6da9(0x140)]===0x0){console['error'](_0x5b6da9(0xaf)+_0x46aeaf+_0x5b6da9(0x143)),_0x117e2c[_0x5b6da9(0xfd)]=_0x5b6da9(0xa4);try{const {x:_0x2516ea,y:_0x4d6422}=getCurrentGridSlotPosition(_0x117e2c[_0x5b6da9(0x138)],_0x117e2c['gridCol'],_0x292ed4);_0x117e2c['targetGridX']=_0x2516ea,_0x117e2c[_0x5b6da9(0x12e)]=_0x4d6422;}catch(_0x1dfdb2){console[_0x5b6da9(0x104)]('Error\x20getting\x20grid\x20pos\x20for\x20returning\x20enemy\x20'+_0x46aeaf+_0x5b6da9(0x116),_0x1dfdb2),_0x117e2c['targetGridX']=gameCanvas['width']/0x2,_0x117e2c[_0x5b6da9(0x12e)]=ENEMY_TOP_MARGIN;}break;}if(_0x117e2c['attackPathSegmentIndex']>=_0x130a07[_0x5b6da9(0x140)]){console['warn'](_0x5b6da9(0xaf)+_0x46aeaf+_0x5b6da9(0x14d)+_0x117e2c[_0x5b6da9(0x168)]+_0x5b6da9(0x135)+_0x130a07[_0x5b6da9(0x140)]+_0x5b6da9(0x136)),_0x117e2c[_0x5b6da9(0xfd)]=_0x5b6da9(0xa4);try{const {x:_0x39dcd4,y:_0x2484c9}=getCurrentGridSlotPosition(_0x117e2c['gridRow'],_0x117e2c['gridCol'],_0x292ed4);_0x117e2c[_0x5b6da9(0xa9)]=_0x39dcd4,_0x117e2c[_0x5b6da9(0x12e)]=_0x2484c9;}catch(_0x148bcf){console[_0x5b6da9(0x104)](_0x5b6da9(0x177)+_0x46aeaf+'\x20(invalid\x20attack\x20index):',_0x148bcf),_0x117e2c['targetGridX']=gameCanvas[_0x5b6da9(0x17e)]/0x2,_0x117e2c['targetGridY']=ENEMY_TOP_MARGIN;}break;}const _0x52a25a=_0x130a07[_0x117e2c[_0x5b6da9(0x168)]];if(!_0x52a25a||!_0x52a25a['p0']||!_0x52a25a['p1']||!_0x52a25a['p2']||!_0x52a25a['p3']){console[_0x5b6da9(0x104)](_0x5b6da9(0xaf)+_0x46aeaf+'\x20attacking,\x20invalid\x20segment\x20'+_0x117e2c[_0x5b6da9(0x168)]+_0x5b6da9(0x163)),_0x117e2c['state']='returning';try{const {x:_0x5ea04a,y:_0x5ceea8}=getCurrentGridSlotPosition(_0x117e2c[_0x5b6da9(0x138)],_0x117e2c[_0x5b6da9(0x8a)],_0x292ed4);_0x117e2c[_0x5b6da9(0xa9)]=_0x5ea04a,_0x117e2c[_0x5b6da9(0x12e)]=_0x5ceea8;}catch(_0x86fd2c){console[_0x5b6da9(0x104)]('Error\x20getting\x20grid\x20pos\x20for\x20returning\x20enemy\x20'+_0x46aeaf+_0x5b6da9(0x134),_0x86fd2c),_0x117e2c[_0x5b6da9(0xa9)]=gameCanvas[_0x5b6da9(0x17e)]/0x2,_0x117e2c[_0x5b6da9(0x12e)]=ENEMY_TOP_MARGIN;}break;}const _0x3d8ee0=_0x117e2c[_0x5b6da9(0x188)]/0x3e8*_0x524a95;_0x117e2c[_0x5b6da9(0x74)]+=_0x3d8ee0;let _0xc709af,_0x3c07ec;const _0x309ce6=_0x117e2c['x'],_0x498743=_0x117e2c['y'];if(_0x117e2c['attackPathT']>=0x1){try{_0xc709af=calculateBezierPoint(0x1,_0x52a25a['p0']['x'],_0x52a25a['p1']['x'],_0x52a25a['p2']['x'],_0x52a25a['p3']['x']),_0x3c07ec=calculateBezierPoint(0x1,_0x52a25a['p0']['y'],_0x52a25a['p1']['y'],_0x52a25a['p2']['y'],_0x52a25a['p3']['y']);}catch(_0x386bee){console[_0x5b6da9(0x104)](_0x5b6da9(0x14a)+_0x117e2c['id']+':',_0x386bee),_0xc709af=_0x117e2c['x'],_0x3c07ec=_0x117e2c['y'],_0x117e2c['state']=_0x5b6da9(0xa4);try{const {x:_0xa70823,y:_0x36ebc3}=getCurrentGridSlotPosition(_0x117e2c[_0x5b6da9(0x138)],_0x117e2c[_0x5b6da9(0x8a)],_0x292ed4);_0x117e2c[_0x5b6da9(0xa9)]=_0xa70823,_0x117e2c['targetGridY']=_0x36ebc3;}catch(_0x4ce811){console[_0x5b6da9(0x104)]('Error\x20getting\x20grid\x20pos\x20after\x20FINAL\x20bezier\x20error\x20for\x20'+_0x117e2c['id']+':',_0x4ce811),_0x117e2c['targetGridX']=gameCanvas[_0x5b6da9(0x17e)]/0x2,_0x117e2c['targetGridY']=ENEMY_TOP_MARGIN;}break;}_0x117e2c[_0x5b6da9(0x74)]=0x0,_0x117e2c[_0x5b6da9(0x168)]++;if(_0x117e2c[_0x5b6da9(0x168)]>=_0x130a07['length']){_0x117e2c[_0x5b6da9(0xfd)]=_0x5b6da9(0xa4),_0x117e2c[_0x5b6da9(0xa1)]=0x0,_0x117e2c[_0x5b6da9(0x148)]=0x0,_0x117e2c[_0x5b6da9(0x174)]=null;try{const {x:_0x5a820d,y:_0x5e4909}=getCurrentGridSlotPosition(_0x117e2c['gridRow'],_0x117e2c[_0x5b6da9(0x8a)],_0x292ed4);_0x117e2c[_0x5b6da9(0xa9)]=_0x5a820d,_0x117e2c[_0x5b6da9(0x12e)]=_0x5e4909;}catch(_0x55f8bf){console[_0x5b6da9(0x104)](_0x5b6da9(0x177)+_0x46aeaf+_0x5b6da9(0x189),_0x55f8bf),_0x117e2c['targetGridX']=gameCanvas[_0x5b6da9(0x17e)]/0x2,_0x117e2c[_0x5b6da9(0x12e)]=ENEMY_TOP_MARGIN;}}else{const _0x35e2e7=_0x130a07[_0x117e2c[_0x5b6da9(0x168)]];if(!_0x35e2e7?.['p0']){console['error'](_0x5b6da9(0xaf)+_0x46aeaf+_0x5b6da9(0x10f)+_0x117e2c[_0x5b6da9(0x168)]+'!\x20Returning.'),_0xc709af=_0x117e2c['x'],_0x3c07ec=_0x117e2c['y'],_0x117e2c[_0x5b6da9(0xfd)]=_0x5b6da9(0xa4);try{const {x:_0x54fab6,y:_0x5827c2}=getCurrentGridSlotPosition(_0x117e2c[_0x5b6da9(0x138)],_0x117e2c[_0x5b6da9(0x8a)],_0x292ed4);_0x117e2c['targetGridX']=_0x54fab6,_0x117e2c['targetGridY']=_0x5827c2;}catch(_0x44d76e){console[_0x5b6da9(0x104)]('Error\x20getting\x20grid\x20pos\x20after\x20invalid\x20NEXT\x20attack\x20segment\x20for\x20'+_0x117e2c['id']+':',_0x44d76e),_0x117e2c[_0x5b6da9(0xa9)]=gameCanvas[_0x5b6da9(0x17e)]/0x2,_0x117e2c['targetGridY']=ENEMY_TOP_MARGIN;}break;}}}else try{_0xc709af=calculateBezierPoint(_0x117e2c[_0x5b6da9(0x74)],_0x52a25a['p0']['x'],_0x52a25a['p1']['x'],_0x52a25a['p2']['x'],_0x52a25a['p3']['x']),_0x3c07ec=calculateBezierPoint(_0x117e2c[_0x5b6da9(0x74)],_0x52a25a['p0']['y'],_0x52a25a['p1']['y'],_0x52a25a['p2']['y'],_0x52a25a['p3']['y']);}catch(_0x1211a6){console[_0x5b6da9(0x104)](_0x5b6da9(0x129)+_0x117e2c['id']+':',_0x1211a6),_0xc709af=_0x117e2c['x'],_0x3c07ec=_0x117e2c['y'],_0x117e2c['state']='returning';try{const {x:_0x17852a,y:_0x4ca07d}=getCurrentGridSlotPosition(_0x117e2c[_0x5b6da9(0x138)],_0x117e2c['gridCol'],_0x292ed4);_0x117e2c[_0x5b6da9(0xa9)]=_0x17852a,_0x117e2c[_0x5b6da9(0x12e)]=_0x4ca07d;}catch(_0x4598d1){console['error']('Error\x20getting\x20grid\x20pos\x20after\x20bezier\x20error\x20for\x20'+_0x117e2c['id']+':',_0x4598d1),_0x117e2c[_0x5b6da9(0xa9)]=gameCanvas[_0x5b6da9(0x17e)]/0x2,_0x117e2c[_0x5b6da9(0x12e)]=ENEMY_TOP_MARGIN;}break;}if(_0x117e2c&&_0x117e2c[_0x5b6da9(0xfd)]===_0x5b6da9(0xd1)){const _0x39b361=_0x117e2c[_0x5b6da9(0x148)]||0x0,_0x25d456=_0xc709af+_0x39b361,_0x45eaee=_0x3c07ec;_0x117e2c[_0x5b6da9(0xce)]=_0x25d456-_0x309ce6,_0x117e2c[_0x5b6da9(0x17d)]=_0x45eaee-_0x498743,_0x117e2c['x']=_0x25d456,_0x117e2c['y']=_0x45eaee;if(_0x117e2c['y']>gameCanvas[_0x5b6da9(0x166)]+_0x56cbf1*1.5){_0x117e2c['state']=_0x5b6da9(0xa4),_0x117e2c[_0x5b6da9(0x168)]=0x0,_0x117e2c[_0x5b6da9(0x74)]=0x0,_0x117e2c[_0x5b6da9(0xa1)]=0x0,_0x117e2c[_0x5b6da9(0x148)]=0x0,_0x117e2c[_0x5b6da9(0x174)]=null,_0x117e2c['y']=-_0x56cbf1*(1.1+Math[_0x5b6da9(0x149)]()*0.4),_0x117e2c['x']=Math[_0x5b6da9(0x149)]()*(gameCanvas[_0x5b6da9(0x17e)]-_0x292ed4),_0x117e2c[_0x5b6da9(0xce)]=0x0,_0x117e2c['velocityY']=0x0;try{const {x:_0x511e39,y:_0x551902}=getCurrentGridSlotPosition(_0x117e2c[_0x5b6da9(0x138)],_0x117e2c[_0x5b6da9(0x8a)],_0x292ed4);_0x117e2c[_0x5b6da9(0xa9)]=_0x511e39,_0x117e2c[_0x5b6da9(0x12e)]=_0x551902;}catch(_0x519a7f){console[_0x5b6da9(0x104)]('Error\x20getting\x20grid\x20pos\x20for\x20returning\x20enemy\x20'+_0x46aeaf+'\x20off\x20screen:',_0x519a7f),_0x117e2c['targetGridX']=gameCanvas['width']/0x2,_0x117e2c[_0x5b6da9(0x12e)]=ENEMY_TOP_MARGIN;}}}break;}case _0x5b6da9(0xa4):{if(isEntrancePhaseActive)break;if(_0x117e2c['targetGridX']==null||_0x117e2c[_0x5b6da9(0x12e)]==null){console['warn'](_0x5b6da9(0xaf)+_0x46aeaf+'\x20returning\x20without\x20target\x20coords.\x20Recalculating.');try{const {x:_0x335baf,y:_0x5d397d}=getCurrentGridSlotPosition(_0x117e2c[_0x5b6da9(0x138)],_0x117e2c[_0x5b6da9(0x8a)],_0x292ed4);_0x117e2c['targetGridX']=_0x335baf,_0x117e2c[_0x5b6da9(0x12e)]=_0x5d397d;}catch(_0x1eedbe){console[_0x5b6da9(0x104)]('Error\x20getting\x20grid\x20pos\x20for\x20'+_0x46aeaf+_0x5b6da9(0x184),_0x1eedbe),_0x117e2c[_0x5b6da9(0xfd)]='in_grid',_0x117e2c['x']=gameCanvas[_0x5b6da9(0x17e)]/0x2,_0x117e2c['y']=ENEMY_TOP_MARGIN;break;}}const _0x3d0ba7=_0x117e2c['targetGridX'],_0x4508ec=_0x117e2c[_0x5b6da9(0x12e)],_0x511f0f=_0x3d0ba7-_0x117e2c['x'],_0x259345=_0x4508ec-_0x117e2c['y'],_0x25a197=Math[_0x5b6da9(0x150)](_0x511f0f*_0x511f0f+_0x259345*_0x259345),_0x4e33bd=scaleValue(level,BASE_RETURN_SPEED_FACTOR,MAX_RETURN_SPEED_FACTOR),_0x3f5857=BASE_RETURN_SPEED*_0x4e33bd,_0x3bad83=_0x3f5857*0.5;_0x25a197>_0x3bad83?(_0x117e2c['velocityX']=_0x511f0f/_0x25a197*_0x3f5857,_0x117e2c['velocityY']=_0x259345/_0x25a197*_0x3f5857,_0x117e2c['x']+=_0x117e2c[_0x5b6da9(0xce)],_0x117e2c['y']+=_0x117e2c[_0x5b6da9(0x17d)]):(_0x117e2c['x']=_0x3d0ba7,_0x117e2c['y']=_0x4508ec,_0x117e2c[_0x5b6da9(0xce)]=0x0,_0x117e2c[_0x5b6da9(0x17d)]=0x0,_0x117e2c[_0x5b6da9(0xfd)]=_0x5b6da9(0x14f),_0x117e2c[_0x5b6da9(0x92)]=!![],_0x117e2c['attackFormationOffsetX']=0x0,_0x117e2c['attackGroupId']=null,_0x117e2c[_0x5b6da9(0xe2)](_0x5b6da9(0xab))&&delete _0x117e2c['returnLogDone'],!isGridSoundPlaying&&!isChallengingStage&&(isGridSoundPlaying=!![],playSound(gridBackgroundSound)));break;}}if(_0x117e2c&&!isShowingPlayerGameOverMessage&&!(isShipCaptured&&_0x117e2c[_0x5b6da9(0xfd)]===_0x5b6da9(0x71))){const _0x4a3de3={'x':0x0,'y':0x0,'width':PLAYER_BULLET_WIDTH,'height':PLAYER_BULLET_HEIGHT},_0x5c97e3={'x':_0x117e2c['x'],'y':_0x117e2c['y'],'width':_0x292ed4,'height':_0x56cbf1};for(let _0x37473c=bullets['length']-0x1;_0x37473c>=0x0;_0x37473c--){const _0x19f6d3=bullets[_0x37473c];if(!_0x19f6d3)continue;_0x4a3de3['x']=_0x19f6d3['x'],_0x4a3de3['y']=_0x19f6d3['y'];if(checkCollision(_0x4a3de3,_0x5c97e3)){const _0x45b3e5=handleEnemyHit(_0x117e2c);bullets['splice'](_0x37473c,0x1);if(_0x45b3e5['destroyed']){enemies['splice'](_0x3d41dd,0x1),_0x117e2c=null;break;}}}}if(_0x117e2c&&ship&&!isShipCaptured&&!isWaitingForRespawn&&!isShowingPlayerGameOverMessage&&!isInvincible){const _0x3fcb53=[_0x5b6da9(0xd1),_0x5b6da9(0xec),_0x5b6da9(0x9f),'diving_to_capture_position'];if(_0x3fcb53[_0x5b6da9(0xf6)](_0x117e2c['state'])){const _0x13d144={'x':_0x117e2c['x'],'y':_0x117e2c['y'],'width':_0x292ed4,'height':_0x56cbf1},_0x3ab9e0={'x':ship['x'],'y':ship['y'],'width':ship['width'],'height':ship[_0x5b6da9(0x166)]},_0xd9fb94=isDualShipActive?{'x':ship['x']+DUAL_SHIP_OFFSET_X,'y':ship['y'],'width':ship[_0x5b6da9(0x17e)],'height':ship[_0x5b6da9(0x166)]}:null;let _0x2eacd0=![],_0x2e00d6=![];if(checkCollision(_0x13d144,_0x3ab9e0))_0x2eacd0=!![],_0x2e00d6=![];else _0xd9fb94&&checkCollision(_0x13d144,_0xd9fb94)&&(_0x2eacd0=!![],_0x2e00d6=!![]);if(_0x2eacd0){createExplosion(_0x117e2c['x']+_0x292ed4/0x2,_0x117e2c['y']+_0x56cbf1/0x2),playSound(lostLifeSound),enemies[_0x5b6da9(0x76)](_0x3d41dd,0x1),_0x117e2c=null;if(isDualShipActive){isDualShipActive=![];if(currentPlayer===0x1)player1IsDualShipActive=![];else player2IsDualShipActive=![];_0x2e00d6?createExplosion(_0xd9fb94['x']+ship['width']/0x2,_0xd9fb94['y']+ship['height']/0x2):createExplosion(_0x3ab9e0['x']+ship[_0x5b6da9(0x17e)]/0x2,_0x3ab9e0['y']+ship['height']/0x2),isInvincible=!![],invincibilityEndTime=_0x2fa7f3+INVINCIBILITY_DURATION_MS;}else{playerLives--,csCurrentChainHits=0x0,csCurrentChainScore=0x0,csLastHitTime=0x0,csLastChainHitPosition=null,normalWaveCurrentChainHits=0x0,normalWaveCurrentChainScore=0x0,normalWaveLastHitTime=0x0,normalWaveLastChainHitPosition=null,leftPressed=![],rightPressed=![],shootPressed=![],p2LeftPressed=![],p2RightPressed=![],p2ShootPressed=![],p1JustFiredSingle=![],p2JustFiredSingle=![],p1FireInputWasDown=![],p2FireInputWasDown=![],fallingShips=[],isInvincible=!![],invincibilityEndTime=_0x2fa7f3+INVINCIBILITY_DURATION_MS;ship&&gameCanvas?(ship['y']=gameCanvas[_0x5b6da9(0x166)]-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN,!isManualControl&&(aiNeedsStabilization=!![])):console[_0x5b6da9(0x104)]('Cannot\x20reposition\x20ship\x20Y\x20-\x20ship\x20or\x20canvas\x20not\x20ready.');if(playerLives<=0x0){const _0x452a05=currentPlayer;if(_0x452a05===0x1)player1Lives=0x0;if(_0x452a05===0x2)player2Lives=0x0;if(isTwoPlayerMode){isShowingPlayerGameOverMessage=!![],playerGameOverMessageStartTime=_0x2fa7f3,playerWhoIsGameOver=_0x452a05;const _0x123e4f=_0x452a05===0x1?0x2:0x1,_0x5924e6=_0x123e4f===0x1?player1Lives:player2Lives;_0x5924e6>0x0?nextActionAfterPlayerGameOver=_0x5b6da9(0x12b):nextActionAfterPlayerGameOver=_0x5b6da9(0x132),bullets=[],enemyBullets=[],explosions=[],playSound(gameOverSound);}else triggerFinalGameOverSequence();break;}else{if(isTwoPlayerMode){if(currentPlayer===0x1)player1Lives=playerLives;else player2Lives=playerLives;}break;}}}}}}if(ship&&!isShowingPlayerGameOverMessage&&!isShipCaptured&&!isWaitingForRespawn&&!isInvincible){const _0x202964={'x':ship['x'],'y':ship['y'],'width':ship['width'],'height':ship[_0x5b6da9(0x166)]},_0x452098=isDualShipActive?{'x':ship['x']+DUAL_SHIP_OFFSET_X,'y':ship['y'],'width':ship[_0x5b6da9(0x17e)],'height':ship['height']}:null;for(let _0x415bae=enemyBullets[_0x5b6da9(0x140)]-0x1;_0x415bae>=0x0;_0x415bae--){const _0x1e8030=enemyBullets[_0x415bae];if(!_0x1e8030){enemyBullets['splice'](_0x415bae,0x1);continue;}const _0x1ccecb={'x':_0x1e8030['x'],'y':_0x1e8030['y'],'width':_0x1e8030[_0x5b6da9(0x17e)],'height':_0x1e8030[_0x5b6da9(0x166)]};let _0x5146e8=checkCollision(_0x202964,_0x1ccecb),_0x296844=0x0;!_0x5146e8&&_0x452098&&checkCollision(_0x452098,_0x1ccecb)&&(_0x5146e8=!![],_0x296844=0x1);if(_0x5146e8){enemyBullets['splice'](_0x415bae,0x1);if(isDualShipActive){isDualShipActive=![];if(currentPlayer===0x1)player1IsDualShipActive=![];else player2IsDualShipActive=![];_0x296844===0x1?createExplosion(_0x452098['x']+ship[_0x5b6da9(0x17e)]/0x2,_0x452098['y']+ship['height']/0x2):createExplosion(_0x202964['x']+ship['width']/0x2,_0x202964['y']+ship[_0x5b6da9(0x166)]/0x2),playSound(lostLifeSound),isInvincible=!![],invincibilityEndTime=_0x2fa7f3+INVINCIBILITY_DURATION_MS;}else{playerLives--,playSound(lostLifeSound),createExplosion(ship['x']+ship['width']/0x2,ship['y']+ship[_0x5b6da9(0x166)]/0x2),csCurrentChainHits=0x0,csCurrentChainScore=0x0,csLastHitTime=0x0,csLastChainHitPosition=null,normalWaveCurrentChainHits=0x0,normalWaveCurrentChainScore=0x0,normalWaveLastHitTime=0x0,normalWaveLastChainHitPosition=null,leftPressed=![],rightPressed=![],shootPressed=![],p2LeftPressed=![],p2RightPressed=![],p2ShootPressed=![],p1JustFiredSingle=![],p2JustFiredSingle=![],p1FireInputWasDown=![],p2FireInputWasDown=![],fallingShips=[],isInvincible=!![],invincibilityEndTime=_0x2fa7f3+INVINCIBILITY_DURATION_MS;ship&&gameCanvas?(ship['y']=gameCanvas[_0x5b6da9(0x166)]-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN,!isManualControl&&(aiNeedsStabilization=!![])):console[_0x5b6da9(0x104)]('Cannot\x20reposition\x20ship\x20Y\x20-\x20ship\x20or\x20canvas\x20not\x20ready.');if(playerLives<=0x0){const _0x17fbfc=currentPlayer;if(_0x17fbfc===0x1)player1Lives=0x0;if(_0x17fbfc===0x2)player2Lives=0x0;if(isTwoPlayerMode){isShowingPlayerGameOverMessage=!![],playerGameOverMessageStartTime=_0x2fa7f3,playerWhoIsGameOver=_0x17fbfc;const _0x57b796=_0x17fbfc===0x1?0x2:0x1,_0x890f05=_0x57b796===0x1?player1Lives:player2Lives;_0x890f05>0x0?nextActionAfterPlayerGameOver=_0x5b6da9(0x12b):nextActionAfterPlayerGameOver='show_results',bullets=[],enemyBullets=[],explosions=[],playSound(gameOverSound);}else triggerFinalGameOverSequence();break;}else{if(isTwoPlayerMode){if(currentPlayer===0x1)player1Lives=playerLives;else player2Lives=playerLives;}break;}}}}}if(ship&&!isShipCaptured&&!isWaitingForRespawn&&!isDualShipActive&&fallingShips[_0x5b6da9(0x140)]>0x0&&!isInvincible){const _0x791619={'x':ship['x'],'y':ship['y'],'width':ship[_0x5b6da9(0x17e)],'height':ship[_0x5b6da9(0x166)]};for(let _0x1d6d0a=fallingShips[_0x5b6da9(0x140)]-0x1;_0x1d6d0a>=0x0;_0x1d6d0a--){const _0x5c553a=fallingShips[_0x1d6d0a];if(!_0x5c553a)continue;const _0x4495bf={'x':_0x5c553a['x'],'y':_0x5c553a['y'],'width':_0x5c553a['width'],'height':_0x5c553a['height']};if(checkCollision(_0x791619,_0x4495bf)){fallingShips[_0x5b6da9(0x76)](_0x1d6d0a,0x1),isDualShipActive=!![];if(currentPlayer===0x1)player1IsDualShipActive=!![];else player2IsDualShipActive=!![];playSound(dualShipSound);break;}}}updateHitSparks();}catch(_0x5a6e42){console[_0x5b6da9(0x104)](_0x5b6da9(0x11f),_0x5a6e42,_0x5a6e42[_0x5b6da9(0x9e)]),isGridSoundPlaying=![],stopSound(gridBackgroundSound),isEntrancePhaseActive=![],stopSound(entranceSound),isShowingPlayerGameOverMessage=![],playerGameOverMessageStartTime=0x0,playerWhoIsGameOver=0x0,nextActionAfterPlayerGameOver='',isShipCaptured=![],captureBeamActive=![],capturingBossId=null,stopSound(captureSound),stopSound(shipCapturedSound),isWaitingForRespawn=![],fallingShips=[],isDualShipActive=![],player1IsDualShipActive=![],player2IsDualShipActive=![],isInvincible=![],invincibilityEndTime=0x0,hitSparks=[];if(typeof showMenuState==='function')showMenuState();if(mainLoopId)cancelAnimationFrame(mainLoopId);mainLoopId=null,alert(_0x5b6da9(0x107));}}function switchPlayerTurn(){const _0xecbf4e=_0x27dd;if(!isTwoPlayerMode)return![];stopSound(hiScoreSound),highScore=Math[_0xecbf4e(0x182)](highScore,score);currentPlayer===0x1?(player1Score=score,player1IsDualShipActive=isDualShipActive):(player2Score=score,player2IsDualShipActive=isDualShipActive);const _0x4731de=currentPlayer===0x1?0x2:0x1,_0x5e1cd8=_0x4731de===0x1?player1Lives:player2Lives;if(_0x5e1cd8<=0x0){const _0x3ddd30=currentPlayer===0x1?player1Lives:player2Lives;return _0x3ddd30<=0x0?(triggerFinalGameOverSequence(),![]):(forceCenterShipNextReset=![],![]);}return currentPlayer=_0x4731de,score=currentPlayer===0x1?player1Score:player2Score,playerLives=currentPlayer===0x1?player1Lives:player2Lives,isDualShipActive=currentPlayer===0x1?player1IsDualShipActive:player2IsDualShipActive,forceCenterShipNextReset=!![],scoreEarnedThisCS=0x0,csCurrentChainHits=0x0,csCurrentChainScore=0x0,csLastHitTime=0x0,csLastChainHitPosition=null,normalWaveCurrentChainHits=0x0,normalWaveCurrentChainScore=0x0,normalWaveLastHitTime=0x0,normalWaveLastChainHitPosition=null,leftPressed=![],rightPressed=![],shootPressed=![],p2LeftPressed=![],p2RightPressed=![],p2ShootPressed=![],keyboardP1LeftDown=![],keyboardP1RightDown=![],keyboardP1ShootDown=![],keyboardP2LeftDown=![],keyboardP2RightDown=![],keyboardP2ShootDown=![],p1JustFiredSingle=![],p2JustFiredSingle=![],p1FireInputWasDown=![],p2FireInputWasDown=![],isShipCaptured=![],captureBeamActive=![],capturingBossId=null,isWaitingForRespawn=![],respawnTime=0x0,isInvincible=![],invincibilityEndTime=0x0,fallingShips=[],hitSparks=[],showExtraLifeMessage=![],extraLifeMessageStartTime=0x0,!![];}function triggerGridFiring(){const _0x36efc3=_0x27dd;if(isPaused||!isInGameState||playerLives<=0x0||isChallengingStage||isWaveTransitioning||isShipCaptured)return;const _0x36f938=enemies[_0x36efc3(0x8f)](_0x39b05a=>_0x39b05a&&_0x39b05a[_0x36efc3(0xfd)]===_0x36efc3(0x14f));if(_0x36f938[_0x36efc3(0x140)]===0x0)return;const _0x10d23a=Date[_0x36efc3(0x164)](),_0x196061=scaleValue(level,BASE_GRID_FIRE_INTERVAL,MIN_GRID_FIRE_INTERVAL);if(_0x10d23a-lastGridFireCheckTime<_0x196061)return;lastGridFireCheckTime=_0x10d23a;const _0x3817a2=scaleValue(level,BASE_GRID_FIRE_PROBABILITY,MAX_GRID_FIRE_PROBABILITY),_0x2842c1=Math[_0x36efc3(0x11c)](scaleValue(level,BASE_GRID_MAX_FIRING_ENEMIES,MAX_GRID_MAX_FIRING_ENEMIES));let _0x426fdb=0x0;_0x36f938[_0x36efc3(0x6d)](()=>Math[_0x36efc3(0x149)]()-0.5);for(const _0xe4fa21 of _0x36f938){if(_0x426fdb>=_0x2842c1)break;if(_0xe4fa21[_0x36efc3(0x142)]===ENEMY2_TYPE||_0xe4fa21['type']===ENEMY3_TYPE){if(_0xe4fa21['type']===ENEMY3_TYPE&&_0xe4fa21[_0x36efc3(0x77)])continue;Math[_0x36efc3(0x149)]()<_0x3817a2&&(createBulletSimple(_0xe4fa21)&&(playSound(enemyShootSound),_0xe4fa21[_0x36efc3(0xa1)]=_0x10d23a,_0x426fdb++));}}}function runSingleGameUpdate(_0x3e92a3){const _0x2e817b=_0x27dd;try{const _0x11dd37=Date[_0x2e817b(0x164)]();if(isManualControl&&connectedGamepadIndex!==null&&playerLives>0x0&&gameOverSequenceStartTime===0x0&&!isPaused&&!isShipCaptured){const _0x13e7e4=navigator['getGamepads']();if(_0x13e7e4?.[connectedGamepadIndex]){const _0x52b697=_0x13e7e4[connectedGamepadIndex],_0x205566=processSingleController(_0x52b697,previousButtonStates);previousButtonStates=_0x205566[_0x2e817b(0x139)];if(_0x205566[_0x2e817b(0x185)]){stopGameAndShowMenu();return;}}else{if(previousButtonStates['length']>0x0)previousButtonStates=[];}}else{if(connectedGamepadIndex===null){if(previousButtonStates[_0x2e817b(0x140)]>0x0)previousButtonStates=[];}}if(connectedGamepadIndexP2===null){if(previousGameButtonStatesP2[_0x2e817b(0x140)]>0x0)previousGameButtonStatesP2=[];}if(isPaused){renderGame();return;}if(isShowingPlayerGameOverMessage&&isTwoPlayerMode){if(_0x11dd37-playerGameOverMessageStartTime>=PLAYER_GAME_OVER_MESSAGE_DURATION){isShowingPlayerGameOverMessage=![];if(nextActionAfterPlayerGameOver===_0x2e817b(0x12b)){if(switchPlayerTurn()){let _0x459771=level;if(playerWhoIsGameOver===0x1&&currentPlayer===0x2){}else playerWhoIsGameOver===0x2&&currentPlayer===0x1&&player1CompletedLevel===level&&(level++,player1CompletedLevel=-0x1,_0x459771=level);currentPlayer===0x1?player1MaxLevelReached=Math[_0x2e817b(0x182)](player1MaxLevelReached,level):player2MaxLevelReached=Math['max'](player2MaxLevelReached,level),resetWave();}else triggerFinalGameOverSequence();}else nextActionAfterPlayerGameOver===_0x2e817b(0x132)?triggerFinalGameOverSequence():(console[_0x2e817b(0x104)](_0x2e817b(0x103),nextActionAfterPlayerGameOver),triggerFinalGameOverSequence());renderGame();return;}else{renderGame();return;}}if(isShowingCaptureMessage){const _0x14d374=enemies[_0x2e817b(0xf2)](_0x2144f1=>_0x2144f1['id']===capturedBossIdWithMessage);if(_0x14d374&&_0x14d374[_0x2e817b(0xfd)]===_0x2e817b(0x100)){const _0x289952=_0x11dd37-captureMessageStartTime,_0xeb1c0f=Math[_0x2e817b(0xfa)](0x1,_0x289952/CAPTURE_MESSAGE_DURATION);_0x14d374['captureAnimationRotation']=_0xeb1c0f*0x2*(0x2*Math['PI']);}else _0x14d374&&(_0x14d374[_0x2e817b(0x80)]=0x0);if(_0x11dd37-captureMessageStartTime>=CAPTURE_MESSAGE_DURATION){isShowingCaptureMessage=![],stopSound(shipCapturedSound),captureBeamActive=![],capturingBossId=null;if(_0x14d374&&_0x14d374[_0x2e817b(0xfd)]===_0x2e817b(0x100)){_0x14d374[_0x2e817b(0xfd)]=_0x2e817b(0xa4),_0x14d374[_0x2e817b(0x80)]=0x0;try{const _0x1bcbd8=_0x14d374['type']===ENEMY3_TYPE?BOSS_WIDTH:ENEMY_WIDTH,{x:_0x45deef,y:_0x4ce78c}=getCurrentGridSlotPosition(_0x14d374['gridRow'],_0x14d374[_0x2e817b(0x8a)],_0x1bcbd8);_0x14d374['targetGridX']=_0x45deef,_0x14d374[_0x2e817b(0x12e)]=_0x4ce78c;}catch(_0x815044){console['error'](_0x2e817b(0x141)+_0x14d374['id']+':',_0x815044),_0x14d374[_0x2e817b(0xa9)]=gameCanvas[_0x2e817b(0x17e)]/0x2,_0x14d374[_0x2e817b(0x12e)]=ENEMY_TOP_MARGIN;}}else _0x14d374?(console[_0x2e817b(0x117)](_0x2e817b(0x113)+capturedBossIdWithMessage+'\x20state\x20changed\x20unexpectedly.\x20Resetting\x20rotation.'),_0x14d374[_0x2e817b(0x80)]=0x0):console[_0x2e817b(0x117)](_0x2e817b(0x6e)+capturedBossIdWithMessage+_0x2e817b(0x6c));capturedBossIdWithMessage=null;}isInGameState&&!isShowingPlayerGameOverMessage&&gameOverSequenceStartTime===0x0&&(moveEntities(),updateExplosions(),updateFloatingScores());renderGame();return;}!isShowingPlayerGameOverMessage&&gameOverSequenceStartTime===0x0&&!isShipCaptured&&!isShowingCaptureMessage&&(!isManualControl&&isInGameState&&playerLives>0x0&&aiControl(),isInGameState&&isManualControl&&playerLives>0x0&&handlePlayerInput());isInGameState&&!isShowingPlayerGameOverMessage&&gameOverSequenceStartTime===0x0&&!isShowingCaptureMessage&&(moveEntities(),updateExplosions(),updateFloatingScores());isInvincible&&_0x11dd37>=invincibilityEndTime&&(isInvincible=![],invincibilityEndTime=0x0);if(isCsCompletionDelayActive&&!isShowingPlayerGameOverMessage&&gameOverSequenceStartTime===0x0){if(_0x11dd37-csCompletionDelayStartTime>=CS_COMPLETION_MESSAGE_DELAY){isCsCompletionDelayActive=![];csCompletionResultIsPerfect?(playSound(csPerfectSound),showCsHitsMessage=!![],csHitsMessageStartTime=_0x11dd37):(playSound(csClearSound),showCSClearMessage=!![],csClearMessageStartTime=_0x11dd37);renderGame();return;}else{renderGame();return;}}let _0x10ca49=![],_0x37b153=![];if(!isShowingPlayerGameOverMessage&&gameOverSequenceStartTime===0x0){if(showCsHitsMessage)Date[_0x2e817b(0x164)]()-csHitsMessageStartTime>CS_HITS_MESSAGE_DURATION&&(showCsHitsMessage=![],showPerfectMessage=!![],perfectMessageStartTime=_0x11dd37),_0x37b153=!![];else{if(showPerfectMessage)Date[_0x2e817b(0x164)]()-perfectMessageStartTime>CS_PERFECT_MESSAGE_DURATION&&(showPerfectMessage=![],showCsBonusScoreMessage=!![],csBonusScoreMessageStartTime=_0x11dd37),_0x37b153=!![];else{if(showCsBonusScoreMessage)Date[_0x2e817b(0x164)]()-csBonusScoreMessageStartTime>CS_BONUS_MESSAGE_DURATION&&(showCsBonusScoreMessage=![],_0x10ca49=!![]),_0x37b153=!![];else{if(showCSClearMessage)Date[_0x2e817b(0x164)]()-csClearMessageStartTime>=CS_CLEAR_HITS_DELAY&&!showCsHitsForClearMessage&&(showCsHitsForClearMessage=!![]),Date['now']()-csClearMessageStartTime>=CS_CLEAR_SCORE_DELAY&&!showCsScoreForClearMessage&&(showCsScoreForClearMessage=!![]),Date['now']()-csClearMessageStartTime>=CS_CLEAR_DELAY&&(showCSClearMessage=![],showCsHitsForClearMessage=![],showCsScoreForClearMessage=![],_0x10ca49=!![]),_0x37b153=!![];else{if(showExtraLifeMessage)Date['now']()-extraLifeMessageStartTime>EXTRA_LIFE_MESSAGE_DURATION&&(showExtraLifeMessage=![],_0x10ca49=!![]),_0x37b153=!![];else showReadyMessage&&(Date[_0x2e817b(0x164)]()-readyMessageStartTime>READY_MESSAGE_DURATION&&(showReadyMessage=![],_0x10ca49=!![]),_0x37b153=!![]);}}}}}if(_0x37b153){renderGame();return;}if(isShowingIntro&&!isShowingPlayerGameOverMessage&&gameOverSequenceStartTime===0x0){let _0x20ea91=![];const _0xea10d9=_0x11dd37-introDisplayStartTime,_0x4d5137=0xbb8,_0x51d55d=INTRO_DURATION_PER_STEP;if(introStep===0x1)isTwoPlayerMode&&!playerIntroSoundPlayed&&(playSound(levelUpSound),playerIntroSoundPlayed=!![]),level===0x1&&currentPlayer===0x1&&!playerIntroSoundPlayed&&(playSound(startSound),playerIntroSoundPlayed=!![]);else{if(introStep===0x2)!isTwoPlayerMode&&level>0x1&&!isChallengingStage&&!stageIntroSoundPlayed&&(playSound(levelUpSound),stageIntroSoundPlayed=!![]);else introStep===0x3&&(!csIntroSoundPlayed&&(playSound(entranceSound),csIntroSoundPlayed=!![]));}if(introStep===0x1){let _0x51809a=isTwoPlayerMode?_0x4d5137:_0x51d55d;if(level===0x1&&!isTwoPlayerMode)_0x51809a=_0x51d55d;_0xea10d9>=_0x51809a&&(isChallengingStage?introStep=0x3:introStep=0x2,introDisplayStartTime=_0x11dd37);}else{if(introStep===0x2){const _0x56f3e5=_0x51d55d;_0xea10d9>=_0x56f3e5&&(_0x20ea91=!![]);}else introStep===0x3&&(_0xea10d9>=_0x51d55d&&(_0x20ea91=!![]));}if(_0x20ea91){isShowingIntro=![],introStep=0x0;!isChallengingStage?aiCanShootTime=Date[_0x2e817b(0x164)]()+0xbb8:aiCanShootTime=0x0;if(isChallengingStage)startChallengingStageSequence();else{currentWaveDefinition=generateWaveDefinition(level);if(currentWaveDefinition&&currentWaveDefinition[_0x2e817b(0x140)]>0x0)isFullGridWave?startFullGridWave():scheduleEntranceFlightWave();else{console[_0x2e817b(0x117)](_0x2e817b(0x173)+level+_0x2e817b(0xc0)),isEntrancePhaseActive=![],stopSound(entranceSound),isWaveTransitioning=!![],readyForNextWaveReset=!![];const _0x50d894=0x64;setTimeout(()=>{const _0x4a7d78=_0x2e817b;(isInGameState||!isInGameState&&playerLives>0x0)&&typeof resetWave===_0x4a7d78(0xae)&&(playerLives>0x0?resetWave():triggerFinalGameOverSequence());},_0x50d894);}}}renderGame();return;}gameJustStarted&&(gameJustStarted=![]);if(!isShowingPlayerGameOverMessage&&gameOverSequenceStartTime===0x0){if(GRID_BREATH_ENABLED&&isInGameState&&!isChallengingStage&&!isWaveTransitioning&&playerLives>0x0){const _0x2f4e03=enemies[_0x2e817b(0xda)](_0x158c2e=>_0x158c2e?.[_0x2e817b(0xfd)]===_0x2e817b(0x14f));if(_0x2f4e03&&isGridBreathingActive){const _0x2150dd=_0x11dd37-gridBreathStartTime,_0x5366ac=scaleValue(level,BASE_GRID_BREATH_CYCLE_MS,MIN_GRID_BREATH_CYCLE_MS),_0x2aefff=_0x2150dd%_0x5366ac;currentGridBreathFactor=(Math[_0x2e817b(0xc1)](_0x2aefff/_0x5366ac*Math['PI']*0x2-Math['PI']/0x2)+0x1)/0x2;}else{if(!_0x2f4e03&&isGridBreathingActive)isGridBreathingActive=![],gridBreathStartTime=0x0,currentGridBreathFactor=0x0;else _0x2f4e03&&!isGridBreathingActive&&(isGridBreathingActive=!![],gridBreathStartTime=_0x11dd37,currentGridBreathFactor=0x0);}}else isGridBreathingActive&&(isGridBreathingActive=![],gridBreathStartTime=0x0,currentGridBreathFactor=0x0);if(isEntrancePhaseActive){const _0xa6a39d=enemiesSpawnedThisWave>=totalEnemiesScheduledForWave,_0x4cdf90=enemies['some'](_0x4e1e51=>_0x4e1e51?.[_0x2e817b(0xfd)]==='following_entrance_path'||_0x4e1e51?.[_0x2e817b(0xfd)]==='moving_to_grid'||_0x4e1e51?.[_0x2e817b(0xfd)]===_0x2e817b(0x9f));if(totalEnemiesScheduledForWave>0x0&&_0xa6a39d&&!_0x4cdf90){const _0x4892a9=isEntrancePhaseActive;isEntrancePhaseActive=![],_0x4892a9&&(stopSound(entranceSound),enemiesSpawnedThisWave=0x0,totalEnemiesScheduledForWave=0x0,enemySpawnTimeouts[_0x2e817b(0x7e)](clearTimeout),enemySpawnTimeouts=[],gridJustCompleted=!![],!isChallengingStage&&typeof triggerImmediateCaptureDive===_0x2e817b(0xae)&&triggerImmediateCaptureDive());}}!isChallengingStage&&!isShowingIntro&&!isPaused&&!isWaveTransitioning&&triggerGridFiring();if(!isWaveTransitioning&&playerLives>0x0&&!isShowingIntro&&!isShipCaptured&&!isShowingCaptureMessage&&!isEntrancePhaseActive){let _0x5f5123=enemies[_0x2e817b(0x140)]===0x0,_0x56a02c=fallingShips[_0x2e817b(0x140)]===0x0,_0x14907c=![];isChallengingStage?_0x5f5123&&!isEntrancePhaseActive&&(_0x14907c=!![]):_0x5f5123&&!isEntrancePhaseActive&&_0x56a02c&&(_0x14907c=!![]);if(_0x14907c){isGridBreathingActive&&(isGridBreathingActive=![],gridBreathStartTime=0x0,currentGridBreathFactor=0x0);!isManualControl&&ship&&gameCanvas?.[_0x2e817b(0x17e)]>0x0&&(ship['x']=Math[_0x2e817b(0x11c)](gameCanvas['width']/0x2-ship[_0x2e817b(0x17e)]/0x2),ship[_0x2e817b(0x169)]=ship['x']);isWaveTransitioning=!![];isGridSoundPlaying&&(stopSound(gridBackgroundSound),isGridSoundPlaying=![]);bullets=[],enemyBullets=[],explosions=[],enemySpawnTimeouts[_0x2e817b(0x7e)](clearTimeout),enemySpawnTimeouts=[],totalEnemiesScheduledForWave=0x0,enemiesSpawnedThisWave=0x0,floatingScores=[];const _0xdf8122=currentPlayer;isTwoPlayerMode&&_0xdf8122===0x1&&(player1CompletedLevel=level);let _0x4f706d;if(isChallengingStage){csCompletionResultIsPerfect=challengingStageEnemiesHit>=challengingStageTotalEnemies,csCurrentChainHits=0x0,csCurrentChainScore=0x0,csLastHitTime=0x0,csLastChainHitPosition=null,isCsCompletionDelayActive=!![],csCompletionDelayStartTime=_0x11dd37;if(csCompletionResultIsPerfect){const _0x4b91f1=score;score+=0x2710,highScore=Math['max'](highScore,score);let _0x511856=![],_0x4c89e3=null;if(!isManualControl)_0x511856=player1TriggeredHighScoreSound,_0x4c89e3=()=>{player1TriggeredHighScoreSound=!![];};else isTwoPlayerMode?currentPlayer===0x1?(_0x511856=player1TriggeredHighScoreSound,_0x4c89e3=()=>{player1TriggeredHighScoreSound=!![];}):(_0x511856=player2TriggeredHighScoreSound,_0x4c89e3=()=>{player2TriggeredHighScoreSound=!![];}):(_0x511856=player1TriggeredHighScoreSound,_0x4c89e3=()=>{player1TriggeredHighScoreSound=!![];});if(!_0x511856&&score>highScore-0x2710){if(_0x4c89e3)_0x4c89e3();playSound(hiScoreSound);}if(currentPlayer===0x1)player1Score=score;else player2Score=score;checkAndAwardExtraLife(),_0x4f706d=CS_COMPLETION_MESSAGE_DELAY+CS_HITS_MESSAGE_DURATION+CS_PERFECT_MESSAGE_DURATION+CS_BONUS_MESSAGE_DURATION;}else checkAndAwardExtraLife(),_0x4f706d=CS_COMPLETION_MESSAGE_DELAY+CS_CLEAR_DELAY;_0x4f706d+=0x64;}else playSound(waveUpSound),normalWaveCurrentChainHits=0x0,normalWaveCurrentChainScore=0x0,normalWaveLastHitTime=0x0,normalWaveLastChainHitPosition=null,_0x4f706d=POST_MESSAGE_RESET_DELAY;setTimeout(()=>{const _0x23d397=_0x2e817b;let _0x48c1be=![],_0x38d508=currentPlayer;if(isTwoPlayerMode){if(currentPlayer===0x1)player1Score=score;else player2Score=score;const _0x5f093a=switchPlayerTurn();_0x5f093a?(_0x38d508=currentPlayer,_0xdf8122===0x2&&player1CompletedLevel===level?(_0x48c1be=!![],player1CompletedLevel=-0x1):_0x48c1be=![]):(_0x38d508=_0xdf8122,_0x48c1be=!![],player1CompletedLevel=-0x1);}else _0x38d508=0x1,_0x48c1be=!![];_0x48c1be&&level++;const _0x44e523=_0x38d508===0x1?player1Lives:player2Lives;_0x44e523>0x0?(_0x38d508===0x1?player1MaxLevelReached=Math['max'](player1MaxLevelReached,level):player2MaxLevelReached=Math[_0x23d397(0x182)](player2MaxLevelReached,level),resetWave()):(console['error'](_0x23d397(0x170)),triggerFinalGameOverSequence());},_0x4f706d),renderGame();return;}if(!isChallengingStage){if(enemies[_0x2e817b(0x140)]>0x0){let _0x20f958=null;const _0x260eba=enemies[_0x2e817b(0x8f)](_0x10f8b2=>_0x10f8b2?.[_0x2e817b(0xfd)]===_0x2e817b(0x14f)),_0x5012a3=_0x260eba[_0x2e817b(0x140)]<=0x3,_0x2a4f61=Math['max'](0x1,Math[_0x2e817b(0xfa)](level,LEVEL_CAP_FOR_SCALING)),_0x5a771a=0x1068,_0x2fc314=0x320,_0xeed9f5=(_0x2a4f61-0x1)*((_0x5a771a-_0x2fc314)/(LEVEL_CAP_FOR_SCALING-0x1)),_0xea2a53=Math[_0x2e817b(0x182)](_0x2fc314,_0x5a771a-_0xeed9f5),_0x53935e=Math['round'](scaleValue(level,BASE_MAX_ATTACKING_ENEMIES,MAX_MAX_ATTACKING_ENEMIES)),_0x3a506a=enemies['filter'](_0xb16cab=>_0xb16cab?.[_0x2e817b(0xfd)]===_0x2e817b(0xd1)||_0xb16cab?.[_0x2e817b(0xfd)]===_0x2e817b(0x130))[_0x2e817b(0x140)];if(_0x5012a3||_0x11dd37-lastEnemyDetachTime>_0xea2a53&&_0x260eba[_0x2e817b(0x140)]>0x0&&_0x3a506a<_0x53935e){_0x20f958=findAndDetachEnemy();if(_0x20f958&&_0x20f958[_0x2e817b(0x140)]>0x0){const _0x558a3c=_0x20f958['map'](_0x447250=>enemies[_0x2e817b(0xf2)](_0x324ac1=>_0x324ac1?.['id']===_0x447250['id']))['filter'](_0xad931c=>_0xad931c&&_0xad931c[_0x2e817b(0xfd)]===_0x2e817b(0x14f));if(_0x558a3c[_0x2e817b(0x140)]>0x0){const _0x363a38=_0x558a3c[0x0],_0x5de17c=_0x363a38[_0x2e817b(0xd2)];!_0x5012a3&&(lastEnemyDetachTime=_0x11dd37);if(_0x5de17c==='normal'){const _0x403b94=generateAttackPath(_0x363a38);if(_0x403b94&&_0x403b94[_0x2e817b(0x140)]>0x0){_0x558a3c['length']===0x3&&_0x363a38[_0x2e817b(0x142)]===ENEMY3_TYPE&&level!==0x1&&playSound(tripleAttackSound);let _0x2747e2=[..._0x558a3c];const _0x4107a3=_0x2747e2[_0x2e817b(0x140)];if(_0x4107a3>0x1){let _0x34f6de=null,_0x1bd72f=[];_0x2747e2[_0x2e817b(0x7e)](_0x3af02c=>{if(_0x3af02c['type']===ENEMY3_TYPE)_0x34f6de=_0x3af02c;else _0x1bd72f['push'](_0x3af02c);});_0x34f6de&&level!==0x1&&_0x4107a3===0x3&&_0x1bd72f[_0x2e817b(0x140)]===0x2?_0x2747e2=[_0x1bd72f[0x0],_0x34f6de,_0x1bd72f[0x1]]:_0x2747e2['sort']((_0x4da901,_0x5a8185)=>(_0x4da901?.[_0x2e817b(0x8a)]??0x0)-(_0x5a8185?.[_0x2e817b(0x8a)]??0x0));const _0xeb7125=0x5;let _0x44ba8a=0x0;_0x2747e2=_0x2747e2[_0x2e817b(0x8f)](_0x9a5390=>_0x9a5390&&typeof _0x9a5390[_0x2e817b(0x17e)]===_0x2e817b(0x102));const _0x2f40c7=_0x2747e2['length'];for(let _0x3cc467=0x0;_0x3cc467<_0x2f40c7;_0x3cc467++){_0x44ba8a+=_0x2747e2[_0x3cc467][_0x2e817b(0x17e)];if(_0x3cc467<_0x2f40c7-0x1)_0x44ba8a+=_0xeb7125;}const _0x37b16f=-_0x44ba8a/0x2;let _0x3de957=_0x37b16f;for(let _0x44efff=0x0;_0x44efff<_0x2f40c7;_0x44efff++){const _0x2aee75=_0x2747e2[_0x44efff];_0x2aee75['attackFormationOffsetX']=_0x3de957+_0x2aee75[_0x2e817b(0x17e)]/0x2,_0x3de957+=_0x2aee75[_0x2e817b(0x17e)]+_0xeb7125;}}else _0x2747e2[_0x2e817b(0x7e)](_0x4cd65e=>_0x4cd65e[_0x2e817b(0x148)]=0x0);const _0x2db8a1='attack-'+_0x363a38['id']+'-'+_0x11dd37;_0x2747e2[_0x2e817b(0x7e)](_0x2202bf=>{const _0x65fc27=_0x2e817b;if(_0x2202bf)_0x2202bf[_0x65fc27(0x174)]=_0x2db8a1;});let _0x3af76c=![],_0xf24a41=GROUP_FIRE_BURST_DELAY;if(_0x363a38['type']===ENEMY2_TYPE||_0x363a38[_0x2e817b(0x142)]===ENEMY3_TYPE)_0x3af76c=!![],_0x363a38[_0x2e817b(0x142)]===ENEMY2_TYPE&&_0x4107a3===0x1&&(_0xf24a41=SOLO_BUTTERFLY_FIRE_DELAY);else _0x363a38['type']===ENEMY1_TYPE&&(_0x3af76c=!![]);_0x5012a3&&level>0x1&&(_0x3af76c=![]),_0x3af76c&&_0x2747e2['forEach'](_0x4651ad=>{const _0x4616c5=_0x2e817b,_0x5a03e3=_0x4651ad&&!(_0x4651ad[_0x4616c5(0x142)]===ENEMY3_TYPE&&_0x4651ad[_0x4616c5(0x77)]);_0x5a03e3&&fireEnemyBurst(_0x4651ad['id'],'attacking',_0xf24a41);}),_0x2747e2[_0x2e817b(0x7e)]((_0x3d9616,_0x247331)=>{const _0x4036a6=_0x2e817b;_0x3d9616&&_0x3d9616['state']==='in_grid'&&(_0x3d9616[_0x4036a6(0xfd)]='preparing_attack',_0x3d9616[_0x4036a6(0x92)]=![],_0x3d9616['velocityX']=0x0,_0x3d9616[_0x4036a6(0x17d)]=0x0,_0x3d9616[_0x4036a6(0x11a)]=![],setTimeout(()=>{const _0x21af75=_0x4036a6;if(isPaused)return;const _0x53cdb5=enemies[_0x21af75(0xf2)](_0x4291d4=>_0x4291d4?.['id']===_0x3d9616['id']);if(_0x53cdb5&&_0x53cdb5[_0x21af75(0xfd)]===_0x21af75(0x130))try{const _0x2bb3fd=scaleValue(level,BASE_ENEMY_ATTACK_SPEED,MAX_ENEMY_ATTACK_SPEED);let _0x505b27=0x1;if(_0x53cdb5[_0x21af75(0x142)]===ENEMY1_TYPE)_0x505b27=ENEMY1_DIVE_SPEED_FACTOR;else{if(_0x53cdb5[_0x21af75(0x142)]===ENEMY2_TYPE)_0x505b27=ENEMY2_DIVE_SPEED_FACTOR;else{if(_0x53cdb5[_0x21af75(0x142)]===ENEMY3_TYPE)_0x505b27=ENEMY3_ATTACK_SPEED_FACTOR;}}if(_0x3d9616[_0x21af75(0x142)]===ENEMY3_TYPE)playSound(bossGalagaDiveSound);else playSound(butterflyDiveSound);_0x53cdb5[_0x21af75(0xfd)]='attacking',_0x53cdb5['attackPathSegments']=_0x403b94,_0x53cdb5[_0x21af75(0x168)]=0x0,_0x53cdb5[_0x21af75(0x74)]=0x0,_0x53cdb5['speed']=_0x2bb3fd*_0x505b27,_0x53cdb5[_0x21af75(0xa1)]=0x0,_0x53cdb5[_0x21af75(0x11a)]=!![];}catch(_0xfffc5b){console[_0x21af75(0x104)](_0x21af75(0x101)+_0x3d9616['id']+':',_0xfffc5b);}},_0x247331*GROUP_DETACH_DELAY_MS));});}else console[_0x2e817b(0x117)](_0x2e817b(0xc5)+_0x363a38?.['id']+'.\x20Skipping\x20attack.'),_0x20f958[_0x2e817b(0x7e)](_0x2d52ff=>{if(_0x2d52ff)_0x2d52ff['justReturned']=![];});}}}}}}enemies['forEach'](_0x13d348=>{const _0xb7d917=_0x2e817b;if(_0x13d348&&_0x13d348['type']===ENEMY3_TYPE&&_0x13d348[_0xb7d917(0x77)]&&_0x13d348['state']===_0xb7d917(0xd1)&&_0x13d348[_0xb7d917(0x99)]&&typeof _0x13d348['capturedShipLastFiredTime']==='number'){if(_0x11dd37-_0x13d348[_0xb7d917(0x105)]>CAPTURED_SHIP_FIRE_COOLDOWN_MS){const _0x20b274=_0x13d348['x']+_0x13d348['width']/0x2,_0x70cacd=_0x13d348['y']+_0x13d348[_0xb7d917(0x166)]+_0x13d348['capturedShipDimensions'][_0xb7d917(0x166)]*0.5,_0x2db801={'x':_0x20b274,'y':_0x70cacd};createBulletSimple(_0x13d348,_0x2db801)&&(_0x13d348['capturedShipLastFiredTime']=_0x11dd37,playSound(playerShootSound));}}});}}else{if(gameOverSequenceStartTime>0x0){const _0x2c8b66=_0x11dd37-gameOverSequenceStartTime,_0x587027=_0x2c8b66>=GAME_OVER_DURATION;_0x587027&&!isShowingResultsScreen&&(isShowingResultsScreen=!![],stopSound(gameOverSound),playSound(resultsMusicSound));}}renderGame();}catch(_0x4217ae){console['error'](_0x2e817b(0xca),_0x4217ae,_0x4217ae[_0x2e817b(0x9e)]),isPaused=![];mainLoopId&&(cancelAnimationFrame(mainLoopId),mainLoopId=null);isInGameState=![],isShowingPlayerGameOverMessage=![],playerGameOverMessageStartTime=0x0,playerWhoIsGameOver=0x0,nextActionAfterPlayerGameOver='',alert(_0x2e817b(0x16c)),stopAllGameSounds(),isGridSoundPlaying=![],isInvincible=![],invincibilityEndTime=0x0;try{typeof showMenuState==='function'&&showMenuState();}catch(_0x4f6a0d){console[_0x2e817b(0x104)]('Failed\x20to\x20return\x20to\x20menu\x20after\x20critical\x20error:',_0x4f6a0d);}}}function _0x27dd(_0x79d8b,_0x3834b3){const _0x7fdfb3=_0x7fdf();return _0x27dd=function(_0x27dde6,_0x26dfdc){_0x27dde6=_0x27dde6-0x6a;let _0x5e0f3a=_0x7fdfb3[_0x27dde6];return _0x5e0f3a;},_0x27dd(_0x79d8b,_0x3834b3);}function checkAndAwardExtraLife(){const _0x152a83=_0x27dd;try{let _0x194c54;!isManualControl||!isTwoPlayerMode?_0x194c54=player1LifeThresholdsMet:_0x194c54=currentPlayer===0x1?player1LifeThresholdsMet:player2LifeThresholdsMet;let _0x31d317=![];while(!![]){let _0x18e3e4=![],_0x45dfce=-0x1;const _0x87f8b4=_0x194c54['size'];_0x87f8b4===0x0?_0x45dfce=EXTRA_LIFE_THRESHOLD_1:_0x45dfce=EXTRA_LIFE_THRESHOLD_2+(_0x87f8b4-0x1)*RECURRING_EXTRA_LIFE_INTERVAL;if(_0x45dfce!==-0x1&&score>=_0x45dfce&&!_0x194c54[_0x152a83(0xdc)](_0x45dfce)){playerLives++,_0x194c54[_0x152a83(0x146)](_0x45dfce),_0x31d317=!![],_0x18e3e4=!![];if(isTwoPlayerMode){if(currentPlayer===0x1)player1Lives=playerLives;else player2Lives=playerLives;}}if(!_0x18e3e4)break;}_0x31d317&&!showExtraLifeMessage&&(showExtraLifeMessage=!![],extraLifeMessageStartTime=Date[_0x152a83(0x164)](),playSound(extraLifeSound));}catch(_0x349a01){console[_0x152a83(0x104)](_0x152a83(0x8b),_0x349a01);}}